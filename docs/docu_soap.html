<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
  <TITLE>CommSy - SOAP</TITLE>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
  <!-- ---- -->
  <!-- UTF8 -->
  <!-- <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"> -->
  <!-- UTF8 -->
  <!-- ---- -->
  <meta name="author" content="Iver Jackewitz">
  <META NAME="DESCRIPTION" CONTENT="">
  <META NAME="KEYWORDS" CONTENT="">
  <LINK REL="stylesheet" HREF="style.css" TYPE="text/css">
</HEAD>

<BODY style="background-color:#C0C0C0;">
 <TABLE BORDER="0" CELLSPACING="0" CELLPADDING="5" WIDTH="800" ALIGN="left" CLASS="tbhead" style="width: 40em;" summary="for layout">
  <TBODY>
   <TR>
    <TD CLASS="title" ALIGN="left" HEIGHT="30">
     <a href="http://www.commsy.de"><IMG SRC="commsy_logo_transparent.gif" border="0" alt="CommSy Logo"></a>
    </TD>
   </TR>
   <TR>
    <TD HEIGHT="10">
     <A HREF="#soap">Was ist SOAP?</A>&nbsp;|
     <A HREF="#requirements">Requirements</A>&nbsp;|
     <A HREF="#generell">Generell</A>&nbsp;|
     <A HREF="#auth">Authentifizierung</A>&nbsp;|
     <a href="#material">Materialaustausch</a>&nbsp;|
     <A HREF="#upload_http">Dateiupload</A>&nbsp;|
     <A HREF="#ims">IMS</A>
    </TD>
   </TR>
   <TR>
    <TD>
     <TABLE CLASS="background" BORDER="0" CELLSPACING="3" CELLPADDING="2" WIDTH="100%" summary="for layout">
      <TR>
      <TD CLASS="background" VALIGN="top">
       <TABLE BORDER="0" CELLSPACING="1" CELLPADDING="7" summary="for layout">
        <TR>
         <TD CLASS="h2">
          SOAP-Schnittstelle: CommSy 6.1.3 und h&ouml;her
         </TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Im Folgenden finden Sie Informationen zur SOAP-Schnittstelle von CommSy.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="soap"></A>Was ist SOAP?</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            SOAP (urspr&uuml;nglich f&uuml;r Simple Object Access Protocol) ist ein Protokoll, mit dessen Hilfe Daten zwischen Systemen ausgetauscht und Remote Procedure Calls durchgef&uuml;hrt werden k&ouml;nnen. SOAP st&uuml;tzt sich auf die Dienste anderer Standards, XML zur Repr&auml;sentation der Daten und Internet-Protokolle der Transport- und Anwendungsschicht zur &Uuml;bertragung der Nachrichten. Die g&auml;ngigste Kombination ist SOAP &uuml;ber HTTP und TCP. Die Abk&uuml;rzung SOAP wird jedoch offiziell seit Version 1.2 nicht mehr als Abk&uuml;rzung gebraucht, da es erstens (subjektiv) keineswegs einfach (Simple) ist und da es zweitens nicht (nur) dem Zugriff auf Objekte (Object Access) dient.
         </TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mehr zu SOAP erfahren Sie unter <a href="http://de.wikipedia.org/wiki/SOAP" target="_blank">http://de.wikipedia.org/wiki/SOAP</a>.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="requirements"></A>Requirements</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Auf dem CommSy-Server muss die SOAP-Extension bei PHP (>= 5.0.0) aktiviert sein.
            <ul>
               <li>Linux / Unix: Aktivierung in der SOAP-Extension in der php.ini durch <code>extension=php_soap.so</code>.</li>
               <li>Windows: Aktivierung in der SOAP-Extension in der php.ini durch <code>extension=php_soap.dll</code>.</li>
            </ul>
            Stellen Sie sicher, dass die entsprechende PHP-SOAP-Bibliothek auf Ihrem System vorhanden ist.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="generell"></A>Generell</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            SOAP ist "nur" ein T&uuml;r, &uuml;ber die Methoden zur Verf&uuml;gung gestellt werden k&ouml;nnen. Welche Methoden dies sind, m&uuml;ssen Sie entweder wissen bzw. erfahren Sie &uuml;ber eine WSDL-Datei. In dieser sind alle &uuml;ber SOAP angebotenen Methoden definiert ... so auch bei CommSy.
         </TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            D.h. generell haben Sie zwei M&ouml;glichkeiten, sich mit dem CommSy-Server via SOAP zu verbinden:
            <ul>
               <li>ohne WSDL</li>
               <li>mit WSDL</li>
            </ul>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">ohne WSDL</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Hier ein Beispiel zur Verbindung mit dem CommSy-Server ohne WSDL-Datei (in PHP):
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
 $url = 'http://URL.COMMSY.SERVER/soap.php';<br/>$uri = 'urn:xmethodsCommSy';<br/>
$client = new SoapClient(null, array( 'location' => $url, 'uri' => $uri, 'style' => SOAP_RPC, 'use' => SOAP_ENCODED ) );
            </code></div>
            Eine spezielle Methode (hier die Authentifizierung) muss dann wie folgt angesprochen werden:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$params1 = array(<br/>
new SoapParam($a, 'user_id'),<br/>
new SoapParam($b, 'password'),<br/>
new SoapParam($c, 'portal_id')<br/>
);<br/>
$params2 = array("uri" => $uri,"soapaction" => $uri."#authenticate");<br/>
$result = $client->__soapCall("authenticate",$params1,$params2);
           </code></div>
           Einfacher geht es mit der Nutzung der WSDL-Datei.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">mit WSDL</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Hier ein Beispiel zur Verbindung mit dem CommSy-Server mit WSDL-Datei (in PHP):
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$url = 'http://URL.COMMSY.SERVER/soap_wsdl.php'; // soap_wsdl.php nicht nur soap.php<br/>
$client = new SoapClient($url, array('exceptions' => 0);<br/>
// exceptions = 0 - exceptions werden als Objekt zur&uuml;ck gegeben
            </code></div>
            Eine spezielle Methode (hier die Authentifizierung) wird dann wie folgt angesprochen:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->authenticate('user_id','password','portal_id');
           </code></div>
           Im Folgenden beziehen sich die weiteren Informationen und Beispiele immer auf die Verwendung der WSDL-Datei und sind in der Scriptsprache PHP verfasst.
         </TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
         Achtung: SOAP setzt zwingend eine Codierung in utf8 voraus, d.h. alle Input-Daten m&uuml;ssen im utf8-Format kodiert sein und alle Output-Daten sind im utf8-Format kodiert. D.h. ggf. m&uuml;ssen bei der Parameter&uuml;bergabe bzw. der Ergebnisverarbeitung die Werte umkodiert werden.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="auth"></A>Authentifizierung</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>authenticate</code> authentifiziert sich ein Nutzender mit seiner Kennung und Passwort an einem CommSy-Portal. Die Angabe einer Portal-ID ist hier zwingend, da der CommSy-Server autarke Instanzen (CommSy-Portale) zur Verf&uuml;gung stellt und sich Nutzenden nicht am Server direkt sondern nur an Portalen anmelden k&ouml;nnen.
            <br/><br/>&Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>user_id (string) - Kennung eines Nutzenden</li>
                  <li>password (string) - das zur Kennung passende Passwort</li>
                  <li>portal_id (integer) - die Item-ID des Portals, an dem sich der Nutzende anmelden will</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: session_id (string) - Session-ID zu einer g&uuml;ltigen Session.</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->authenticate('user_id','password','portal_id');
           </code></div>
            Achtung: Um die verschiedenen folgenden Methoden &uuml;ber die SOAP-Schnittstelle nutzen zu k&ouml;nnen, ist eine g&uuml;ltige Session n&ouml;tig. D.h. die Authentifizierungsmethode muss immer als erstes bei der Kommunikation &uuml;ber die SOAP-Schnittstelle aufgerufen werden, so dass die Session-ID bei den folgenden Methoden als &Uuml;bergabeparameter genutzt werden kann.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="material"></A>Materialaustausch</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Es existieren verschiedene Methoden zum Austausch von Materialien zwischen CommSy und einer externen Applikation. Generell gilt zurzeit, dass Materialien zwischen CommSy und einer externen Applikation nur &uuml;ber den pers&ouml;nlichen Raum eines Nutzenden ausgetauscht werden k&ouml;nnen. Ausnahmen bestätigen die Regel.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">getPrivateRoomMaterialList</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Die Methode <code>getPrivateRoomMaterialList</code> erm&ouml;glicht den lesende Zugriff auf die Materialien im pers&ouml;nlichen Raum eines Nutzenden auf einem CommSy-Portal.
            <br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID - Kennung, Portal und pers&ouml;nlichen Raum sucht sich CommSy aus den Daten in der Session.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: xml_material_list (string) - Liste der Materialien in XML-Notation.</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->getPrivateRoomMaterialList('session_id');
           </code></div>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
            &lt;material_list&gt;</code>
               <div style="padding-left: 30px;"><code>&lt;material_item&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;item_id&gt;276963&lt;/item_id&gt;<br/>
                  &lt;version_id&gt;0&lt;/version_id&gt;<br/>
                  &lt;context_id&gt;235366&lt;/context_id&gt;<br/>
                  ...<br/>
                  &lt;title&gt;Hallo Die Enten&lt;/title&gt;<br/>
                  &lt;description&gt;Eine tolle Beschreibung&lt;/description&gt;<br/>
                  ...<br/>
                  &lt;extras&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;study_log&gt;&lt;/study_log&gt;<br/>
                  </code></div>
                  <code>&lt;/extras&gt;</code><br/>
                  <code><br/>
                  // sofern gesetzt erscheinen auch folgende Inhalte<br/>
                  &lt;bib_kind&gt;book&lt;/bib_kind&gt;<br/>
                  &lt;common&gt;Allgemeine bibliografischen Angaben&lt;/common&gt;<br/>
                  &lt;booktitle&gt;Das große Entenbuch&lt;/booktitle&gt;<br/>
                  &lt;publisher&gt;Hamburg University Press&lt;/publisher&gt;<br/>
                  &lt;address&gt;Hamburg&lt;/address&gt;<br/>
                  &lt;volume&gt;4&lt;/volume&gt;<br/>
                  &lt;series&gt;13&lt;/series&gt;<br/>
                  &lt;isbn&gt;3608935444&lt;/isbn&gt;<br/>
                  &lt;issn&gt;978-3608935448&lt;/issn&gt;<br/>
                  &lt;pages&gt;12-24&lt;/pages&gt;<br/>
                  &lt;journal&gt;26&lt;/journal&gt;<br/>
                  &lt;issue&gt;3&lt;/issue&gt;<br/>
                  &lt;university&gt;Universität Hamburg&lt;/university&gt;<br/>
                  &lt;faculty&gt;MIN-Fakultät&lt;/faculty&gt;<br/>
                  &lt;thesis_kind&gt;dissertation&lt;/thesis_kind&gt;<br/>
                  &lt;url&gt;http://service.commsy.net&lt;/url&gt;<br/>
                  &lt;url_date&gt;26.03.2007&lt;/url_date&gt;
                  </code><br/>
                  <code>&lt;date&gt;</code>
                  <div style="padding-left: 30px;"><code>&lt;day&gt;&lt;/day&gt;<br/>
                  &lt;month&gt;&lt;/month&gt;<br/>
                  &lt;year&gt;2010&lt;/year&gt;
                  </code></div>
                  <code>&lt;/date&gt;</code><br/>
                  <code>&lt;author_list&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;author_item&gt;Jackewitz, Iver&lt;/author_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/author_list&gt;</code><br/>
                  <code>&lt;editor_list&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;editor_item&gt;Jackewitz, Iver&lt;/editor_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/editor_list&gt;</code><br/>
                  <code>&lt;keyword_list&gt;</code><br/>
                  <div style="padding-left: 30px;"><code>
                  &lt;keyword_item&gt;CommSy&lt;/keyword_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/keyword_list&gt;</code><br/>
                  <code>&lt;label&gt;Hausaufgabe&lt;/label&gt;</code>
                  </div>
               <code>&lt;/material_item&gt;</code></div>
               <div style="padding-left: 30px;"><code>&lt;material_item&gt;</code>
                  <div style="padding-left: 30px;"><code>...</code></div>
               <code>&lt;/material_item&gt;<br/>
               ...</code></div>
               <code>&lt;/material_list&gt;
           </code></div>
           <p>Die Werte für <code>bib_kind</code> sind:</p>
           <ul>
              <li>none</li>
              <li>common</li>
              <li>book</li>
              <li>collection</li>
              <li>incollection</li>
              <li>article</li>
              <li>inpaper</li>
              <li>thesis</li>
              <li>manuscript</li>
              <li>website</li>
           </ul>
           <p>Die Werte für <code>thesis_kind</code> sind:</p>
           <ul>
              <li>term</li>
              <li>bachelor</li>
              <li>master</li>
              <li>exam</li>
              <li>diploma</li>
              <li>dissertation</li>
              <li>postdoc</li>
           </ul>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">getSectionListFromMaterial</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>getSectionListFromMaterial</code> ist der lesende Zugriff auf die an ein Material angeh&auml;ngten Abschnitte m&ouml;glich.<br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss lesenden Zugriff auf das Material haben, d.h. Mitglied im entsprechenden Raum sein.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>material_id (integer) - Item-ID des Materials</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: xml_file_list (string) - Liste der Abschnitte des Materials in XML-Notation.</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->getSectionListFromMaterial('session_id','material_id');
           </code></div>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               &lt;section_list&gt;</code>
                  <div style="padding-left: 30px;"><code>&lt;section_item&gt;</code>
                     <div style="padding-left: 30px;"><code>&lt;item_id&gt;753239&lt;/item_id&gt;<br/>
                     ...<br/>
                     &lt;title&gt;Meine Hausaufgaben&lt;/title&gt;<br/>
                     &lt;description&gt;... hab ich nicht gemacht.&lt;/description&gt;</code></div>
                  <code>
                  &lt;/section_item&gt;</code></div>
                  <div style="padding-left: 30px;"><code>&lt;section_item&gt;</code>
                     <div style="padding-left: 30px;"><code>...</code></div>
                  <code>
                  &lt;/section_item&gt;<br/>
                  ...</code></div>
                  <code>
               &lt;/section_list&gt;
           </code></div>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">getFileListFromItem</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>getFileListFromItem</code> ist der lesende Zugriff auf die an irgendeinen Eintrag in CommSy angeh&auml;ngten Dateien m&ouml;glich.<br/><br/>
            Achtung: Es werden hier nur die Metadaten der Dateien &uuml;bertragen, nicht die Dateien selbst. Da potentiell sehr viele Dateien an einem Eintrag angeh&auml;ngt sein k&ouml;nnen, muss sich die Datei einzeln mit der Methode <code>getFileItem</code> oder den im XML-Output angegebenen Resource-Link geholt werden. So kann dem Nutzenden auf Seiten des externen Tools Feedback &uuml;ber den Downloadstatus gegeben werden.<br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss lesenden Zugriff auf den Eintrag haben, d.h. Mitglied im entsprechenden Raum sein.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>item_id (integer) - Item-ID des Eintrages in CommSy</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: xml_file_list (string) - Liste der Dateien des Eintrages in XML-Notation.</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->getFileListFromItem('session_id','item_id');
           </code></div>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               &lt;file_list&gt;</code>
                  <div style="padding-left: 30px;"><code>&lt;file_item&gt;</code>
                     <div style="padding-left: 30px;"><code>&lt;files_id&gt;39264&lt;/files_id&gt;<br/>
                     ...<br/>
                     &lt;filename&gt;iver_jackewitz.jpg&lt;/filename&gt;<br/>
                     &lt;md5&gt;d41d8cd98f00b204e9800998ecf8427e&lt;/md5&gt;<br/>
                     &lt;resource_link&gt;http://mein.commsyserver.de/...&lt;/resource_link&gt;
                  </code></div>
                  <code>
                  &lt;/file_item&gt;</code></div>
                  <div style="padding-left: 30px;"><code>&lt;file_item&gt;</code>
                     <div style="padding-left: 30px;"><code>...</code></div>
                  <code>
                  &lt;/file_item&gt;<br/>
                  ...</code></div>
                  <code>
               &lt;/file_list&gt;
           </code></div>
           Der md5-Wert wird aus den eigentlichen Daten der Datei gewonnen. Ein externes Tool kann so &uuml;berpr&uuml;fen, ob es die Datei schon herunter geladen hat oder nicht.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">getFileListFromMaterial</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Diese Methode ist alt. Bitte verwenden Sie <code>getFileListFromItem</code>.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">getFileItem</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>getFileItem</code> wird ein lesender Zugriff auf die Datei selbst und die Metadaten realisiert. Die Datei selbst wird als base64-kodierter String &uuml;bertragen.<br/><br/>
            Hinweis: Die base64-Kodierung erzeugt einen Overhead von ca. 33%.<br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss lesenden Zugriff auf die Datei haben, d.h. Mitglied im entsprechenden Raum sein.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>file_id (integer) - Item-ID der Datei</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: xml_file_item (string) - Datei in XML-Notation mit Dateidaten (base64 kodiert).</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->getFileItem('session_id','file_id');
           </code></div>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               &lt;file_item&gt;</code>
                     <div style="padding-left: 30px;"><code>&lt;files_id&gt;39264&lt;/files_id&gt;<br/>
                     ...<br/>
                     &lt;filename&gt;iver_jackewitz.jpg&lt;/filename&gt;<br/>
                     &lt;base64&gt;/9j/4AAQSkZJRgABAQEEsASwAAD/2wBDAA...&lt;/base64&gt;</code></div>
                  <code>
               &lt;/file_item&gt;
           </code></div>
           Um die eigentliche Datei wieder herzustellen, muss der base64-String dekodiert und in eine Datei mit dem entsprechenden Namen geschrieben werden.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">deleteFileItem</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>deleteFileItem</code> wird eine vorhandene Datei gelöscht.
            <br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss Zugriff auf die Datei haben, d.h.
               <ul>
                  <li>Mitglied im entsprechenden Raum sein</li>
                  <li>und Ersteller der Datei</li>
                  <li>oder den Eintrag bearbeiten dürfen, an dem die Datei hängt.</li>
               </ul>
            </li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>file_id (integer) - Item-ID der Datei</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: "success" (string)</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->deleteFileItem('session_id','file_id');
           </code></div>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               success</code></div>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">addPrivateRoomMaterialList</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>addPrivateRoomMaterialList</code> werden Materialien dem pers&ouml;nlichen Raum eines Nutzenden hinzugef&uuml;gt.<br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID - Kennung, Portal und pers&ouml;nlicher Raum sucht sich CommSy aus den Daten in der Session.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>xml_material_list (string) - XML-String zur Definition der Materialienliste</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: xml_link_list (string) - Datei in XML-Notation</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->addPrivateRoomMaterialList('session_id','xml_material_list');
           </code></div>
            Detaillierter Input (xml_material_list):
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
            &lt;material_list&gt;</code>
               <div style="padding-left: 30px;"><code>&lt;material_item&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;item_id&gt;12345&lt;/item_id&gt;<br/>
                  &lt;title&gt;Hallo Die Enten&lt;/title&gt;<br/>
                  &lt;description&gt;Eine tolle Beschreibung&lt;/description&gt;<br/>
                  &lt;extras&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;study_log&gt;&lt;/study_log&gt;<br/>
                  </code></div>
                  <code>&lt;/extras&gt;</code><br/>
                  <code>
                  &lt;bib_kind&gt;book&lt;/bib_kind&gt;<br/>
                  &lt;common&gt;Allgemeine bibliografischen Angaben&lt;/common&gt;<br/>
                  &lt;booktitle&gt;Das große Entenbuch&lt;/booktitle&gt;<br/>
                  &lt;publisher&gt;Hamburg University Press&lt;/publisher&gt;<br/>
                  &lt;address&gt;Hamburg&lt;/address&gt;<br/>
                  &lt;volume&gt;4&lt;/volume&gt;<br/>
                  &lt;series&gt;13&lt;/series&gt;<br/>
                  &lt;isbn&gt;3608935444&lt;/isbn&gt;<br/>
                  &lt;issn&gt;978-3608935448&lt;/issn&gt;<br/>
                  &lt;pages&gt;12-24&lt;/pages&gt;<br/>
                  &lt;journal&gt;26&lt;/journal&gt;<br/>
                  &lt;issue&gt;3&lt;/issue&gt;<br/>
                  &lt;university&gt;Universität Hamburg&lt;/university&gt;<br/>
                  &lt;faculty&gt;MIN-Fakultät&lt;/faculty&gt;<br/>
                  &lt;thesis_kind&gt;dissertation&lt;/thesis_kind&gt;<br/>
                  &lt;url&gt;http://service.commsy.net&lt;/url&gt;<br/>
                  &lt;url_date&gt;26.03.2007&lt;/url_date&gt;
                  </code><br/>
                  <code>&lt;date&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;year&gt;2010&lt;/year&gt;
                  </code></div>
                  <code>&lt;/date&gt;</code><br/>
                  <code>&lt;author_list&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;author_item&gt;Jackewitz, Iver&lt;/author_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/author_list&gt;</code><br/>
                  <code>&lt;editor_list&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;editor_item&gt;Jackewitz, Iver&lt;/editor_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/editor_list&gt;</code><br/>
                  <code>&lt;keyword_list&gt;</code><br/>
                  <div style="padding-left: 30px;"><code>
                  &lt;keyword_item&gt;CommSy&lt;/keyword_item&gt;<br/>
                  ...</code></div>
                  <code>&lt;/keyword_list&gt;</code><br/>
                  <code>&lt;label&gt;Hausaufgabe&lt;/label&gt;</code>
                  </div>
               <code>&lt;/material_item&gt;</code></div>
               <div style="padding-left: 30px;"><code>&lt;material_item&gt;</code>
                  <div style="padding-left: 30px;"><code>...</code></div>
               <code>&lt;/material_item&gt;<br/>
               ...</code></div>
               <code>&lt;/material_list&gt;
           </code></div>
           <p>Die Werte für <code>bib_kind</code> sind:</p>
           <ul>
              <li>none</li>
              <li>common</li>
              <li>book</li>
              <li>collection</li>
              <li>incollection</li>
              <li>article</li>
              <li>inpaper</li>
              <li>thesis</li>
              <li>manuscript</li>
              <li>website</li>
           </ul>
           <p>Die Werte für <code>thesis_kind</code> sind:</p>
           <ul>
              <li>term</li>
              <li>bachelor</li>
              <li>master</li>
              <li>exam</li>
              <li>diploma</li>
              <li>dissertation</li>
              <li>postdoc</li>
           </ul>
            Detaillierter Output im Erfolgsfall:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               &lt;link_list&gt;</code>
                  <div style="padding-left: 30px;"><code>
                  &lt;link&gt;</code>
                  <div style="padding-left: 30px;"><code>
                     &lt;original_id&gt;12345&lt;/original_id&gt;<br/>
                     &lt;commsy_id&gt;654321&lt;/commsy_id&gt;</code></div>
               <code>
                  &lt;/link&gt;<br/>
                  ...</code></div>
               <code>
               &lt;/link_list&gt;
           </code></div>
           Durch diesen Output k&ouml;nnen in einem zweiten Schritt mit den Methoden <code>addFileForMaterial</code> bzw. <code>linkFileToMaterial</code> Dateien an die gerade hinzugef&uuml;gten Materialien geh&auml;ngt werden.
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">addFileForMaterial</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit der Methode <code>addFileForMaterial</code> ist es m&ouml;glich, gezielt an vorhandene Materialien, neue Dateien zu h&auml;ngen.<br/><br/>
            Achtung: Dieser Mechanismus erzeugt sehr viel Overhead, daher existiert auch ein alternativer Weg über HTTP-POST (<a href="#upload_http">siehe unten</a>).<br/><br/>
            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss schreibenden Zugriff auf die Datei haben, d.h. Mitglied im entsprechenden Raum sein und das Material bearbeiten d&uuml;rfen.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>material_id (integer) - Item-ID des Materials, an die die Datei geh&auml;ngt werden soll</li>
                  <li>xml_file_item (string) - XML-String zur Definition der Datei</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: file_id (integer) - Item-ID der neu angelegten Datei</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->addFileForMaterial('session_id','material_id','xml_file_item');
           </code></div>
            Detaillierter Input (xml_material_list):
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
               &lt;file_item&gt;</code>
                     <div style="padding-left: 30px;"><code>
                     &lt;filename&gt;iver_jackewitz.jpg&lt;/filename&gt;<br/>
                     &lt;base64&gt;/9j/4AAQSkZJRgABAQEEsASwAAD/2wBDAA...&lt;/base64&gt;</code></div>
                  <code>
               &lt;/file_item&gt;</code></div>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h4">linkFileToMaterial</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Mit dieser Methode wird eine vorhandene Datei kopiert und neu an das spezifizierte Material geh&auml;ngt. Durch diese Methode k&ouml;nnen externe Tools einen mehrfachen Upload der selben Datei vermeiden.<br/><br/>

            Bedingungen:
            <ul>
            <li>G&uuml;ltige Session-ID</li>
            <li>Kennung muss lesenden Zugriff auf Datei und schreibenden auf das Material haben, d.h. Mitglied im entsprechenden Raum sein und das Material bearbeiten d&uuml;rfen.</li>
            </ul>
            &Uuml;berblick:
            <table style="font-size: small; border-collapse:collapse; border: 1px solid grey; margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;" summary="for layout">
            <tr>
            <td style="vertical-align: top; border-right: 1px solid grey; padding: 10px;">
               Input:
               <ul style="font-size: small;">
                  <li>session_id (string) - Session-ID zu einer g&uuml;ltigen Session des Nutzenden</li>
                  <li>material_id (integer) - Item-ID des Materials, an die die Datei geh&auml;ngt werden soll</li>
                  <li>file_id (integer) - Item-ID der bereits vorhandenen Datei, die neu an das Material geh&auml;ngt werden soll</li>
               </ul>
            </td>
            <td style="vertical-align: top; padding: 10px;">
               Output:
               <ul style="font-size: small;">
                  <li>Erfolg: file_id (integer) - Item-ID der neu angelegten Datei</li>
                  <li>Fehler: soap_fault (object) - SOAP-Fehlerobjekt mit Informationen zum Fehler</li>
               </ul>
            </td>
            </tr>
            </table>
            Anwendung:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;"><code>
$result = $client->linkFileToMaterial('session_id','material_id','file_id');
           </code></div>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="upload_http"></A>Dateiupload</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            Da das Hochladen von Dateien via SOAP einen Overhead von 33% erzeugt, kann über folgenden Weg einen Datei an einen Eintrag in einem CommSy-Raum gehängt werden.<br/><br/>
            Definitionen:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;">
            URL = http://COMMSY_SERVER/commsy.php?cid=RAUM_ID&amp;mod=file&amp;fct=upload<br/>
            COMMSY_SERVER = die URL des CommSy-Servers bzw. Portals<br/>
            RAIM_ID = Die Item-ID des Raumes in den die Datei geladen werden soll.
            </div>
            Übergabe per POST oder GET:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;">
            item_id = ItemID des CommSy-Elementes, an die die Datei angehängt werden soll.<br/>
            SID = session_id einer gültigen Session des Nutzenden
            </div>
            Übergabe per POST:
            <div style="margin: 10px; padding: 10px; border: 1px solid grey; background-color: lightgrey;">
            Per POST muss dann die Datei selbst übermittelt werden, wobei der Name "upload" sein muss.
            <code>&lt;input type="file" name="upload"/&gt;</code>
            </div>
         </TD>
        </TR>
        <TR>
         <TD CLASS="h3"><A NAME="ims"></A>IMS</TD>
        </TR>
        <TR>
         <TD CLASS="fliesstext">
            siehe: <a href="docu_ims.html">docu_ims.html</a>
         </TD>
        </TR>
       </TABLE>
      </TD>
<!-- /Contentspalte -->
     </TR>
    </TABLE>
     <tr>
        <td>
        <table style="width: 100%" summary="for layout">
        <TR>
         <TD CLASS="fliesstext" style="font-size: xx-small;">
 Autor: Iver Jackewitz<br/>
 Datum: 10.07.2008
         </TD>
  <td align="right"><A href="http://sourceforge.net"><IMG src="sourceforge-logo.jpg" width="100" height="30" border="0" alt="SourceForge Logo"></A></td>
  </tr>
  </table>
  </td>
  </tr>
 </TABLE>
</BODY>
</HTML>