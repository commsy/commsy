{% extends 'knp_menu.html.twig' %}

{% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

{% macro attributes(attributes) %}
{% for name, value in attributes %}
    {%- if value is not none and value is not sameas(false) -%}
        {{- ' %s="%s"'|format(name, value is sameas(true) ? name|e : value|e)|raw -}}
    {%- endif -%}
{%- endfor -%}
{% endmacro %}

{% block list %}
{% if item.hasChildren and options.depth is not sameas(0) and item.displayChildren %}
    {% import _self as knp_menu %}
    <ul id="switch_room" class="uk-nav uk-nav-parent-icon"{{ knp_menu.attributes(listAttributes) }}>
        <li>
            <span>
                <i class="uk-icon-list uk-icon-small cs-menue-padding"></i>
                {{ 'roomlist'|transchoice(1, {}, "rubric")|upper }}
                <ul class="cs-roomlist">
                     {{ block('children') }}
                </ul>
            </span>
        </li>
    </ul>
{% endif %}
{% endblock %}


{% block linkElement %}
       {{ block('label') }}
{% endblock %}

{% block label %}
    {{ render(controller(
        'CommsyBundle:User:rooms',
        { 'roomId': item.extras.roomId, 'itemId': item.extras.user.itemId }
    ))}}
    
    <div class="room-load-more" data-uk-scrollspy="{cls:'uk-animation-fade', repeat: true}" data-rooms='{"url": "{{ app.request.baseURL }}/room/{{item.extras.roomId}}/user/{{item.extras.user.itemId}}/rooms/", "target": "#roomList"}'>
        <i class="uk-icon-refresh uk-icon-spin uk-icon-medium cs-menue-padding"></i>
    </div>
        
{% endblock %}
