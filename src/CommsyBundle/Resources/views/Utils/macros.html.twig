{% macro iconClassForItemType(type) %}
    {% if type == 'announcement' %}
        uk-icon-comment-o
    {% elseif type == 'date' %}
        uk-icon-calendar
    {% elseif type == 'material' %}
        uk-icon-file-o
    {% elseif type == 'section' %}
        uk-icon-file-o
    {% elseif type == 'discussion' %}
        uk-icon-comments-o
    {% elseif type == 'user' %}
        uk-icon-user
    {% elseif type == 'group' %}
        uk-icon-group
    {% elseif type == 'todo' %}
        uk-icon-check
    {% elseif type == 'task' %}
        uk-icon-home
    {% endif %}
{% endmacro %}

{% macro lastModified(item) %}
    {{ 'last modified on'|trans({})|capitalize }}: {{ item.modificationDate|date("d.m.Y") }}
    {{ 'at'|trans({}) }} {{ item.modificationDate|date("H:i") }}
    {{ 'by'|trans({}) }}
    <a href="{{ path('commsy_user_detail', {'roomId': item.contextId, 'itemId': item.modificatorItem.itemId}) }}">
        {{ item.modificatorItem.fullname }}
    </a>
{% endmacro %}

{% macro userStatus(user) %}
    {% if user.status == 0 %}
        {{ 'quit'|trans({})|capitalize }}
    {% elseif user.status == 1 %}
        {{ 'request'|trans({})|capitalize }}
    {% elseif user.status == 2 %}
        {{ 'user'|trans({})|capitalize }}
    {% elseif user.status == 3 %}
        {{ 'moderator'|trans({})|capitalize }}
    {% endif %}
{% endmacro %}

{% macro detailInformation(item, modifierList) %}
    {% import _self as macros %}
    <div class="uk-margin-bottom">
        <div class="toggle-{{ item.itemId }} uk-vertical-align">
            <div class="uk-margin-right uk-vertical-align-middle">
                {% if item.creator.isUser %}
                    {{  macros.userIconLink(item.creator, 'small') }}
                {% else %}
                    {{  macros.userIcon(item.creator, 'small') }}
                {% endif %}
            </div>
            <div class="uk-vertical-align-middle uk-margin-remove">
                <a class="toggle-{{ item.itemId }}" data-uk-toggle="{target:'.toggle-{{ item.itemId }}', animation:'uk-animation-fade'}">{{ 'show more'|trans({}) }}</a>
            </div>
        </div>
        <div class="uk-comment-header uk-flex uk-hidden toggle-{{ item.itemId }}">
            <div class="uk-margin-right">
                {% if item.creator.isUser %}
                    {{  macros.userIconLink(item.creator) }}
                {% else %}
                    {{  macros.userIcon(item.creator) }}
                {% endif %}
            </div>
            <div class="uk-margin-right">
                <div class="uk-comment-meta">
                    {{ 'by'|trans({})|capitalize }}: {{item.creator.fullname}}
                </div>
                <div class="uk-comment-meta">
                    {{ 'created'|trans({})|capitalize }}: {{item.creationDate|date("d.m.Y H:i")}}
                </div>
                <div class="uk-comment-meta">
                    {{ 'last changed'|trans({})|capitalize }}: {{item.modificationDate|date("d.m.Y H:i")}}
                </div>
                <a class="toggle-{{ item.itemId }} uk-hidden" data-uk-toggle="{target:'.toggle-{{ item.itemId }}', animation:'uk-animation-fade'}">{{ 'show less'|trans({}) }}</a>
            </div>
            {% if modifierList[item.itemId] is defined %}
                {% if not modifierList[item.itemId] is empty %}
                    <div class="uk-margin-right">
                        <div class="uk-comment-meta">
                            {{ 'additional\neditors'|trans({})|capitalize|nl2br }}:
                        </div>
                    </div>
                    {% for modifier in modifierList[item.itemId] %}
                        <div class="uk-margin-small-right">
                            {% if modifier.isUser %}
                                {{  macros.userIconLink(modifier, 'small') }}
                            {% else %}
                                {{  macros.userIcon(modifier, 'small') }}
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endif %}
        </div>
    </div>
{% endmacro %}

{% macro statusColor(readerList, itemId) %}
    {% if readerList[itemId] is defined %}
        {% if readerList[itemId] == 'new' %}
            cs-comment-new
        {% elseif readerList[itemId] == 'changed' %}
            cs-comment-changed
        {% endif %}
    {% endif %}
{% endmacro %}

{% macro iconClassForFileType(type) %}
    {% if type == 'xlsx' or type == 'xls' %}
        uk-icon-file-excel-o
    {% elseif type == 'docx' or type == 'doc' or type == 'ods' %}
        uk-icon-file-word-o
    {% elseif type == 'pptx' or type == 'ppt' %}
        uk-icon-file-powerpoint-o
    {% elseif type == 'pdf' %}
        uk-icon-file-pdf-o
    {% elseif type == 'zip' or type == 'ipa' %}
        uk-icon-file-archive-o
    {% elseif type == 'png' or type == 'jpg' or type == 'eps' or type == 'gif' or type == 'svg' %}
        uk-icon-file-image-o
    {% elseif type == 'txt' or type == 'csv' or type == 'md' %}
        uk-icon-file-text-o
    {% elseif type == 'mpg' or type == 'wmv' or type == 'mp4' or type == 'avi' %}
        uk-icon-file-movie-o
    {% else %}
        uk-icon-file-o
    {% endif %}
{% endmacro %}

{% macro fileList(item) %}
    {% import _self as macros %}
    {% set fileArray = item.fileList.to_array %}
    {% if not fileArray is empty %}
        <ul class="uk-list">
        {% for file in fileArray %}
            <li><i class="{{ macros.iconClassForFileType(file.extension) }}"></i> <a href="{{ path('commsy_file_getfile', {'fileId': file.fileId}) }}">{{ file.filename }}</a></li>
        {% endfor %}
        </ul>
    {% endif %}
{% endmacro %}

{% macro fileListShort(item) %}
    {% import _self as macros %}
    {% if item.itemType != 'material' %}
        {% set fileArray = item.fileList.to_array %}
    {% else %}
        {% set fileArray = item.fileListWithFilesFromSections.to_array %}
    {% endif %}
    {% if not fileArray is empty %}
        {% for file in fileArray %}
            <a href="{{ path('commsy_file_getfile', {'fileId': file.fileId}) }}" data-uk-tooltip title="{{ file.filename }}"><i class="{{ macros.iconClassForFileType(file.extension) }}"></i></a>
        {% endfor %}
    {% endif %}
{% endmacro %}

{% macro fileListDetailView(item) %}
    {% import _self as macros %}
    {% set fileArray = item.fileList.to_array %}
    {% if not fileArray is empty %}
        <div class="uk-flex">
            <div>
                <h4>{{ 'files'|trans({})|capitalize }} ({{ fileArray|length }})</h4>
            </div>
            <div class="uk-margin-left">
                <a class="" data-uk-toggle="{target:'.toggle-files-{{ item.itemId }}', animation:'uk-animation-fade'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
            </div>
        </div>
        <div class="toggle-files-{{ item.itemId }} uk-hidden">
            <div data-uk-grid="{gutter: 20}">
                {% for file in fileArray %}
                    <div class="uk-width-medium-1-2 uk-width-large-1-4">
                        <div class="uk-panel uk-panel-box-secondary uk-vertical-align">
                            <div class="uk-margin-right uk-vertical-align-middle">
                                <i class="uk-icon-small {{ macros.iconClassForFileType(file.extension) }}"></i>
                            </div>
                            <div class="uk-vertical-align-middle">
                                <a href="{{ path('commsy_file_getfile', {'fileId': file.fileId}) }}" data-uk-tooltip title="{{ file.filename }}">{{ file.filename|truncate(15) }}</a><br/>
                                ({{ file.fileSize }})
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% else %}
        <div class="uk-flex">
            <div>
                <h4>{{ 'files'|trans({})|capitalize }} ({{ 'no files'|trans({})|capitalize }})</h4>
            </div>
        </div>
    {% endif %}
{% endmacro %}

{% macro userIcon(user, size) %}
    {% if size == 'small' %}
        <img class="uk-comment-avatar uk-thumbnail uk-border-circle" style="height:30px; width:30px;" src="{{ path('commsy_user_image', {'roomId': user.contextId, 'itemId': user.itemId}) }}" data-uk-tooltip title="{{ user.fullname }}">
    {% elseif size matches '/^\\d+$/' %}
        <img class="uk-comment-avatar uk-thumbnail uk-border-circle" style="height:{{ size }}px; width:{{ size }}px;" src="{{ path('commsy_user_image', {'roomId': user.contextId, 'itemId': user.itemId}) }}" data-uk-tooltip title="{{ user.fullname }}">
    {% else %}
        <img class="uk-comment-avatar uk-thumbnail uk-border-circle cs-comment-thumbnail" style="height:42px; width:42px;" src="{{ path('commsy_user_image', {'roomId': user.contextId, 'itemId': user.itemId}) }}" data-uk-tooltip title="{{ user.fullname }}">
    {% endif %}
{% endmacro %}

{% macro userIconLink(user, size) %}
    {% import _self as macros %}
    <a href="{{ path('commsy_user_detail', {'roomId': user.contextId, 'itemId': user.itemId}) }}">
        {{  macros.userIcon(user, size) }}
    </a>
{% endmacro %}

{% macro editControl(item) %}
    <div class="toggle-edit-{{ item.itemId }} uk-hidden">
        EInstellungen
    </div>
    <button data-uk-toggle="{target:'.toggle-edit-{{ item.itemId }}', animation:'uk-animation-fade'}">
        <i class="uk-icon-gear uk-icon-small"></i>
    </button>
{% endmacro %}

{% macro descriptionDetailView(item) %}
    {% import _self as macros %}
    {% if not item.description == "" %}
        <div class="uk-grid cs-toggle">
            <div class="uk-width-9-10">
                <div class="toggle-description-{{ item.itemId }}">
                    <div class="uk-panel">
                        {{ item.description|truncate(500)|striptags }}
                    </div>
                </div>
                <div class="toggle-description-{{ item.itemId }} uk-hidden">
                    <div class="uk-panel">
                        {{ item.description|raw }}
                    </div>
                </div>
            </div>
            <div class="uk-width-1-10 cs-toggle-icon">
                <a class="" data-uk-toggle="{target:'.toggle-description-{{ item.itemId }}', animation:'uk-animation-fade'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
            </div>
        </div>
    {% endif %}
{% endmacro %}

{% macro uploadForm(item) %}
    {% import _self as macros %}
    <article class="uk-article uk-position-relative" data-uk-observe data-cs-edit="{editUrl: '{{ path('commsy_upload_uploadform', {'roomId': item.contextId, 'itemId': item.itemId}) }}' }">
        {# edit #}
        {% if is_granted('ITEM_EDIT', item.itemId) %}
            <div class="uk-position-top-right cs-article-edit uk-hidden">
                <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
            </div>

            {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
        {% endif %}
        {{  macros.fileListDetailView(item) }}
    </article>
{% endmacro %}

{# ------------------- #}

{% macro editSectionStart(title, item, edit = true, empty = false) %}
<div class="uk-margin-left uk-margin-right uk-margin-bottom uk-position-relative">
    <a name="description"></a>
    {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
    <div class="uk-grid uk-margin-small-bottom">
        <div class="uk-width-9-10">
            <h4>{{ title|trans({})|capitalize }}</h4>
        </div>
        <div class="uk-width-1-10">
            {% if edit %}
                <!-- <i class="uk-icon-small uk-icon-hover uk-icon-edit"></i> -->
                {# edit #}
                {% if is_granted('ITEM_EDIT', item.itemId) %}
                    <div class="cs-edit uk-hidden">
                        <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
    <div class="uk-grid uk-margin-top-remove">
        <div class="uk-width-9-10">
            <div class="toggle-{{ title }}-{{ item.itemId }} cs-toggle-preview">
                <div class="uk-panel">
{% endmacro %}

{% macro editSectionSeperator(title, item) %}
                </div>
            </div>
            <div class="toggle-{{ title }}-{{ item.itemId }} uk-hidden">
                <div class="uk-panel">
{% endmacro %}

{% macro editSectionEnd(title, item) %}
                </div>
            </div>
        </div>
        <div class="uk-width-1-10 cs-toggle-icon">
            <a class="cs-toggle" data-uk-toggle="{target:'.toggle-{{ title }}-{{ item.itemId }}', animation:'uk-animation-fade'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
        </div>
    </div>
</div>
{% endmacro %}

{% macro editSection(title, item, edit, preview, content) %}
<div class="uk-margin-left uk-margin-right uk-margin-bottom uk-position-relative">
    <a name="description"></a>
    {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
    <div class="uk-grid uk-margin-small-bottom">
        <div class="uk-width-9-10">
            <h4>{{ title|trans({})|capitalize }}</h4>
        </div>
        <div class="uk-width-1-10">
            {% if edit %}
                {% if is_granted('ITEM_EDIT', item.itemId) %}
                    <div class="cs-edit uk-hidden">
                        <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
    {% if not preview is empty %}
    <div class="uk-grid uk-margin-top-remove">
        <div class="uk-width-9-10">
            <div class="toggle-{{ title }}-{{ item.itemId }} cs-toggle-preview">
                <div class="uk-panel">
                    {{ preview|raw }}
                </div>
            </div>
            <div class="toggle-{{ title }}-{{ item.itemId }} uk-hidden">
                <div class="uk-panel">
                    {% if not content is empty %}
                        {{ content|raw }}
                    {% else %}
                        {{ preview|raw }}
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="uk-width-1-10 cs-toggle-icon">
            <a class="cs-toggle" data-uk-toggle="{target:'.toggle-{{ title }}-{{ item.itemId }}', animation:'uk-animation-fade'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
        </div>
    </div>
    {% else %}
    <div class="uk-grid uk-margin-top-remove">
        <div class="uk-width-1-1">
            <div class="toggle-{{ title }}-{{ item.itemId }} cs-toggle-preview-empty">
                <div class="uk-panel">
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endmacro %}