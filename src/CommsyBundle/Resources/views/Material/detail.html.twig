{% extends 'CommsyBundle:Base:room.html.twig' %}

{% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

{% set item = material %}

{% block content %}
    <div class="uk-grid">
        <div class="uk-width-medium-1-5">
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                <ul class="uk-nav">
                    <li><a href="">Menü 1</a></li>
                    <li><a href="">Menü 1</a></li>
                    <li><a href="">Menü 1</a></li>
                </ul>
            </div>
        </div>
    
        <div class="uk-width-medium-4-5">
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# content #}
                <article class="uk-article uk-position-relative" data-uk-observe data-cs-edit="{editUrl: '{{ path('commsy_material_edit', {'roomId': roomId, 'itemId': material.itemId}) }}' }">
                    {# edit #}
                    {% if is_granted('ITEM_EDIT', material.itemId) %}
                        <div class="uk-position-top-right cs-article-edit uk-hidden">
                            <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                        </div>
            
                        {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
                    {% endif %}
            
                    {# title #}
                    <h2 class="uk-artitcle-title">{{ material.title|raw }}</h2>
            
                    {# modifier information #}
                    {{ macros.detailInformation(material, modifierList) }}
            
                    {# additional meta description #}
                    <p class="uk-article-meta">
                        {% include 'CommsyBundle:Material:biblio.html.twig' %}
                    </p>
            
                    <div class="uk-margin-left">
                        {# main description #}
                        <div class="cs-detail-description">
                            {{ material.description|raw }}
                        </div>
            
                        {# files #}
                        <div class="cs-detail-files">
                            {{  macros.fileListDetailView(material) }}
                        </div>
                    </div>
                </article>
            
                <!-- -->
                
                <div class="uk-panel uk-panel-box uk-panel-box-primary">
                    <div id="user-main" class="uk-overflow-container">
                        <div class="">
                            <ul class="uk-list uk-list-striped uk-margin-bottom-remove">
                            {% for section in sectionList [0:10] %}
                                <li>
                                    <div class="uk-grid uk-grid-collapse">
                                        <div class="uk-width-1-10">{{ loop.index }}.</div>
                                        <div class="uk-width-9-10 uk-text-truncate"><a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw }}</a></div>
                                    </div>
                                    <div class="uk-grid uk-grid-collapse">
                                        <div class="uk-width-1-10"></div>
                                        <div class="uk-width-9-10">{{ macros.fileListShort(section) }}</div>
                                    </div>
                                </li>
                            {% endfor %}
                            </ul>
                            {% if sectionList|length > 10 %}
                                <div class="show-more-sections uk-hidden">
                                    <ul class="uk-list uk-list-striped">
                                    {% for section in sectionList [10:sectionList|length-10] %}
                                        <li>
                                        <div class="uk-grid uk-grid-collapse">
                                            <div class="uk-width-1-10">{{ loop.index + 10 }}.</div>
                                            <div class="uk-width-9-10 uk-text-truncate"><a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw }}</a></div>
                                        </div>
                                        <div class="uk-grid uk-grid-collapse">
                                            <div class="uk-width-1-10"></div>
                                            <div class="uk-width-9-10">{{ macros.fileListShort(section) }}</div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                    </ul>
                                </div>
                                <div class="uk-margin-small">
                                    <a class="show-more-sections" data-uk-toggle="{target:'.show-more-sections', animation:'uk-animation-fade'}">{{ 'show all'|trans({}) }}</a>
                                    <a class="show-more-sections uk-hidden" data-uk-toggle="{target:'.show-more-sections', animation:'uk-animation-fade'}">{{ 'show less'|trans({}) }}</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <div class="uk-grid">
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Link:show',
                            { 'roomId': app.request.attributes.get('roomId'), 'itemId': material.itemId }
                        ))}}
                    </div>
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Category:show',
                            { 'roomId': roomId }
                        ))}}
                    </div>
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Hashtag:show',
                            { 'roomId': roomId }
                        ))}}
                    </div>
                </div>
            </div>
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# material sections #}
                <div id="cs-sections">
                    {% for section in sectionList %}
                        {% if  not loop.first %}
                            <hr class="uk-article-divider">
                        {% endif %}
            
                        <article class="uk-article uk-position-relative" data-uk-observe data-cs-edit="{editUrl: '{{ path('commsy_material_editsection', {'roomId': roomId, 'itemId': section.itemId}) }}' }">
                            {# anchor #}
                            <a name="{{ section.itemId }}"></a>
            
                            {# edit #}
                            {% if is_granted('ITEM_EDIT', section.itemId) %}
                                <div class="uk-position-top-right cs-article-edit uk-hidden">
                                    <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                                </div>
            
                                {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
                            {% endif %}
            
                            {# title #}
                            <h3 class="uk-artitcle-title">{{ section.title|raw }}</h3>
            
                            {# modifier information #}
                            {{ macros.detailInformation(section, modifierList) }}
            
                            <div class="uk-margin-left">
                                {# section description #}
                                <div class="cs-detail-description">
                                    {{ section.description|raw }}
                                </div>
            
                                {# files #}
                                <div class="cs-detail-files">
                                    {{  macros.fileListDetailView(section) }}
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            </div>
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# annotations #}
                {% if item.itemType != 'discussion' %}
                    <div class="uk-panel uk-panel-divider">
                        <div class="uk-panel">
                            <h3 class="uk-panel-title">{{ 'annotations'|trans({})|capitalize }}</h3>
                        </div>
                        {{ render(controller(
                            'CommsyBundle:Annotation:feed',
                            { 'roomId': roomId, 'linkedItemId': item.itemId }
                        ))}}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}