{% extends 'CommsyBundle:Base:room.html.twig' %}

{% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

{% set item = material %}

{% block content %}
    <div class="uk-grid">
        <div class="uk-width-medium-1-5">
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                <ul class="uk-nav">
                    <li><a href="">Menü 1</a></li>
                    <li><a href="">Menü 1</a></li>
                    <li><a href="">Menü 1</a></li>
                </ul>
            </div>
        </div>
    
        <div class="uk-width-medium-4-5">
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# content #}
                <article class="uk-article uk-position-relative" data-uk-observe data-cs-edit="{editUrl: '{{ path('commsy_material_edit', {'roomId': roomId, 'itemId': material.itemId}) }}' }">
                    {# edit #}
                    {% if is_granted('ITEM_EDIT', material.itemId) %}
                        <div class="uk-position-top-right cs-article-edit uk-hidden">
                            <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                        </div>
            
                        {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
                    {% endif %}
            
                    {# title #}
                    <h2 class="uk-artitcle-title">{{ material.title|raw }}</h2>
            
                    {# modifier information #}
                    {{ macros.detailInformation(material, modifierList) }}
            
                    {# additional meta description #}
                    <p class="uk-article-meta">
                        {% include 'CommsyBundle:Material:biblio.html.twig' %}
                    </p>
            
                    <div class="uk-margin-left">
                        {# main description #}
                        <div class="cs-detail-description">
                            {{  macros.descriptionDetailView(material) }}
                        </div>
            
                        {# files #}
                        <div class="cs-detail-files">
                            {{  macros.fileListDetailView(material) }}
                        </div>
                        
                        {# sections #}
                        <div class="cs-detail-sections">
                            <div class="uk-grid cs-detail-toggle">
                                <div class="uk-width-9-10">
                                    <div class="toggle-sections">
                                        <div class="uk-slidenav-position" data-uk-slider="{infinite: false}">
                                            <div class="uk-slider-container">
                                                <ul class="uk-slider uk-grid uk-grid-width-medium-1-4">
                                                    {% for section in sectionList %}
                                                        <li>
                                                            <div class="uk-panel uk-panel-box-secondary">
                                                                <a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw|truncate(15) }}</a>
                                                            </div>
                                                        </li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            {% if sectionList|length > 4 %}
                                                <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-previous" data-uk-slider-item="previous" draggable="false"></a>
                                                <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-next" data-uk-slider-item="next" draggable="false"></a>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="toggle-sections uk-hidden">
                                        <div data-uk-grid="{gutter: 20}">
                                            {% for section in sectionList %}
                                                <div class="uk-width-medium-1-2 uk-width-large-1-3">
                                                    <div class="uk-panel uk-panel-box-secondary">
                                                        <h3 class="uk-panel-title"><i class="{{ section.title|raw }}"></i></h3>
                                                        <span class="uk-text-middle">
                                                            <a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw }}</a>
                                                            {{ macros.fileListShort(section) }}
                                                        </span>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-10 cs-detail-toggle-icon">
                                    <a class="" data-uk-toggle="{target:'.toggle-sections', animation:'uk-animation-fade'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
                
                <div class="uk-grid">
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Link:show',
                            { 'roomId': app.request.attributes.get('roomId'), 'itemId': material.itemId }
                        ))}}
                    </div>
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Category:show',
                            { 'roomId': roomId }
                        ))}}
                    </div>
                    <div class="uk-width-medium-1-3">
                        {{ render(controller(
                            'CommsyBundle:Hashtag:show',
                            { 'roomId': roomId }
                        ))}}
                    </div>
                </div>
            </div>
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# material sections #}
                <div id="cs-sections">
                    {% for section in sectionList %}
                        {% if  not loop.first %}
                            <hr class="uk-article-divider">
                        {% endif %}
            
                        <article class="uk-article uk-position-relative" data-uk-observe data-cs-edit="{editUrl: '{{ path('commsy_material_editsection', {'roomId': roomId, 'itemId': section.itemId}) }}' }">
                            {# anchor #}
                            <a name="{{ section.itemId }}"></a>
            
                            {# edit #}
                            {% if is_granted('ITEM_EDIT', section.itemId) %}
                                <div class="uk-position-top-right cs-article-edit uk-hidden">
                                    <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                                </div>
            
                                {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
                            {% endif %}
            
                            {# title #}
                            <h3 class="uk-artitcle-title">{{ section.title|raw }}</h3>
            
                            {# modifier information #}
                            {{ macros.detailInformation(section, modifierList) }}
            
                            <div class="uk-margin-left">
                                {# section description #}
                                <div class="cs-detail-description">
                                    {{  macros.descriptionDetailView(section) }}
                                </div>
            
                                {# files #}
                                <div class="cs-detail-files">
                                    {{  macros.fileListDetailView(section) }}
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            </div>
            <div class="uk-panel uk-panel-box uk-margin-bottom">
                {# annotations #}
                {% if item.itemType != 'discussion' %}
                    <div class="uk-panel uk-panel-divider">
                        <div class="uk-panel">
                            <h3 class="uk-panel-title">{{ 'annotations'|trans({})|capitalize }}</h3>
                        </div>
                        {{ render(controller(
                            'CommsyBundle:Annotation:feed',
                            { 'roomId': roomId, 'linkedItemId': item.itemId }
                        ))}}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}