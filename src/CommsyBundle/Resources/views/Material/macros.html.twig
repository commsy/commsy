{% macro title(item, modifierList) %}
    {% import 'CommsyBundle:Utils:macros.html.twig' as macros %}
    
    <div class="uk-margin-right uk-margin-bottom">
        <a name="title"></a>
        {% set pathName = '' %}
        {% if item.itemType == 'material' %}
            {% set pathName = 'commsy_material_edit' %}
        {% elseif item.itemType == 'section' %}
            {% set pathName = 'commsy_material_edit' %}
        {% endif %}
        <div class="uk-grid uk-margin-left uk-margin-small-bottom cs-edit-section" data-uk-observe data-cs-edit="{editUrl: '{{ path(pathName, {'roomId': item.contextId, 'itemId': item.itemId}) }}' }">
            <div class="uk-width-9-10 uk-padding-remove">
                <h1 class="uk-article-title">{{ item.title|raw }}</h1>
                {% if item.itemType == 'material' %}
                    {% set material = item %}
                    {% include 'CommsyBundle:Material:biblio.html.twig' %}
                {% endif %}
            </div>
            <div class="uk-width-1-10">
                <!-- <i class="uk-icon-small uk-icon-hover uk-icon-edit"></i> -->
                {# edit #}
                {% if is_granted('ITEM_EDIT', item.itemId) %}
                    <div class="cs-edit uk-hidden">
                        <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
                    </div>
                    {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
                {% endif %}
                <div class="cs-toggle-icon">
                    <a class="" data-uk-toggle="{target:'.toggle-title-{{ item.itemId }}'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
                </div>
            </div>
        </div>
        <div class="uk-grid uk-margin-small-left uk-margin-top-remove">
            <div class="uk-width-9-10 uk-padding-remove">
                <div class="toggle-title-{{ item.itemId }}">
                    <div class="uk-panel">
                        <div class="uk-grid uk-margin-bottom">
                            <div class="uk-width-1-1">
                                <div class="uk-flex">
                                    <div class="uk-margin-right">
                                        {% if item.creator.isUser %}
                                            {{  macros.userIconLink(item.creator) }}
                                        {% else %}
                                            {{  macros.userIcon(item.creator) }}
                                        {% endif %}
                                    </div>
                                    <div class="uk-margin-right">
                                        {{ 'last changed'|trans({})|capitalize }}: {{item.modificationDate|date("d.m.Y H:i")}}
                                    </div>
                                    <div class="uk-margin-right">
                                        {% if item.itemType != 'section' %}
                                            {{  macros.ratingStatus(item) }}
                                            {{  macros.workflowStatus(item) }}
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="toggle-title-{{ item.itemId }} uk-hidden">
                    <div class="uk-panel">
                        <div class="uk-grid">
                            <div class="uk-width-2-3">
                                <div class="uk-flex">
                                    <div class="uk-margin-right">
                                        {% if item.creator.isUser %}
                                            {{  macros.userIconLink(item.creator) }}
                                        {% else %}
                                            {{  macros.userIcon(item.creator) }}
                                        {% endif %}
                                    </div>
                                    <div class="uk-margin-right">
                                        {{ 'last changed'|trans({})|capitalize }}: {{item.modificationDate|date("d.m.Y H:i")}}
                                    </div>
                                    <div class="uk-margin-right">
                                        {% if item.itemType != 'section' %}
                                            {{  macros.ratingStatus(item) }}
                                            {{  macros.workflowStatus(item) }}
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="uk-width-1-3">
                                <div class="uk-clearfix">
                                    <div class="uk-align-right uk-margin-remove">
                                        {{ 'reference number'|trans({})|capitalize }}: {{ item.itemId }}<br/>
                                        {{ 'created by'|trans({})|capitalize }}: {{ item.creator.fullname }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="uk-clearfix">
                            <div class="uk-align-right">
                                {% if modifierList[item.itemId] is defined %}
                                    {% if not modifierList[item.itemId] is empty %}
                                        <div class="uk-flex">
                                            {% for modifier in modifierList[item.itemId] %}
                                                <div class="">
                                                    {% if modifier.isUser %}
                                                        {{  macros.userIconLink(modifier) }}
                                                    {% else %}
                                                        {{  macros.userIcon(modifier) }}
                                                    {% endif %}
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endmacro %}

{% macro titleSave(item) %}
    <div class="uk-width-9-10 uk-padding-remove">
        <h1 class="uk-article-title">{{ item.title|raw }}</h1>
        {% if item.itemType == 'material' %}
            {% set material = item %}
            {% include 'CommsyBundle:Material:biblio.html.twig' %}
        {% endif %}
    </div>
    <div class="uk-width-1-10">
        <!-- <i class="uk-icon-small uk-icon-hover uk-icon-edit"></i> -->
        {# edit #}
        {% if is_granted('ITEM_EDIT', item.itemId) %}
            <div class="cs-edit uk-hidden">
                <a href="#" class="uk-icon-hover uk-icon-small uk-icon-edit"></a>
            </div>
            {% include 'CommsyBundle:Utils:editSpinner.html.twig' %}
        {% endif %}
        <div class="cs-toggle-icon">
            <a class="" data-uk-toggle="{target:'.toggle-title-{{ item.itemId }}'}"><i class="uk-icon-small uk-icon-hover uk-icon-chevron-down"></i></a>
        </div>
    </div>
{% endmacro %}

{% macro files(item) %}
    {% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

    {% set preview = '' %}
    {% set content = '' %}
    
    {% set fileArray = item.fileList.to_array %}
    {% if not fileArray is empty %}
        {% if fileArray|length > 4 %}
            {% set preview %}
            <div class="uk-slidenav-position" data-uk-slider="{infinite: false}">
                <div class="uk-slider-container">
                    <ul class="uk-slider uk-grid uk-grid-width-medium-1-4">
                        {% for file in fileArray %}
                             <li>
                                <div class="uk-panel uk-panel-box-secondary uk-vertical-align">
                                    <div class="uk-margin-right uk-vertical-align-middle">
                                        <i class="uk-icon-small {{ macros.iconClassForFileType(file.extension) }}"></i>
                                    </div>
                                    <div class="uk-vertical-align-middle">
                                        <a href="{{ path('commsy_file_getfile', {'fileId': file.fileId}) }}" data-uk-tooltip title="{{ file.filename }}">{{ file.filename|truncate(15) }}</a><br/>
                                        ({{ file.fileSize }})
                                    </div>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-previous" data-uk-slider-item="previous" draggable="false"></a>
                <a href="" class="uk-slidenav uk-slidenav-contrast uk-slidenav-next" data-uk-slider-item="next" draggable="false"></a>
            </div>
            {% endset %}
        {% endif %}
    
        {% set content %}
        <div data-uk-grid="{gutter: 20}">
            {% for file in fileArray %}
                <div class="uk-width-medium-1-2 uk-width-large-1-4">
                    <div class="uk-panel uk-panel-box-secondary uk-vertical-align">
                        <div class="uk-margin-right uk-vertical-align-middle">
                            <i class="uk-icon-small {{ macros.iconClassForFileType(file.extension) }}"></i>
                        </div>
                        <div class="uk-vertical-align-middle">
                            <a href="{{ path('commsy_file_getfile', {'fileId': file.fileId}) }}" data-uk-tooltip title="{{ file.filename }}">{{ file.filename|truncate(15) }}</a><br/>
                            ({{ file.fileSize }})
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        {% endset %}
    {% endif %}
    
    {{ macros.editSection('files', item, true, content, preview) }}
{% endmacro %}

{% macro links(item) %}
    {% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

    {% set preview %}
    <div class="uk-grid">
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Link:show',
                { 'roomId': item.contextId, 'itemId': item.itemId }
            ))}}
        </div>
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Category:show',
                { 'roomId': item.contextId }
            ))}}
        </div>
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Hashtag:show',
                { 'roomId': item.contextId }
            ))}}
        </div>
    </div>
    {% endset %}

    {% set content %}
    <div class="uk-grid">
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Link:show',
                { 'roomId': item.contextId, 'itemId': item.itemId }
            ))}}
        </div>
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Category:show',
                { 'roomId': item.contextId }
            ))}}
        </div>
        <div class="uk-width-medium-1-3">
            {{ render(controller(
                'CommsyBundle:Hashtag:show',
                { 'roomId': item.contextId }
            ))}}
        </div>
    </div>
    {% endset %}
    
    {{ macros.editSection('links', item, true, content, preview) }}
{% endmacro %}

{% macro sections(item, sectionList) %}
    {% import 'CommsyBundle:Utils:macros.html.twig' as macros %}

    {% set preview = '' %}
    {% set content = '' %}
    
    {% if not sectionList is empty %}
        {% set preview %}
        <ul class="uk-list uk-list-striped">
            {% for section in sectionList %}
                <li>
                    <a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw }}</a><br/>
                    {{ macros.fileListShort(section) }}
                </li>
            {% endfor %}
        </ul>
        {% endset %}
    
        {% set content %}
        <ul class="uk-list uk-list-striped">
            {% for section in sectionList %}
                <li>
                    <a href="#{{ section.itemId }}" data-uk-tooltip title="{{ section.title|raw }}">{{ section.title|raw }}</a><br/>
                    {{ macros.fileListShort(section) }}
                </li>
            {% endfor %}
        </ul>
        {% endset %}
    {% endif %}
    
    {{ macros.editSection('sections', item, true, content, preview) }}
{% endmacro %}