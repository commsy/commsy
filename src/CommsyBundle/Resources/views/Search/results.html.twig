{% extends 'CommsyBundle:Base:room.html.twig' %}

{% form_theme filterForm 'CommsyBundle:Form:uikit_horizontal_dynamic_layout.html.twig' %}

{% block content %}
    <div class="uk-grid" data-uk-grid-margin>

        {# sidebar #}
        <div class="uk-width-medium-1-3 uk-push-2-3">

            <div class="uk-panel uk-panel-box uk-panel-box-primary">
                <div class="uk-panel-teaser cs-panel-teaser-primary">
                    <div class="uk-clearfix">
                        <div class="uk-float-right">
                            <a href="#" class="button-toggle uk-button-mini uk-button-secondary" data-uk-toggle="{target: '#list-filter', animation: 'uk-animation-fade'}">
                                <i class="uk-icon-chevron-up"></i>
                            </a>
                        </div>
                        <div class="uk-text-large uk-float-left">
                            {{ 'Restrict Results'|trans({}, 'search')}}
                        </div>
                    </div>
                </div>

                <div id="list-filter" class="uk-hidden-small">
                    {{ form_start(filterForm) }}
                    {{ form_widget(filterForm) }}
                    {{ form_end(filterForm) }}
                </div>
            </div>

        </div>

        {# search results #}
        <div class="uk-width-medium-2-3 uk-pull-1-3">

            <div class="uk-panel uk-panel-box uk-panel-box-primary">
                
                <div class="uk-panel-teaser cs-panel-teaser-primary">
                    <div class="uk-flex uk-flex-middle uk-flex-space-between">
                        <div class="uk-text-large">
                            {{ 'Search for "%query%" (%totalHits% Hits)'| trans({
                                '%query%': query,
                                '%totalHits%': totalHits
                            }, 'search') }}
                        </div>
                    </div>
                </div>

                <div class="feed">
                    <ul id="search-feed" class="uk-comment-list" data-uk-observe>
                        {% include 'CommsyBundle:Search:feed.html.twig' %}
                    </ul>

                    {# setup "load more" if we do not show all results yet #}
                    {% if totalHits != results|length %}
                        <div class="feed-load-more" data-uk-scrollspy="{repeat: true, cls:'cs-toggle-class'}" data-feed='{
                                "url": "{{ app.request.baseURL  }}/room/{{ roomId  }}/searchmore/",
                                "target": "#search-feed",
                                "query": {
                                    "search": "{{ query }}"
                                }
                        }'>
                            <i class="uk-icon-refresh uk-icon-spin uk-icon-medium"></i>
                            <div class="cs-toggle-class"></div>
                        </div>
                    {% endif %}
                </div>
            </div>

        </div>

    </div>
{% endblock %}