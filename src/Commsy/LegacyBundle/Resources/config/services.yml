parameters:
        legacy.site_index: %kernel.root_dir%/../web/commsy_legacy.php

services:
    # Legacy kernel
    commsy_legacy.legacy_kernel:
        class: Commsy\LegacyBundle\Kernel\LegacyKernel
        arguments: [%legacy.site_index%, @service_container]

    # Legacy authentication
    commsy_legacy.legacy_authentication:
        class: Commsy\LegacyBundle\Authentication\LegacyAuthentication
        arguments: [@commsy_legacy.environment]

    # Event listeners
    commsy_legacy.listener.legacy_kernel_listener:
        class: Commsy\LegacyBundle\EventListener\LegacyKernelListener
        arguments: [@commsy_legacy.legacy_kernel, "@commsy_legacy.environment"]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    commsy_legacy.listener.legacy_authentication_listener:
        class: Commsy\LegacyBundle\EventListener\LegacyAuthenticationListener
        arguments: [@commsy_legacy.legacy_authentication, @commsy_legacy.environment]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    # Legacy Environment
    commsy_legacy.environment:
        class: Commsy\LegacyBundle\Services\LegacyEnvironment
        arguments: [%legacy.site_index%, "@service_container"]
    
    commsy.room_feed_generator:
        class: Commsy\LegacyBundle\Utils\RoomFeedGenerator
        arguments: ["@commsy_legacy.environment", @commsy.room_service]

    commsy.tag_manager:
        class: Commsy\LegacyBundle\Utils\TagManager
        arguments: ["@commsy_legacy.environment"]

    commsy_legacy.material_manager:
        class: Commsy\LegacyBundle\Utils\MaterialManager
        arguments: ["@commsy_legacy.environment"]

    commsy.room_service:
        class: Commsy\LegacyBundle\Utils\RoomService
        arguments: ["@commsy_legacy.environment"]
        
    commsy.file_service:
        class: Commsy\LegacyBundle\Utils\FileService
        arguments: ["@commsy_legacy.environment"]
        
    commsy.user_service:
        class: Commsy\LegacyBundle\Utils\UserService
        arguments: ["@commsy_legacy.environment"]
    
    commsy.item_service:
        class: Commsy\LegacyBundle\Utils\ItemService
        arguments: ["@commsy_legacy.environment"]
        
    commsy.label_service:
        class: Commsy\LegacyBundle\Utils\LabelService
        arguments: ["@commsy_legacy.environment"]
        
    commsy.group_service:
        class: Commsy\LegacyBundle\Utils\GroupService
        arguments: ["@commsy_legacy.environment"]
        
    commsy.dashboard_feed_generator:
        class: Commsy\LegacyBundle\Utils\DashboardFeedGenerator
        arguments: ["@commsy_legacy.environment", @commsy.room_service]