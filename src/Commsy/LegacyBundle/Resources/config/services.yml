parameters:
        legacy.site_index: "%kernel.root_dir%/../web/commsy_legacy.php"

services:
    _defaults:
        public: true

    # Legacy kernel
    commsy_legacy.legacy_kernel:
        class: App\Kernel\LegacyKernel
        arguments: ['%legacy.site_index%', '@service_container']

    # Legacy authentication
    commsy_legacy.legacy_authentication:
        class: App\Authentication\LegacyAuthentication
        arguments: ['@commsy_legacy.environment']

    # Event subscriber
    commsy_legacy.subscriber.KernelSubscriber:
        class: App\EventSubscriber\KernelSubscriber
        arguments:
            - '@commsy_legacy.legacy_kernel'
            - '@commsy_legacy.legacy_authentication'
            - '@commsy_legacy.item_service'
            - '@commsy_legacy.file_service'
            - '@router'
            - '@commsy_legacy.environment'
        tags:
            - { name: kernel.event_subscriber }

    # Legacy Environment
    commsy_legacy.environment:
        alias: App\Services\LegacyEnvironment

    Commsy\LegacyBundle\Services\LegacyEnvironment:
        public: true
        autowire: true
        arguments: ['%legacy.site_index%', '@service_container']

    commsy_legacy.category_service:
        class: App\Utils\CategoryService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.material_service:
        alias: App\Utils\MaterialService

    Commsy\LegacyBundle\Utils\MaterialService:
        autowire: true

    commsy_legacy.room_service:
        alias: App\Utils\RoomService

    Commsy\LegacyBundle\Utils\RoomService:
        autowire: true

    commsy_legacy.file_service:
        alias: App\Utils\FileService

    Commsy\LegacyBundle\Utils\FileService:
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.user_service:
        alias: App\Utils\UserService

    Commsy\LegacyBundle\Utils\UserService:
        autowire: true

    commsy_legacy.item_service:
        alias: App\Utils\ItemService

    Commsy\LegacyBundle\Utils\ItemService:
        autowire: true

    commsy_legacy.label_service:
        class: App\Utils\LabelService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.group_service:
        class: App\Utils\GroupService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.institution_service:
        class: App\Utils\InstitutionService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.topic_service:
        class: App\Utils\TopicService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.noticed_service:
        class: App\Utils\NoticedService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.reader_service:
        class: App\Utils\ReaderService
        arguments: ['@commsy_legacy.environment', '@commsy_legacy.item_service']

    commsy_legacy.date_service:
        class: App\Utils\DateService
        arguments: ['@commsy_legacy.environment']
    
    commsy_legacy.annotation_service:
        class: App\Utils\AnnotationService
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.announcement_service:
        class: App\Utils\AnnouncementService
        arguments:
          - '@commsy_legacy.environment'
        
    commsy_legacy.discussion_service:
        class: App\Utils\DiscussionService
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.todo_service:
        alias: App\Utils\TodoService

    Commsy\LegacyBundle\Utils\TodoService:
        autowire: true
        
    commsy_legacy.disc_service:
        class: App\Utils\DiscService
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.assessment_service:
        class: App\Utils\AssessmentService
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.download_service:
        alias: App\Utils\DownloadService

    Commsy\LegacyBundle\Utils\DownloadService:
        autowire: true
        arguments:
            $printService: '@commsy.print_service'
        
    commsy_legacy.project_service:
        class: App\Utils\ProjectService
        arguments: ['@commsy_legacy.environment']

    Commsy\LegacyBundle\Utils\PortfolioService:
        autowire: true
        autoconfigure: true

    # Markup
    commsy_legacy.markup:
        class: App\Services\LegacyMarkup
        arguments:
            - '@commsy_legacy.environment'
            - '@router'
            - '@translator'

    # Transformer
    commsy_legacy.transformer.general_settings:
        class: App\Form\DataTransformer\GeneralSettingsTransformer
        arguments: ['@commsy_legacy.environment', '@commsy_legacy.room_service', '@commsy_legacy.user_service']

    commsy_legacy.transformer.moderation_settings:
        class: App\Form\DataTransformer\ModerationSettingsTransformer
        arguments: ['@commsy_legacy.environment', '@commsy_legacy.room_service', '@commsy_legacy.user_service']

    commsy_legacy.transformer.additional_settings:
        class: App\Form\DataTransformer\AdditionalSettingsTransformer
        arguments: ['@commsy_legacy.environment', '@commsy_legacy.room_service', '@commsy_legacy.user_service']

    commsy_legacy.transformer.appearance_settings:
        class: App\Form\DataTransformer\AppearanceSettingsTransformer
        arguments: ['@commsy_legacy.environment', '@commsy_legacy.room_service', '@commsy_legacy.user_service']

    commsy_legacy.transformer.extension_settings:
        class: App\Form\DataTransformer\ExtensionSettingsTransformer
        arguments:
          - '@commsy_legacy.environment'
          - '@commsy_legacy.room_service'
          - '@commsy_mediawiki.mediawiki'
          - '%commsy.mediawiki.enabled%'

    commsy_legacy.transformer.material:
        class: App\Form\DataTransformer\MaterialTransformer
        arguments:
            - '@commsy_legacy.environment'
        
    commsy_legacy.transformer.section:
        class: App\Form\DataTransformer\SectionTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.user:
        class: App\Form\DataTransformer\UserTransformer
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.transformer.privateroom:
        class: App\Form\DataTransformer\PrivateRoomTransformer
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.transformer.item:
        class: App\Form\DataTransformer\ItemTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.annotation:
        class: App\Form\DataTransformer\AnnotationTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.announcement:
        class: App\Form\DataTransformer\AnnouncementTransformer
        arguments: ['@commsy_legacy.environment']
       
    commsy_legacy.transformer.date:
        class: App\Form\DataTransformer\DateTransformer
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.transformer.todo:
        class: App\Form\DataTransformer\TodoTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.step:
        class: App\Form\DataTransformer\StepTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.discussion:
        class: App\Form\DataTransformer\DiscussionTransformer
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.transformer.discarticle:
        class: App\Form\DataTransformer\DiscussionarticleTransformer
        arguments: ['@commsy_legacy.environment']
        
    commsy_legacy.transformer.group:
        class: App\Form\DataTransformer\GroupTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.institution:
        class: App\Form\DataTransformer\InstitutionTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.topic:
        class: App\Form\DataTransformer\TopicTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.project:
        class: App\Form\DataTransformer\ProjectTransformer
        arguments: ['@commsy_legacy.environment']

    commsy_legacy.transformer.portfolio:
        class: App\Form\DataTransformer\PortfolioTransformer
        arguments: ['@commsy_legacy.environment']