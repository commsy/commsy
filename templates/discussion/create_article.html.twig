{% import 'utils/macros.html.twig' as macros %}
{% import 'discussion/macros.html.twig' as macrosDiscussion %}
{% import 'item/macros.html.twig' as macrosItem %}

<div class="uk-panel uk-panel-box uk-margin-top" data-parentId="{{ parentId }}">
    <article class="uk-article uk-position-relative cs-edit-draft">
        {# title #}
            {{ form_start(form) }}
            {{ form_errors(form) }}
        <header class="uk-comment-header uk-flex">
            <div class="uk-margin-right uk-flex-item-none">
                {% if not article.modificatorItem.isDeleted and article.modificatorItem.isUser %}
                    {{ macros.userIconLink(article.modificatorItem) }}
                {% else %}
                    {{ macros.userIcon(article.modificatorItem) }}
                {% endif %}
            </div>

            <div class="uk-width-8-10">
                <label class="uk-form-label">
                    {{ form_label(form.description) }}
                </label>
                <div class="uk-margin-left">
                    {{ form_widget(form.description, {'id': 'annotationedit' ~ article.itemId}) }}
                </div>
            </div>

            <div class="uk-flex uk-margin-small-top">
                <div class="uk-margin-small-left">
                    {{ form_row(form.save) }}
                </div>
                <div class="uk-margin-small-left">
                    {{ form_row(form.cancel) }}
                </div>
            </div>

            {{ form_row(form._token) }}
            {{ form_end(form, {'render_rest': false}) }}
            {#{ macrosDiscussion.title(section, modifierList, userCount, readCount, readSinceModificationCount) }#}

        </header>

        {# files #}
        <div class="uk-margin-bottom">
            <a class="cs-toggle uk-margin-left" data-uk-toggle="{target:'.toggle-files'}">
                {{ 'add files here'|trans({}, "form") }}
            </a>
        </div>

        <div class="toggle-files uk-hidden" aria-hidden="false">
            <div class="cs-edit-section" data-uk-observe data-cs-edit="{
                editUrl: '{{ path('app_upload_uploadform', {
                    'roomId': article.contextId, 'itemId': article.itemId
                }) }}',
                cancelEditUrl: '{{ path('app_item_canceledit', {
                    'roomId': article.contextId, 'itemId': article.itemId
                }) }}'
            }">
                {{ macrosItem.files(article, article.draft) }}
            </div>
        </div>

        <div id="draft-buttons-wrapper" data-item-type="article">
            <a id="draft-save-combine-link" href="" class="uk-button uk-button-primary">
                {{ 'create entry'|trans({}, "form") }}
            </a>
            <a id="draft-cancel-link" href="" class="uk-button uk-button-secondary">
                {{ 'cancel'|trans({}, "form") }}
            </a>
        </div>
    </article>
</div>