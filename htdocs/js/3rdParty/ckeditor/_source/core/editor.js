//>>built
define("ckeditor/_source/core/editor",["dijit","dojo","dojox"],function(){(function(){function a(){var d,a=this._.commands,c=this.mode;if(c)for(var b in a)d=a[b],d[d.startDisabled?"disable":this.readOnly&&!d.readOnly?"disable":d.modes[c]?"enable":"disable"]()}var b=0,f=function(){var d="editor"+ ++b;return CKEDITOR.instances&&CKEDITOR.instances[d]?f():d},e={},g=function(d){var a=d.config.customConfig;if(!a)return!1;var a=CKEDITOR.getUrl(a),c=e[a]||(e[a]={});c.fn?(c.fn.call(d,d.config),(CKEDITOR.getUrl(d.config.customConfig)==
a||!g(d))&&d.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.load(a,function(){c.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){};g(d)});return!0},m=function(d,a){d.on("customConfigLoaded",function(){if(a){if(a.on)for(var c in a.on)d.on(c,a.on[c]);CKEDITOR.tools.extend(d.config,a,!0);delete d.config.on}var b=d.config.skin.split(",");c=b[0];b=CKEDITOR.getUrl(b[1]||"_source/skins/"+c+"/");d.skinName=c;d.skinPath=b;d.skinClass="cke_skin_"+c;d.tabIndex=d.config.tabIndex||d.element.getAttribute("tabindex")||
0;d.readOnly=!(!d.config.readOnly&&!d.element.getAttribute("disabled"));d.fireOnce("configLoaded");l(d)});if(a&&void 0!=a.customConfig)d.config.customConfig=a.customConfig;g(d)||d.fireOnce("customConfigLoaded")},o=function(a){CKEDITOR.lang.load(a.config.language,a.config.defaultLanguage,function(b,c){a.langCode=b;a.lang=CKEDITOR.tools.prototypedCopy(c);if(CKEDITOR.env.gecko&&10900>CKEDITOR.env.version&&"rtl"==a.lang.dir)a.lang.dir="ltr";a.fire("langLoaded");var f=a.config;"ui"==f.contentsLangDirection&&
(f.contentsLangDirection=a.lang.dir);n(a)})},n=function(a){var b=a.config,c=b.plugins,f=b.extraPlugins,b=b.removePlugins;if(f)var e=RegExp("(?:^|,)(?:"+f.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),c=c.replace(e,""),c=c+(","+f);b&&(e=RegExp("(?:^|,)(?:"+b.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),c=c.replace(e,""));CKEDITOR.env.air&&(c+=",adobeair");CKEDITOR.plugins.load(c.split(","),function(b){var c=[],f=[],e=[];a.plugins=b;for(var h in b){var i=b[h],g=i.lang,k=CKEDITOR.plugins.getPath(h),j=null;i.path=
k;g&&(j=0<=CKEDITOR.tools.indexOf(g,a.langCode)?a.langCode:g[0],!i.langEntries||!i.langEntries[j]?e.push(CKEDITOR.getUrl(k+"lang/"+j+".js")):(CKEDITOR.tools.extend(a.lang,i.langEntries[j]),j=null));f.push(j);c.push(i)}CKEDITOR.scriptLoader.load(e,function(){for(var b=["beforeInit","init","afterInit"],e=0;e<b.length;e++)for(var h=0;h<c.length;h++){var g=c[h];0===e&&f[h]&&g.lang&&CKEDITOR.tools.extend(a.lang,g.langEntries[f[h]]);if(g[b[e]])g[b[e]](a)}a.fire("pluginsLoaded");p(a)})})},l=function(a){CKEDITOR.skins.load(a,
"editor",function(){o(a)})},p=function(a){var b=a.config.theme;CKEDITOR.themes.load(b,function(){var c=a.theme=CKEDITOR.themes.get(b);c.path=CKEDITOR.themes.getPath(b);c.build(a);a.config.autoUpdateElement&&q(a)})},q=function(a){var b=a.element;if(a.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&b.is("textarea")){var c=b.$.form&&new CKEDITOR.dom.element(b.$.form);if(c){var e=function(){a.updateElement()};c.on("submit",e);if(!c.$.submit.nodeName&&!c.$.submit.length)c.$.submit=CKEDITOR.tools.override(c.$.submit,
function(b){return function(){a.updateElement();b.apply?b.apply(this,arguments):b()}});a.on("destroy",function(){c.removeListener("submit",e)})}}};CKEDITOR.editor.prototype._init=function(){var b=CKEDITOR.dom.element.get(this._.element),e=this._.instanceConfig;delete this._.element;delete this._.instanceConfig;this._.commands={};this._.styles=[];this.name=(this.element=b)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(b.getId()||b.getNameAtt())||f();if(this.name in CKEDITOR.instances)throw'[CKEDITOR.editor] The instance "'+
this.name+'" already exists.';this.id=CKEDITOR.tools.getNextId();this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config);this.ui=new CKEDITOR.ui(this);this.focusManager=new CKEDITOR.focusManager(this);CKEDITOR.fire("instanceCreated",null,this);this.on("mode",a,null,null,1);this.on("readOnly",a,null,null,1);m(this,e)}})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(a,b){return this._.commands[a]=new CKEDITOR.command(this,b)},addCss:function(a){this._.styles.push(a)},destroy:function(a){a||
this.updateElement();this.fire("destroy");this.theme&&this.theme.destroy(this);CKEDITOR.remove(this);CKEDITOR.fire("instanceDestroyed",null,this)},execCommand:function(a,b){var f=this.getCommand(a),e={name:a,commandData:b,command:f};return f&&f.state!=CKEDITOR.TRISTATE_DISABLED&&!0!==this.fire("beforeCommandExec",e)&&(e.returnValue=f.exec(e.commandData),!f.async&&!0!==this.fire("afterCommandExec",e))?e.returnValue:!1},getCommand:function(a){return this._.commands[a]},getData:function(){this.fire("beforeGetData");
var a=this._.data;if("string"!=typeof a)a=(a=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?a.is("textarea")?a.getValue():a.getHtml():"";a={dataValue:a};this.fire("getData",a);return a.dataValue},getSnapshot:function(){var a=this.fire("getSnapshot");if("string"!=typeof a){var b=this.element;b&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(a=b.is("textarea")?b.getValue():b.getHtml())}return a},loadSnapshot:function(a){this.fire("loadSnapshot",a)},setData:function(a,b,f){if(b)this.on("dataReady",
function(a){a.removeListener();b.call(a.editor)});a={dataValue:a};!f&&this.fire("setData",a);this._.data=a.dataValue;!f&&this.fire("afterSetData",a)},setReadOnly:function(a){a=void 0==a||a;if(this.readOnly!=a)this.readOnly=a,this.fire("readOnly")},insertHtml:function(a){this.fire("insertHtml",a)},insertText:function(a){this.fire("insertText",a)},insertElement:function(a){this.fire("insertElement",a)},checkDirty:function(){return this.mayBeDirty&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){if(this.mayBeDirty)this._.previousValue=
this.getSnapshot()},updateElement:function(){var a=this.element;if(a&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){var b=this.getData();this.config.htmlEncodeOutput&&(b=CKEDITOR.tools.htmlEncode(b));a.is("textarea")?a.setValue(b):a.setHtml(b)}}});CKEDITOR.on("loaded",function(){var a=CKEDITOR.editor._pending;if(a){delete CKEDITOR.editor._pending;for(var b=0;b<a.length;b++)a[b]._init()}})});