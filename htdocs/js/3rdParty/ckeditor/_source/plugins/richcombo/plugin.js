//>>built
define("ckeditor/_source/plugins/richcombo/plugin",["dijit","dojo","dojox"],function(){CKEDITOR.plugins.add("richcombo",{requires:["floatpanel","listblock","button"],beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}});CKEDITOR.UI_RICHCOMBO="richcombo";CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(a){CKEDITOR.tools.extend(this,a,{title:a.label,modes:{wysiwyg:1}});a=this.panel||{};delete this.panel;this.id=CKEDITOR.tools.getNextNumber();this.document=
a&&a.parent&&a.parent.getDocument()||CKEDITOR.document;a.className=(a.className||"")+" cke_rcombopanel";a.block={multiSelect:a.multiSelect,attributes:a.attributes};this._={panelDefinition:a,items:{},state:CKEDITOR.TRISTATE_OFF}},statics:{handler:{create:function(a){return new CKEDITOR.ui.richCombo(a)}}},proto:{renderHtml:function(a){var c=[];this.render(a,c);return c.join("")},render:function(a,c){function e(){var b=this.modes[a.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;this.setState(a.readOnly&&
!this.readOnly?CKEDITOR.TRISTATE_DISABLED:b);this.setValue("")}var g=CKEDITOR.env,d="cke_"+this.id,f=CKEDITOR.tools.addFunction(function(b){var c=this._;if(c.state!=CKEDITOR.TRISTATE_DISABLED)if(this.createPanel(a),c.on)c.panel.hide();else{this.commit();var d=this.getValue();d?c.list.mark(d):c.list.unmarkAll();c.panel.showBlock(this.id,new CKEDITOR.dom.element(b),4)}},this),b={id:d,combo:this,focus:function(){CKEDITOR.document.getById(d).getChild(1).focus()},clickFn:f};a.on("mode",e,this);!this.readOnly&&
a.on("readOnly",e,this);var h=CKEDITOR.tools.addFunction(function(a,c){var a=new CKEDITOR.dom.event(a),d=a.getKeystroke();switch(d){case 13:case 32:case 40:CKEDITOR.tools.callFunction(f,c);break;default:b.onkey(b,d)}a.preventDefault()}),i=CKEDITOR.tools.addFunction(function(){b.onfocus&&b.onfocus()});b.keyDownFn=h;c.push('<span class="cke_rcombo" role="presentation">',"<span id=",d);this.className&&c.push(' class="',this.className,' cke_off"');c.push(' role="presentation">','<span id="'+d+'_label" class=cke_label>',
this.label,"</span>",'<a hidefocus=true title="',this.title,'" tabindex="-1"',g.gecko&&10900<=g.version&&!g.hc?"":" href=\"javascript:void('"+this.label+"')\"",' role="button" aria-labelledby="',d,'_label" aria-describedby="',d,'_text" aria-haspopup="true"');(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&c.push(' onkeypress="return false;"');CKEDITOR.env.gecko&&c.push(' onblur="this.style.cssText = this.style.cssText;"');c.push(' onkeydown="CKEDITOR.tools.callFunction( ',h,', event, this );" onfocus="return CKEDITOR.tools.callFunction(',
i,', event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction(',f,', this); return false;"><span><span id="'+d+'_text" class="cke_text cke_inline_label">'+this.label+"</span></span><span class=cke_openbutton><span class=cke_icon>"+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span></span>");if(this.onRender)this.onRender();return b},createPanel:function(a){if(!this._.panel){var c=this._.panelDefinition,e=this._.panelDefinition.block,
g=c.parent||CKEDITOR.document.getBody(),d=new CKEDITOR.ui.floatPanel(a,g,c),f=d.addListBlock(this.id,e),b=this;d.onShow=function(){b.className&&this.element.getFirst().addClass(b.className+"_panel");b.setState(CKEDITOR.TRISTATE_ON);f.focus(!b.multiSelect&&b.getValue());b._.on=1;if(b.onOpen)b.onOpen()};d.onHide=function(c){b.className&&this.element.getFirst().removeClass(b.className+"_panel");b.setState(b.modes&&b.modes[a.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);b._.on=0;if(!c&&b.onClose)b.onClose()};
d.onEscape=function(){d.hide()};f.onClick=function(a,c){b.document.getWindow().focus();b.onClick&&b.onClick.call(b,a,c);c?b.setValue(a,b._.items[a]):b.setValue("");d.hide(!1)};this._.panel=d;this._.list=f;d.getBlock(this.id).onHide=function(){b._.on=0;b.setState(CKEDITOR.TRISTATE_OFF)};this.init&&this.init()}},setValue:function(a,c){this._.value=a;var e=this.document.getById("cke_"+this.id+"_text");if(e)!a&&!c?(c=this.label,e.addClass("cke_inline_label")):e.removeClass("cke_inline_label"),e.setHtml("undefined"!=
typeof c?c:a)},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(a){this._.list.mark(a)},hideItem:function(a){this._.list.hideItem(a)},hideGroup:function(a){this._.list.hideGroup(a)},showAll:function(){this._.list.showAll()},add:function(a,c,e){this._.items[a]=e||a;this._.list.add(a,c,e)},startGroup:function(a){this._.list.startGroup(a)},commit:function(){if(!this._.committed)this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this);
this._.committed=1},setState:function(a){if(this._.state!=a)this.document.getById("cke_"+this.id).setState(a),this._.state=a}}});CKEDITOR.ui.prototype.addRichCombo=function(a,c){this.add(a,CKEDITOR.UI_RICHCOMBO,c)}});