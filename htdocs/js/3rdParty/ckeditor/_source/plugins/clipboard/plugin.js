//>>built
define("ckeditor/_source/plugins/clipboard/plugin",["dijit","dojo","dojox"],function(){(function(){function l(a){a.cancel()}function q(a,c,b){var f=this.document;if(!f.getById("cke_pastebin")){if("text"==c&&a.data&&a.data.$.clipboardData){var e=a.data.$.clipboardData.getData("text/plain");if(e){a.data.preventDefault();b(e);return}}var g=this.getSelection(),a=new CKEDITOR.dom.range(f),d=new CKEDITOR.dom.element("text"==c?"textarea":CKEDITOR.env.webkit?"body":"div",f);d.setAttribute("id","cke_pastebin");
CKEDITOR.env.webkit&&d.append(f.createText("\u00a0"));f.getBody().append(d);d.setStyles({position:"absolute",top:g.getStartElement().getDocumentPosition().y+"px",width:"1px",height:"1px",overflow:"hidden"});d.setStyle("ltr"==this.config.contentsLangDirection?"left":"right","-1000px");var h=g.createBookmarks();this.on("selectionChange",l,null,null,0);"text"==c?d.$.focus():(a.setStartAt(d,CKEDITOR.POSITION_AFTER_START),a.setEndAt(d,CKEDITOR.POSITION_BEFORE_END),a.select(!0));var i=this;window.setTimeout(function(){var t;
i.document.getBody().focus();i.removeListener("selectionChange",l);CKEDITOR.env.ie7Compat?(g.selectBookmarks(h),d.remove()):(d.remove(),g.selectBookmarks(h));var a;t=CKEDITOR.env.webkit&&(a=d.getFirst())&&a.is&&a.hasClass("Apple-style-span")?a:d,d=t;b(d["get"+("text"==c?"Value":"Html")]())},0)}}function m(a){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var c=a.getSelection(),b;if(c.getType()==CKEDITOR.SELECTION_ELEMENT&&(b=c.getSelectedElement())){var f=c.getRanges()[0],e=a.document.createText("");e.insertBefore(b);
f.setStartBefore(e);f.setEndAfter(b);c.selectRanges([f]);setTimeout(function(){b.getParent()&&(e.remove(),c.selectElement(b))},0)}}}function i(a,c){var b;if(n&&a in{Paste:1,Cut:1})return CKEDITOR.TRISTATE_DISABLED;if("Paste"==a){CKEDITOR.env.ie&&(h=1);try{b=c.document.$.queryCommandEnabled(a)||CKEDITOR.env.webkit}catch(f){}h=0}else{var e=(b=c.getSelection())&&b.getRanges();b=b&&!(1==e.length&&e[0].collapsed)}return b?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}function j(){if("wysiwyg"==this.mode){var a=
i("Paste",this);this.getCommand("cut").setState(i("Cut",this));this.getCommand("copy").setState(i("Copy",this));this.getCommand("paste").setState(a);this.fire("pasteState",a)}}var o=function(a,c){var b=a.document,f=b.getBody(),e=!1,g=function(){e=!0};f.on(c,g);(7<CKEDITOR.env.version?b.$:b.$.selection.createRange()).execCommand(c);f.removeListener(c,g);return e},r=CKEDITOR.env.ie?function(a,c){return o(a,c)}:function(a,c){try{return a.document.$.execCommand(c,!1,null)}catch(b){return!1}},k=function(a){this.type=
a;this.canUndo="cut"==this.type;this.startDisabled=!0};k.prototype={exec:function(a){"cut"==this.type&&m(a);var c=r(a,this.type);c||alert(a.lang.clipboard[this.type+"Error"]);return c}};var p={canUndo:!1,exec:CKEDITOR.env.ie?function(a){a.focus();if(!a.document.getBody().fire("beforepaste")&&!o(a,"paste"))return a.fire("pasteDialog"),!1}:function(a){try{if(!a.document.getBody().fire("beforepaste")&&!a.document.$.execCommand("Paste",!1,null))throw 0;}catch(c){return setTimeout(function(){a.fire("pasteDialog")},
0),!1}}},s=function(a){if("wysiwyg"==this.mode)switch(a.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:a=this.document.getBody();(CKEDITOR.env.opera||CKEDITOR.env.gecko)&&a.fire("paste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:var c=this;this.fire("saveSnapshot");setTimeout(function(){c.fire("saveSnapshot")},0)}},h,n;CKEDITOR.plugins.add("clipboard",{requires:["dialog","htmldataprocessor"],init:function(a){function c(b,c,e,g){var d=a.lang[c];a.addCommand(c,e);a.ui.addButton(b,
{label:d,command:c});a.addMenuItems&&a.addMenuItem(c,{label:d,command:c,group:"clipboard",order:g})}a.on("paste",function(b){b=b.data;b.html?a.insertHtml(b.html):b.text&&a.insertText(b.text);setTimeout(function(){a.fire("afterPaste")},0)},null,null,1E3);a.on("pasteDialog",function(){setTimeout(function(){a.openDialog("paste")},0)});a.on("pasteState",function(b){a.getCommand("paste").setState(b.data)});c("Cut","cut",new k("cut"),1);c("Copy","copy",new k("copy"),4);c("Paste","paste",p,8);CKEDITOR.dialog.add("paste",
CKEDITOR.getUrl(this.path+"dialogs/paste.js"));a.on("key",s,a);a.on("contentDom",function(){var b=a.document.getBody();b.on(!CKEDITOR.env.ie?"paste":"beforepaste",function(b){if(!h){var c=b.data&&b.data.$;if(!CKEDITOR.env.ie||!c||c.ctrlKey){var g={mode:"html"};a.fire("beforePaste",g);q.call(a,b,g.mode,function(b){if(b=CKEDITOR.tools.trim(b.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/ig,""))){var c={};c[g.mode]=b;a.fire("paste",c)}})}}});CKEDITOR.env.ie&&(b.on("contextmenu",function(){h=1;setTimeout(function(){h=
0},0)}),b.on("paste",function(b){a.document.getById("cke_pastebin")||(b.data.preventDefault(),h=0,p.exec(a))}));b.on("beforecut",function(){!h&&m(a)});b.on("mouseup",function(){setTimeout(function(){j.call(a)},0)},a);b.on("keyup",j,a)});a.on("selectionChange",function(b){n=b.data.selection.getRanges()[0].checkReadOnly();j.call(a)});a.contextMenu&&a.contextMenu.addListener(function(b,c){c.getRanges()[0].checkReadOnly();return{cut:i("Cut",a),copy:i("Copy",a),paste:i("Paste",a)}})}})})()});