//>>built
define("ckeditor/_source/plugins/pastefromword/plugin",["dijit","dojo","dojox"],function(){(function(){function d(a){a.data.mode="html"}CKEDITOR.plugins.add("pastefromword",{init:function(a){var b=0,c=function(g){g&&g.removeListener();a.removeListener("beforePaste",d);b&&setTimeout(function(){b=0},0)};a.addCommand("pastefromword",{canUndo:!1,exec:function(){b=1;a.on("beforePaste",d);!1===a.execCommand("paste","html")&&(a.on("dialogShow",function(a){a.removeListener();a.data.on("cancel",c)}),a.on("dialogHide",
function(a){a.data.removeListener("cancel",c)}));a.on("afterPaste",c)}});a.ui.addButton("PasteFromWord",{label:a.lang.pastefromword.toolbar,command:"pastefromword"});a.on("pasteState",function(b){a.getCommand("pastefromword").setState(b.data)});a.on("paste",function(c){var e=c.data,f;if((f=e.html)&&(b||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(f))){var d=this.loadFilterRules(function(){if(d)a.fire("paste",e);else if(!a.config.pasteFromWordPromptCleanup||b||confirm(a.lang.pastefromword.confirmCleanup))e.html=
CKEDITOR.cleanWord(f,a)});d&&c.cancel()}},this)},loadFilterRules:function(a){var b=CKEDITOR.cleanWord;if(b)a();else{var c=CKEDITOR.getUrl(CKEDITOR.config.pasteFromWordCleanupFile||this.path+"filter/default.js");CKEDITOR.scriptLoader.load(c,a,null,!0)}return!b},requires:["clipboard"]})})()});