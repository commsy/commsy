//>>built
define("ckeditor/_source/plugins/domiterator/plugin",["dijit","dojo","dojox"],function(){CKEDITOR.plugins.add("domiterator");(function(){function k(e){if(!(1>arguments.length))this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={})}function m(e,c,a){for(e=e.getNextSourceNode(c,null,a);!l(e);)e=e.getNextSourceNode(c,null,a);return e}var p=/^[\r\n\t ]+$/,l=CKEDITOR.dom.walker.bookmark(!1,!0),q=CKEDITOR.dom.walker.whitespaces(!0),r=function(e){return l(e)&&q(e)};
k.prototype={getNextParagraph:function(e){var c,a,g,d,n,j;if(!this._.started){a=this.range.clone();a.shrink(CKEDITOR.NODE_ELEMENT,!0);d=a.endContainer.hasAscendant("pre",!0)||a.startContainer.hasAscendant("pre",!0);a.enlarge(this.forceBrBreak&&!d||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS);if(!a.collapsed){d=new CKEDITOR.dom.walker(a.clone());var b=CKEDITOR.dom.walker.bookmark(!0,!0);d.evaluator=b;this._.nextNode=d.next();d=new CKEDITOR.dom.walker(a.clone());
d.evaluator=b;d=d.previous();this._.lastNode=d.getNextSourceNode(!0);if(this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&(b=new CKEDITOR.dom.range(a.document),b.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),b.checkEndOfBlock()))b=new CKEDITOR.dom.elementPath(b.endContainer),this._.lastNode=(b.block||b.blockLimit).getNextSourceNode(!0);if(!this._.lastNode)this._.lastNode=this._.docEndMarker=
a.document.createText(""),this._.lastNode.insertAfter(d);a=null}this._.started=1}b=this._.nextNode;d=this._.lastNode;for(this._.nextNode=null;b;){var i=0,k=b.hasAscendant("pre"),f=b.type!=CKEDITOR.NODE_ELEMENT,o=0;if(f)b.type==CKEDITOR.NODE_TEXT&&p.test(b.getText())&&(f=0);else{var h=b.getName();if(b.isBlockBoundary(this.forceBrBreak&&!k&&{br:1})){if("br"==h)f=1;else if(!a&&!b.getChildCount()&&"hr"!=h){c=b;g=b.equals(d);break}if(a&&(a.setEndAt(b,CKEDITOR.POSITION_BEFORE_START),"br"!=h))this._.nextNode=
b;i=1}else{if(b.getFirst()){a||(a=new CKEDITOR.dom.range(this.range.document),a.setStartAt(b,CKEDITOR.POSITION_BEFORE_START));b=b.getFirst();continue}f=1}}f&&!a&&(a=new CKEDITOR.dom.range(this.range.document),a.setStartAt(b,CKEDITOR.POSITION_BEFORE_START));g=(!i||f)&&b.equals(d);if(a&&!i)for(;!b.getNext(r)&&!g;){h=b.getParent();if(h.isBlockBoundary(this.forceBrBreak&&!k&&{br:1})){i=1;f=0;g||h.equals(d);a.setEndAt(h,CKEDITOR.POSITION_BEFORE_END);break}b=h;f=1;g=b.equals(d);o=1}f&&a.setEndAt(b,CKEDITOR.POSITION_AFTER_END);
b=m(b,o,d);if((g=!b)||i&&a)break}if(!c){if(!a)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;c=new CKEDITOR.dom.elementPath(a.startContainer);b=c.blockLimit;i={div:1,th:1,td:1};c=c.block;if(!c&&!this.enforceRealBlocks&&i[b.getName()]&&a.checkStartOfBlock()&&a.checkEndOfBlock())c=b;else if(!c||this.enforceRealBlocks&&"li"==c.getName())c=this.range.document.createElement(e||"p"),a.extractContents().appendTo(c),c.trim(),a.insertNode(c),n=j=!0;else if("li"!=c.getName()){if(!a.checkStartOfBlock()||
!a.checkEndOfBlock())c=c.clone(!1),a.extractContents().appendTo(c),c.trim(),j=a.splitBlock(),n=!j.wasStartOfBlock,j=!j.wasEndOfBlock,a.insertNode(c)}else if(!g)this._.nextNode=c.equals(d)?null:m(a.getBoundaryNodes().endNode,1,d)}n&&(a=c.getPrevious())&&a.type==CKEDITOR.NODE_ELEMENT&&("br"==a.getName()?a.remove():a.getLast()&&"br"==a.getLast().$.nodeName.toLowerCase()&&a.getLast().remove());j&&(a=c.getLast())&&a.type==CKEDITOR.NODE_ELEMENT&&"br"==a.getName()&&(CKEDITOR.env.ie||a.getPrevious(l)||a.getNext(l))&&
a.remove();if(!this._.nextNode)this._.nextNode=g||c.equals(d)||!d?null:m(c,1,d);return c}};CKEDITOR.dom.range.prototype.createIterator=function(){return new k(this)}})()});