//>>built
define("ckeditor/_source/plugins/indent/plugin",["dijit","dojo","dojox"],function(){(function(){function p(c){if(c.editor.readOnly)return null;var f=c.editor,a=c.data.path,c=a&&a.contains(m),a=a.block||a.blockLimit;if(c||!this.useIndentClasses&&"indent"==this.name)return this.setState(CKEDITOR.TRISTATE_OFF);if(!a)return this.setState(CKEDITOR.TRISTATE_DISABLED);if(this.useIndentClasses)return c=a.$.className.match(this.classNameRegex),a=0,c&&(c=c[1],a=this.indentClassMap[c]),"outdent"==this.name&&
!a||"indent"==this.name&&a==f.config.indentClasses.length?this.setState(CKEDITOR.TRISTATE_DISABLED):this.setState(CKEDITOR.TRISTATE_OFF);f=parseInt(a.getStyle(t(a)),10);isNaN(f)&&(f=0);return 0>=f?this.setState(CKEDITOR.TRISTATE_DISABLED):this.setState(CKEDITOR.TRISTATE_OFF)}function q(c,f){this.name=f;if(this.useIndentClasses=c.config.indentClasses&&0<c.config.indentClasses.length){this.classNameRegex=RegExp("(?:^|\\s+)("+c.config.indentClasses.join("|")+")(?=$|\\s)");this.indentClassMap={};for(var a=
0;a<c.config.indentClasses.length;a++)this.indentClassMap[c.config.indentClasses[a]]=a+1}this.startDisabled="outdent"==f}function t(c,f){return"ltr"==(f||c.getComputedStyle("direction"))?"margin-left":"margin-right"}function r(c){return c.type==CKEDITOR.NODE_ELEMENT&&c.is("li")}var m={ol:1,ul:1},v=CKEDITOR.dom.walker.whitespaces(!0),w=CKEDITOR.dom.walker.bookmark(!1,!0);q.prototype={exec:function(c){function f(l){for(var h=e.startContainer,b=e.endContainer;h&&!h.getParent().equals(l);)h=h.getParent();
for(;b&&!b.getParent().equals(l);)b=b.getParent();if(h&&b){for(var d=h,h=[],a=!1;!a;)d.equals(b)&&(a=!0),h.push(d),d=d.getNext();if(!(1>h.length)){d=l.getParents(!0);for(b=0;b<d.length;b++)if(d[b].getName&&m[d[b].getName()]){l=d[b];break}for(var d="indent"==n.name?1:-1,b=h[0],h=h[h.length-1],a=CKEDITOR.plugins.list.listToArray(l,s),g=a[h.getCustomData("listarray_index")].indent,b=b.getCustomData("listarray_index");b<=h.getCustomData("listarray_index");b++)if(a[b].indent+=d,0<d){var j=a[b].parent;
a[b].parent=new CKEDITOR.dom.element(j.getName(),j.getDocument())}for(b=h.getCustomData("listarray_index")+1;b<a.length&&a[b].indent>g;b++)a[b].indent+=d;h=CKEDITOR.plugins.list.arrayToList(a,s,null,c.config.enterMode,l.getDirection());if("outdent"==n.name){var k;if((k=l.getParent())&&k.is("li"))for(var d=h.listNode.getChildren(),f=[],i,b=d.count()-1;0<=b;b--)(i=d.getItem(b))&&i.is&&i.is("li")&&f.push(i)}h&&h.listNode.replace(l);if(f&&f.length)for(b=0;b<f.length;b++){for(i=l=f[b];(i=i.getNext())&&
i.is&&i.getName()in m;)CKEDITOR.env.ie&&!l.getFirst(function(b){return v(b)&&w(b)})&&l.append(e.document.createText("\u00a0")),l.append(i);l.insertAfter(k)}}}}function a(){var a=e.createIterator(),h=c.config.enterMode;a.enforceRealBlocks=!0;a.enlargeBr=h!=CKEDITOR.ENTER_BR;for(var b;b=a.getNextParagraph(h==CKEDITOR.ENTER_P?"p":"div");)u(b)}function u(a,e){if(a.getCustomData("indent_processed"))return!1;if(n.useIndentClasses){var b=a.$.className.match(n.classNameRegex),d=0;b&&(b=b[1],d=n.indentClassMap[b]);
"outdent"==n.name?d--:d++;if(0>d)return!1;d=Math.min(d,c.config.indentClasses.length);d=Math.max(d,0);a.$.className=CKEDITOR.tools.ltrim(a.$.className.replace(n.classNameRegex,""));0<d&&a.addClass(c.config.indentClasses[d-1])}else{b=t(a,e);d=parseInt(a.getStyle(b),10);isNaN(d)&&(d=0);var g=c.config.indentOffset||40,d=d+("indent"==n.name?1:-1)*g;if(0>d)return!1;d=Math.max(d,0);d=Math.ceil(d/g)*g;a.setStyle(b,d?d+(c.config.indentUnit||"px"):"");""===a.getAttribute("style")&&a.removeAttribute("style")}CKEDITOR.dom.element.setMarker(s,
a,"indent_processed",1);return!0}for(var n=this,s={},g=c.getSelection(),i=g.createBookmarks(1),e,o=(g&&g.getRanges(1)).createIterator();e=o.getNextRange();){for(var k=e.getCommonAncestor();k&&!(k.type==CKEDITOR.NODE_ELEMENT&&m[k.getName()]);)k=k.getParent();if(!k){var j=e.getEnclosedNode();j&&j.type==CKEDITOR.NODE_ELEMENT&&j.getName()in m&&(e.setStartAt(j,CKEDITOR.POSITION_AFTER_START),e.setEndAt(j,CKEDITOR.POSITION_BEFORE_END),k=j)}if(k&&e.startContainer.type==CKEDITOR.NODE_ELEMENT&&e.startContainer.getName()in
m)j=new CKEDITOR.dom.walker(e),j.evaluator=r,e.startContainer=j.next();if(k&&e.endContainer.type==CKEDITOR.NODE_ELEMENT&&e.endContainer.getName()in m)j=new CKEDITOR.dom.walker(e),j.evaluator=r,e.endContainer=j.previous();if(k){var j=k.getFirst(r),q=!!j.getNext(r),p=e.startContainer;(!j.equals(p)&&!j.contains(p)||!("indent"==n.name||n.useIndentClasses||parseInt(k.getStyle(t(k)),10))||!u(k,!q&&j.getDirection()))&&f(k)}else a()}CKEDITOR.dom.element.clearAllMarkers(s);c.forceNextSelectionCheck();g.selectBookmarks(i)}};
CKEDITOR.plugins.add("indent",{init:function(c){var f=c.addCommand("indent",new q(c,"indent")),a=c.addCommand("outdent",new q(c,"outdent"));c.ui.addButton("Indent",{label:c.lang.indent,command:"indent"});c.ui.addButton("Outdent",{label:c.lang.outdent,command:"outdent"});c.on("selectionChange",CKEDITOR.tools.bind(p,f));c.on("selectionChange",CKEDITOR.tools.bind(p,a));(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat)&&c.addCss("ul,ol{\tmargin-left: 0px;\tpadding-left: 40px;}");c.on("dirChanged",function(a){var f=
new CKEDITOR.dom.range(c.document);f.setStartBefore(a.data.node);f.setEndAfter(a.data.node);for(var m=new CKEDITOR.dom.walker(f),g;g=m.next();)if(g.type==CKEDITOR.NODE_ELEMENT)if(!g.equals(a.data.node)&&g.getDirection())f.setStartAfter(g),m=new CKEDITOR.dom.walker(f);else{var i=c.config.indentClasses;if(i)for(var e="ltr"==a.data.dir?["_rtl",""]:["","_rtl"],o=0;o<i.length;o++)g.hasClass(i[o]+e[0])&&(g.removeClass(i[o]+e[0]),g.addClass(i[o]+e[1]));i=g.getStyle("margin-right");e=g.getStyle("margin-left");
i?g.setStyle("margin-left",i):g.removeStyle("margin-left");e?g.setStyle("margin-right",e):g.removeStyle("margin-right")}})},requires:["domiterator","list"]})})()});