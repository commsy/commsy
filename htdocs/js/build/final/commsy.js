//>>built
require({cache:{"commsy/tree":function(){define("commsy/tree","dojo/_base/declare,dojo/dom-construct,dojo/io-query,commsy/base,dojo/on,dojo/_base/lang,cbtree/Tree,dojo/query,cbtree/models/ForestStoreModel,dojo/data/ItemFileWriteStore,cbtree/CheckBox,cbtree/models/StoreModel-API".split(","),function(h,l,d,f,c,e,i,b,k,a,g){return h(f,{followUrl:!0,autoExpandLevel:2,checkboxes:!1,expanded:!1,item_id:null,tree:null,store:null,model:null,room_id:null,constructor:function(a){a=a||{};h.safeMixin(this,a)},
setupTree:function(a,g,k){k?this.initDo(a,g):(k=b("a[href='tags_tab']")[0])&&c(k,"click",e.hitch(this,function(){this.initDo(a,g)}))},initDo:function(b,g){g=g||function(){};this.AJAXRequest("tagtree","getTreeData",{item_id:this.item_id,room_id:this.room_id},e.hitch(this,function(c){c=this.sanitizeResults(c);this.store=new a({data:{identifier:"item_id",label:"title",items:c}});this.model=this.createModel();this.tree=this.createTree();l.empty(b);this.tree.placeAt(b);!0===this.expanded&&this.autoExpandToLevel(this.tree,
0,!0);g(this)}))},createModel:function(){return new k({store:this.store,checkedAttr:"match",checkedStrict:!1})},createTree:function(){return new i({model:this.model,showRoot:!1,persist:!1,checkBoxes:this.checkboxes,onClick:e.hitch(this,function(a,b,g){this.followUrl?("home"==this.uri_object.mod&&this.replaceOrSetURIParam("mod","search"),location.href="commsy.php?"+d.objectToQuery(this.replaceOrSetURIParam("seltag",a.item_id))):"INPUT"!==g.target.nodeName&&(!0===this.model.getChecked(a)?this.model.setChecked(a,
!1):this.model.setChecked(a,!0))}),widget:{type:g,args:{multiState:!0},mixin:function(a){a.value=this.item.item_id[0];a.name="form_data[tags]"}}})},autoExpandToLevel:function(a,b,g){this.expandHelper(a,a.rootNode,0,b,g)},getNumItems:function(a){return this.numHelper(a.rootNode.item)},expandHelper:function(a,b,g,c,k){b=b.getChildren();dojo.forEach(b,e.hitch(this,function(b){k||g<c?a._expandNode(b):a._collapseNode(b);this.expandHelper(a,b,g+1,c,k)}))},numHelper:function(a){var b=0;dojo.forEach(a.children,
e.hitch(this,function(a){b+=this.numHelper(a)}));return b+1},iterateCallback:function(a,b){b(a);this.tree.model.getChildren(a,e.hitch(this,function(a){dojo.forEach(a,e.hitch(this,function(a){this.iterateCallback(a,b)}))}))},sanitizeResults:function(a){dojo.forEach(a,e.hitch(this,function(b,g){if(b.children)0===b.children.length?delete b.children:b.children=this.sanitizeResults(b.children);a[g]=b}));return a},buildPath:function(a,b){b=b||[];b.push(a);var g=this.store.getParents(this.model.fetchItem({item_id:a}))[0];
if(g)return this.buildPath(this.store.getIdentity(g),b);b.push(this.tree.rootNode.item.id);return b.reverse()}})})},"commsy/popups/ToggleClipboard":function(){define("commsy/popups/ToggleClipboard","dojo/_base/declare,commsy/TogglePopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b){return h(l,{constructor:function(b,a){this.popup_button_node=b;this.contentNode=a;this.module="clipboard";this.features=[];this.registerPopupClick()},
onTogglePopup:function(){!0===this.is_open?(f.add(this.popup_button_node,"tm_clipboard_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_clipboard_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){require(["commsy/Clipboard"],b.hitch(this,function(b){(new b).init(this.cid,this.from_php.template.tpl_path)}))},onPopupSubmit:function(){},onPopupSubmitSuccess:function(){}})})},"commsy/ClickPopupHandler":function(){define("commsy/ClickPopupHandler","dojo/_base/declare,commsy/PopupHandler,dojo/on,dojo/_base/lang,dojo/query,dojo/dom-class,dijit/Tooltip,dojo/dom-attr,dojo/dom-construct,dojo/dom-style".split(","),
function(h,l,d,f,c,e,i,b,k){return h(l,{triggerNode:null,item_id:null,ref_iid:null,ticks:0,ajaxHTMLSource:"rubric_popup",constructor:function(){this.fct="rubric_popup";this.initData={}},setInitData:function(a){this.initData=a},registerPopupClick:function(){d(this.triggerNode,"click",f.hitch(this,function(a){this.open();a.preventDefault()}))},open:function(){if(!1===this.is_open){this.is_open=!0;this.setupLoading();var a={module:this.module,iid:this.item_id,ref_iid:this.ref_iid,editType:this.editType,
version_id:this.version_id,contextId:this.contextId,date_new:this.date_new};h.safeMixin(a,this.initData);this.AJAXRequest(this.ajaxHTMLSource,"getHTML",a,f.hitch(this,function(a){k.place(a,c("body")[0],"first");this.contentNode=c("div#popup_wrapper")[0];this.scrollToNodeAnimated(this.contentNode);this.setupTabs();this.setupFeatures();this.setupSpecific();this.setupAutoSave();this.onCreate();d(c("a#popup_close, input#popup_button_abort",this.contentNode),"click",f.hitch(this,function(a){this.close();
a.preventDefault()}));d(c("input.submit",this.contentNode),"click",f.hitch(this,function(a){this.setupLoading();this.onPopupSubmit(this.getAttrAsObject(a.target,"data-custom"));a.preventDefault()}));this.is_open=!this.is_open;this.destroyLoading()}))}},setupAutoSave:function(){var a=this.from_php.autosave.mode,g=this.from_php.autosave.limit;0<a&&require(["dojox/timing","dojox/string/sprintf"],f.hitch(this,function(){var j=new dojox.timing.Timer(1E3);if(2==a)var e=k.create("div",{className:"autosave",
innerHTML:"00:00:00"},c("div#crt_actions_area",this.contentNode)[0],"first");j.onTick=f.hitch(this,function(){this.ticks++;if(this.ticks===g)this.onPopupSubmit(this.getAttrAsObject(c("input.submit",this.contentNode)[0],"data-custom"));if(2==a){var j=g-this.ticks,k=Math.floor(j/3600),j=j-3600*k,d=Math.floor(j/60),j=dojox.string.sprintf("%02u:%02u:%02u",k,d,j-60*d);b.set(e,"innerHTML",j)}});j.start()}))},close:function(){this.inherited(arguments);this.featureHandles.editor&&dojo.forEach(this.featureHandles.editor,
function(a){a.destroy()});this.featureHandles.calendar&&dojo.forEach(this.featureHandles.calendar,function(a){a.destroy()});k.destroy(this.contentNode);this.destroyLoading();this.is_open=!1}})})},"commsy/popups/ToggleWidgets":function(){define("commsy/popups/ToggleWidgets","dojo/_base/declare,commsy/WidgetPopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b){return h(l,{constructor:function(){this.module="widgets";this.features=
[]},onTogglePopup:function(){!0===this.is_open?(f.add(this.popup_button_node,"tm_widgets_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_widgets_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){this.loadWidgetsManual(["widgets/WidgetsNewEntries","widgets/WidgetsReleasedEntries","widgets/WidgetsRssTicker"]).then(b.hitch(this,function(c){dojo.forEach(c,b.hitch(this,function(a,b){2>b?a[1].handle.placeAt(d("div.widgetAreaLeft",this.contentNode)[0]):
a[1].handle.placeAt(d("div.widgetAreaRight",this.contentNode)[0])}))}))}})})},"commsy/Assessment":function(){define("commsy/Assessment","dojo/_base/declare,commsy/base,dijit/TooltipDialog,dojo/dom-attr,dojo/query,dojo/on,dojo/dom-class,dojo/dom-style,dojo/_base/lang,dojo/NodeList-traverse".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{display:!1,anim:null,constructor:function(a){a=a||{};h.safeMixin(this,a)},setup:function(a){if(a){if(i.contains(a,"rateable")){var b=c("img",a),j=[];dojo.forEach(b,
k.hitch(this,function(b,g){j[g]=f.get(b,"src");e(b,"mouseover",k.hitch(this,function(){f.set(b,"src",this.from_php.template.tpl_path+"img/star_selected.gif");dojo.forEach((new dojo.NodeList(b)).prevAll(),k.hitch(this,function(a){f.set(a,"src",this.from_php.template.tpl_path+"img/star_selected.gif")}))}));e(b,"click",k.hitch(this,function(){this.AJAXRequest("assessment","vote",{item_id:this.uri_object.iid,vote:g+1},function(){location.reload()})}));e(b,"mouseout",k.hitch(this,function(){dojo.forEach((new dojo.NodeList(a)).children(),
function(a,b){f.set(a,"src",j[b])})}))}))}(b=c("a#assessment_delete_own")[0])&&e(b,"click",k.hitch(this,function(){this.AJAXRequest("assessment","deleteOwn",{item_id:this.uri_object.iid},function(){location.reload()})}))}}})})},"commsy/popups/TogglePortfolio":function(){define("commsy/popups/TogglePortfolio","dojo/_base/declare,commsy/WidgetPopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/parser,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,
{constructor:function(){this.module="portfolio";this.features=[]},onTogglePopup:function(){!0===this.is_open?(f.add(this.popup_button_node,"tm_portfolio_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_portfolio_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){this.loadWidgetsManual(["widgets/Portfolio"]).then(k.hitch(this,function(a){dojo.forEach(a,k.hitch(this,function(a){a[1].handle.placeAt(d("div.portfolioArea",this.contentNode)[0]);dojo.parser.parse(this.contentNode);
a[1].handle.afterParse()}))}))}})})},"cbtree/models/StoreModel-API":function(){define("cbtree/models/StoreModel-API",["dojo/_base/array","dojo/_base/lang","dojo/has","./TreeStoreModel"],function(h,l,d,f){d.add("cbtree-storeModel-API",!0);l.extend(f,{_checkOrUncheck:function(c,e,d,b,k){var a=0,g=0;this.fetchItemsWithChecked(c,function(j){h.forEach(j,function(b){this.store.getValue(b,this.checkedAttr)!=e&&(this._ItemCheckedSetter(b,e),g+=1);a+=1},this);d&&d.call(b?b:this,a,g)},this,k)},_ItemCheckedGetter:function(c){return this.getChecked(c)},
_ItemCheckedSetter:function(c,e){this.setChecked(c,e)},_ItemIdentityGetter:function(c){if(this.store.isItem(c))return this.store.getIdentity(c);if(c===this.root)return this.root.id;throw new TypeError(this.moduleName+"::getIdentity(): invalid item specified.");},_ItemIdentitySetter:function(){throw Error(this.moduleName+"::setItemAttr(): Identity attribute cannot be changed");},_ItemLabelGetter:function(c){return c!==this.root?this.labelAttr?this.store.getValue(c,this.labelAttr):this.store.getLabel(c):
this.root.label},_ItemLabelSetter:function(c,e){var d=this.get("labelAttr");if(d){if(d!=this.store.getIdentifierAttr())return this.store.setValue(c,d,e);throw Error(this.moduleName+"::setItemAttr(): Label attribute {"+d+"} cannot be changed");}},_ItemParentsGetter:function(c){return this.getParents(c)},getItemAttr:function(c,e){var d=e==this.checkedAttr?"checked":e;if(this.isItem(c)||c===this.root){var b=this._getFuncNames("Item",d);return l.isFunction(this[b.get])?this[b.get](c):c===this.root&&this.hasFakeRoot?
this.root[d]:this.store.getValue(c,d)}throw Error(this.moduleName+"::getItemAttr(): argument is not a valid store item.");},setItemAttr:function(c,e,d){if(this._writeEnabled){e=e==this.checkedAttr?"checked":e;if(this.isItem(c)){var b=this._getFuncNames("Item",e);return l.isFunction(this[b.set])?this[b.set](c,d):this.store.setValue(c,e,d)}throw Error(this.moduleName+"::setItemAttr(): argument is not a valid store item.");}throw Error(this.moduleName+"::setItemAttr(): store is not write enabled.");
},fetchItem:function(c,e){var d=this.store.getIdentifierAttr(),b=this._anyToQuery(c,e);if(b)return b[d]!=this.root.id?this.store.itemExist(b):this.root},fetchItemsWithChecked:function(c,e,d,b){var c=this._anyToQuery(c,null),k=[],b=void 0!==b?b:!0,d=d||this;if(l.isObject(c))this.store.fetch({query:c,queryOptions:{deep:!0,storeOnly:b},onItem:function(a){this.store.hasAttribute(a,this.checkedAttr)?k.push(a):this.checkedAll&&(this.setChecked(a,this.checkedState),k.push(a))},onComplete:function(){e&&e.call(d,
k)},onError:this.onError,scope:this});else throw Error(this.moduleName+"::fetchItemsWithChecked(): query must be of type object.");},isRootItem:function(c){return c!==this.root?this.store.isRootItem(c):!0},addReference:function(c,e,d){this.store.addReference(c,e,d||this.childrenAttrs[0])&&this._updateCheckedParent(c)},attachToRoot:function(c){c!==this.root&&this.store.attachToRoot(c)},check:function(c,e,d,b){this.checkedStrict&&(b=!0);this._checkOrUncheck(c,!0,e,d,b)},detachFromRoot:function(c){c!==
this.root&&this.store.detachFromRoot(c)},newReferenceItem:function(c,e,d){(c=this.newItem(c,e,d))&&this.store.attachToRoot(c);return c},removeReference:function(c,e,d){this.store.removeReference(c,e,d||this.childrenAttrs[0])&&this.getChildren(e,l.hitch(this,function(b){b.length&&this._updateCheckedParent(b[0])}))},uncheck:function(c,e,d,b){this.checkedStrict&&(b=!0);this._checkOrUncheck(c,!1,e,d,b)},_anyToQuery:function(c,e){var d=this.store.getIdentifierAttr();if(d){var b=e?e:d,k={};if(l.isString(c))return k[d]=
c,k;if(l.isObject(c))return l.mixin(k,c),c[b]&&(k[d]=c[b]),k}return null},_getFuncNames:function(c,e){if(l.isString(e)){var d=e.replace(/^[a-z]|-[a-zA-Z]/g,function(b){return b.charAt(b.length-1).toUpperCase()});return{set:"_"+c+d+"Setter",get:"_"+c+d+"Getter"}}throw Error(this.moduleName+"::_getFuncNames(): get"+c+"/set"+c+" attribute name must be of type string.");}})})},"dijit/tree/TreeStoreModel":function(){define("dijit/tree/TreeStoreModel",["dojo/_base/array","dojo/aspect","dojo/_base/declare",
"dojo/_base/lang"],function(h,l,d,f){return d("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(c){f.mixin(this,c);this.connects=[];c=this.store;if(!c.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");if(c.getFeatures()["dojo.data.api.Notification"])this.connects=this.connects.concat([l.after(c,"onNew",
f.hitch(this,"onNewItem"),!0),l.after(c,"onDelete",f.hitch(this,"onDeleteItem"),!0),l.after(c,"onSet",f.hitch(this,"onSetItem"),!0)])},destroy:function(){for(var c;c=this.connects.pop();)c.remove()},getRoot:function(c,e){this.root?c(this.root):this.store.fetch({query:this.query,onComplete:f.hitch(this,function(e){if(1!=e.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+e.length+" items, but must return exactly one");this.root=e[0];c(this.root)}),onError:e})},mayHaveChildren:function(c){return h.some(this.childrenAttrs,
function(e){return this.store.hasAttribute(c,e)},this)},getChildren:function(c,e,d){var b=this.store;if(b.isItemLoaded(c)){for(var k=[],a=0;a<this.childrenAttrs.length;a++)var g=b.getValues(c,this.childrenAttrs[a]),k=k.concat(g);var j=0;this.deferItemLoadingUntilExpand||h.forEach(k,function(a){b.isItemLoaded(a)||j++});0==j?e(k):h.forEach(k,function(a,g){b.isItemLoaded(a)||b.loadItem({item:a,onItem:function(a){k[g]=a;0==--j&&e(k)},onError:d})})}else{var p=f.hitch(this,arguments.callee);b.loadItem({item:c,
onItem:function(a){p(a,e,d)},onError:d})}},isItem:function(c){return this.store.isItem(c)},fetchItemByIdentity:function(c){this.store.fetchItemByIdentity(c)},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return this.labelAttr?this.store.getValue(c,this.labelAttr):this.store.getLabel(c)},newItem:function(c,e,d){var b={parent:e,attribute:this.childrenAttrs[0]},k;this.newItemIdAttr&&c[this.newItemIdAttr]?this.fetchItemByIdentity({identity:c[this.newItemIdAttr],scope:this,
onItem:function(a){a?this.pasteItem(a,null,e,!0,d):(k=this.store.newItem(c,b))&&void 0!=d&&this.pasteItem(k,e,e,!1,d)}}):(k=this.store.newItem(c,b))&&void 0!=d&&this.pasteItem(k,e,e,!1,d)},pasteItem:function(c,d,f,b,k){var a=this.store,g=this.childrenAttrs[0];d&&h.forEach(this.childrenAttrs,function(j){if(a.containsValue(d,j,c)){if(!b){var k=h.filter(a.getValues(d,j),function(a){return a!=c});a.setValues(d,j,k)}g=j}});if(f)if("number"==typeof k){var j=a.getValues(f,g).slice();j.splice(k,0,c);a.setValues(f,
g,j)}else a.setValues(f,g,a.getValues(f,g).concat(c))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(c,d){d&&this.getChildren(d.item,f.hitch(this,function(c){this.onChildrenChange(d.item,c)}))},onDeleteItem:function(c){this.onDelete(c)},onSetItem:function(c,d){if(-1!=h.indexOf(this.childrenAttrs,d))this.getChildren(c,f.hitch(this,function(d){this.onChildrenChange(c,d)}));else this.onChange(c)}})})},"dojo/dnd/Selector":function(){define("dojo/dnd/Selector",
"../_base/array,../_base/declare,../_base/event,../_base/kernel,../_base/lang,../dom,../dom-construct,../mouse,../_base/NodeList,../on,../touch,./common,./Container".split(","),function(h,l,d,f,c,e,i,b,k,a,g,j,p){var r=l("dojo.dnd.Selector",p,{constructor:function(b,j){j||(j={});this.singular=j.singular;this.autoSync=j.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(a(this.node,g.press,c.hitch(this,"onMouseDown")),a(this.node,g.release,c.hitch(this,"onMouseUp")))},
singular:!1,getSelectedNodes:function(){var a=new k,b=j._empty,g;for(g in this.selection)g in b||a.push(e.byId(g));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(e.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=j._empty,b;for(b in this.selection)if(!(b in a)){var g=e.byId(b);this.delItem(b);i.destroy(g)}this.anchor=null;this.selection=
{};return this},forInSelectedItems:function(a,b){var b=b||f.global,g=this.selection,c=j._empty,k;for(k in g)k in c||a.call(b,this.getItem(k),k,this)},sync:function(){r.superclass.sync.call(this);if(this.anchor&&!this.getItem(this.anchor.id))this.anchor=null;var a=[],b=j._empty,g;for(g in this.selection)g in b||this.getItem(g)||a.push(g);h.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,g,j){var c=this._normalizedCreator;this._normalizedCreator=function(b,
g){var j=c.call(this,b,g);a?(this.anchor?this.anchor!=j.node&&(this._removeItemClass(j.node,"Anchor"),this._addItemClass(j.node,"Selected")):(this.anchor=j.node,this._removeItemClass(j.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[j.node.id]=1):(this._removeItemClass(j.node,"Selected"),this._removeItemClass(j.node,"Anchor"));return j};r.superclass.insertNodes.call(this,b,g,j);this._normalizedCreator=c;return this},destroy:function(){r.superclass.destroy.call(this);this.selection=
this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!j.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,b.isLeft(a)&&d.stop(a);else{if(!this.singular&&a.shiftKey){j.getCopyKeyState(a)||this._removeSelection();var g=this.getAllNodes();if(g.length){if(!this.anchor)this.anchor=g[0],this._addItemClass(this.anchor,"Anchor");this.selection[this.anchor.id]=1;if(this.anchor!=this.current){for(var c=0,k;c<g.length&&
!(k=g[c],k==this.anchor||k==this.current);++c);for(++c;c<g.length;++c){k=g[c];if(k==this.anchor||k==this.current)break;this._addItemClass(k,"Selected");this.selection[k.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}}else if(this.singular)this.anchor==this.current?j.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1);else if(j.getCopyKeyState(a))this.anchor==
this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);else if(!(this.current.id in this.selection))this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,
"Anchor"),this.selection[this.current.id]=1;d.stop(a)}},onMouseUp:function(){if(this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current))this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=a(this.node,g.move,c.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},
_removeSelection:function(){var a=j._empty,b;for(b in this.selection)if(!(b in a)){var g=e.byId(b);g&&this._removeItemClass(g,"Selected")}this.selection={};return this},_removeAnchor:function(){if(this.anchor)this._removeItemClass(this.anchor,"Anchor"),this.anchor=null;return this}});return r})},"cbtree/models/TreeStoreModel":function(){define("cbtree/models/TreeStoreModel","dojo/_base/array,dojo/_base/declare,dojo/_base/lang,dojo/aspect,dojo/has,dojo/json,dojo/Stateful,./ItemWriteStoreEX".split(","),
function(h,l,d,f,c,e,i){return l([i],{checkedAll:!0,checkedState:!1,checkedRoot:!1,checkedStrict:!0,checkedAttr:"checked",childrenAttrs:["children"],deferItemLoadingUntilExpand:!1,enabledAttr:"",excludeChildrenAttrs:null,iconAttr:"",labelAttr:"",multiState:!0,newItemIdAttr:"id",normalize:!0,query:null,store:null,moduleName:"cbTree/models/TreeStoreModel",hasFakeRoot:!1,root:null,_checkedChildrenAttrs:null,_queryAttrs:[],_validateStore:!0,_validating:0,constructor:function(b){l.safeMixin(this,b);this.connects=
[];b=this.store;if(!b.getFeatures()["dojo.data.api.Identity"])throw Error(this.moduleName+"constructor(): store must support dojo.data.Identity");c.add("tree-model-getChecked",1);b.getFeatures()["dojo.data.api.Write"]?(c.add("tree-model-setChecked",1),this._writeEnabled=!0):(console.warn(this.moduleName+"::constructor(): store is not write enabled."),this._writeEnabled=!1);if(b.getFeatures()["dojo.data.api.Notification"])this.connects=this.connects.concat([f.after(b,"onLoad",d.hitch(this,"onStoreLoaded"),
!0),f.after(b,"onNew",d.hitch(this,"onNewItem"),!0),f.after(b,"onDelete",d.hitch(this,"onDeleteItem"),!0),f.after(b,"onSet",d.hitch(this,"onSetItem"),!0),f.after(b,"onRoot",d.hitch(this,"onRootChange"),!0)]);this._checkedChildrenAttrs=this._diffArrays(this.childrenAttrs,this.excludeChildrenAttrs);if(this.query)for(var k in this.query)this._queryAttrs.push(k)},destroy:function(){for(var b;b=this.connects.pop();)b.remove();this.store=null},_checkedStrictSetter:function(b){b=b?!0:!1;if(this.checkedStrict!==
b)(this.checkedStrict=b)&&this.getRoot(d.hitch(this,function(b){this.getChildren(b,d.hitch(this,function(a){this._validateChildren(b,a)}))}));return this.checkedStrict},_enabledAttrSetter:function(b){if(d.isString(b)){if(this.enabledAttr!==b)throw Error(this.moduleName+"::set(): enabledAttr property is read-only.");}else throw Error(this.moduleName+"::set(): enabledAttr value must be a string");return this.enabledAttr},_labelAttrGetter:function(){return this.getLabelAttr()},_labelAttrSetter:function(b){return this.setLabelAttr(b)},
_querySetter:function(b){if(d.isObject(b)){if(this.query!==b)this.query=b,this._requeryTop();return this.query}throw Error(this.moduleName+"::set(): query argument must be of type object");},getChildren:function(b,c,a,g){var j=this.store,e=this;if(j.isItemLoaded(b)){var f=[],m,i;if(g){var q=d.isArray(g)?g:[g];for(i=0;i<q.length;i++)m=j.getValues(b,q[i]),f=f.concat(m)}else for(i=0;i<this.childrenAttrs.length;i++)m=j.getValues(b,this.childrenAttrs[i]),f=f.concat(m);var v=0;this.deferItemLoadingUntilExpand||
h.forEach(f,function(a){j.isItemLoaded(a)||v++});0==v?c(f):h.forEach(f,function(b,g){j.isItemLoaded(b)||j.loadItem(e._mixinFetch({item:b,onItem:function(a){f[g]=a;0==--v&&c(f)},onError:a}))})}else{var o=d.hitch(this,arguments.callee);j.loadItem(e._mixinFetch({item:b,onItem:function(b){o(b,c,a)},onError:a}))}},getParents:function(b){if(b)return this.store.getParents(b)},getRoot:function(b,c){this.root?b(this.root):this.store.fetch(this._mixinFetch({query:this.query,onComplete:d.hitch(this,function(a){if(1!=
a.length)throw Error(this.moduleName+": query "+e.stringify(this.query)+" returned "+a.length+" items, but must return exactly one item");this.root=a[0];b(this.root)}),onError:c}))},mayHaveChildren:function(b){return h.some(this.childrenAttrs,function(c){return this.store.hasAttribute(b,c)},this)},_getCompositeState:function(b){var c=!1,a=!1,g=!1,j,d;h.some(b,function(b){d=this.getChecked(b);g|="mixed"==d;switch(d){case !0:c=!0;break;case !1:a=!0}return g},this);if(g||c||a)j=(g|=!(c^a))?"mixed":c?
!0:!1;return j},_normalizeState:function(b,c){return"boolean"==typeof c?c:this.multiState&&"mixed"==c?this.normalize&&!this.mayHaveChildren(b)?!0:c:c?!0:!1},_setChecked:function(b,c){var a=!1,g;g=this._normalizeState(b,c);a=g!=c;if(this.store.isItem(b)){var j=this.store.getValue(b,this.checkedAttr);if((void 0!==j||this.checkedAll)&&(j!=g||a))return this.store.setValue(b,this.checkedAttr,g),!0}else if(b===this.root&&this.hasFakeRoot){if(this.checkedRoot&&(this.root[this.checkedAttr]!=g||a))return this.root[this.checkedAttr]=
g,this.onChange(b,this.checkedAttr,g),!0}else throw new TypeError(this.moduleName+"::_setChecked(): invalid item specified.");return!1},_updateCheckedChild:function(b,c){this._setChecked(b,c);this.mayHaveChildren(b)&&this.getChildren(b,d.hitch(this,function(a){h.forEach(a,function(a){this._updateCheckedChild(a,c)},this)}),this.onError,this._checkedChildrenAttrs)},_updateCheckedParent:function(b,c){if(this.checkedStrict&&b){var a=this.getParents(b),g=this.getChecked(b),j;h.forEach(a,function(a){this.isChildOf(a,
b)&&(g!==this.getChecked(a)||c)&&this.getChildren(a,d.hitch(this,function(b){j=this._getCompositeState(b);void 0!==j&&this._setChecked(a,j)}),this.onError,this._checkedChildrenAttrs)},this)}},_validateChildren:function(b,c,a){var g;this._validating+=1;c=d.isArray(c)?c:[c];h.forEach(c,function(b){this.mayHaveChildren(b)?this.getChildren(b,d.hitch(this,function(g){this._validateChildren(b,g,a)}),this.onError,a):(g=this.getChecked(b))&&"boolean"!==typeof g&&(b[this.checkedAttr]=[this._normalizeState(b,
g)])},this);c=this._getCompositeState(c);g=this.getChecked(b);void 0!==g&&void 0!==c&&this._setChecked(b,c);this._validating-=1;this._validating||(this.store.setValidated(!0),this.onDataValidated())},getChecked:function(b){var c;if(!this.excludeChildrenAttrs||!this.isMemberOf(b,this.excludeChildrenAttrs)){if(this.store.isItem(b)){if(c=this.store.getValue(b,this.checkedAttr),void 0===c&&this.checkedAll)return this._setChecked(b,this.checkedState),this.checkedState}else if(b===this.root&&this.hasFakeRoot){if(this.checkedRoot)return this.root[this.checkedAttr]}else throw new TypeError(this.moduleName+
"::getChecked(): invalid item specified.");return c}},getEnabled:function(b){var c=!0;if(this.enabledAttr)if(this.store.isItem(b))c=this.store.getValue(b,this.enabledAttr);else if(b===this.root)c=b[this.enabledAttr];else throw new TypeError(this.moduleName+"::getEnabled(): invalid item specified.");return void 0===c||Boolean(c)},getItemState:function(b){return{checked:this.getChecked(b),enabled:this.getEnabled(b)}},setChecked:function(b,c){this.checkedStrict?this._updateCheckedChild(b,c):this._setChecked(b,
c)},setEnabled:function(b,c){if(this.enabledAttr){if(this.store.isItem(b))return this.store.setValue(b,this.enabledAttr,Boolean(c));if(b===this.root)return this.root[this.enabledAttr]=Boolean(c);throw new TypeError(this.moduleName+"::setEnabled(): invalid item specified.");}},validateData:function(){this.checkedStrict?this.store.isValidated()?(this.hasFakeRoot&&this.getChildren(this.root,d.hitch(this,function(b){this._updateCheckedParent(b[0],!0)}),this.onError,this._checkedChildrenAttrs),this.onDataValidated()):
this.store.loadStore({onComplete:function(){c("tree-model-setChecked")?this._validateStore&&this.getRoot(d.hitch(this,function(b){this.getChildren(b,d.hitch(this,function(c){this._validateChildren(b,c,this._checkedChildrenAttrs)}),this.onError)}),this.onError):console.warn(this.moduleName+"::validateData(): store is not write enabled.")},onError:function(){},scope:this}):this.store.setValidated(!1)},fetchItemByIdentity:function(b){this.store.fetchItemByIdentity(b)},getIcon:function(b){if(this.iconAttr)return this.store.getValue(b,
this.iconAttr)},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){if(this.labelAttr)return this.store.getValue(b,this.labelAttr);this.setLabelAttr(this.getLabelAttr());return this.store.getLabel(b)},isItem:function(b){return this.store.isItem(b)},isTreeRootChild:function(b){if(this.root)return this.isChildOf(this.root,b)},isChildOf:function(b,c){var a;for(a=0;a<this.childrenAttrs.length;a++)if(-1!==h.indexOf(b[this.childrenAttrs[a]],c))return!0;return!1},isMemberOf:function(b,
c){if(this.isItem(b)){var a=this.getParents(b),g=c?d.isArray(c)?c:[c]:[],j=!1,e;h.some(a,function(a){for(e=0;e<g.length;e++)if(-1!=h.indexOf(a[g[e]],b))return j=!0},this)}return j},deleteItem:function(b){return this.store.deleteItem(b)},newItem:function(b,c,a,g){var g={parent:c,attribute:g?g:this.childrenAttrs[0]},j;this._mapIdentifierAttr(b,!1);try{(j=this.store.itemExist(b))?this.pasteItem(j,null,c,!0,a):(j=this.store.newItem(b,g))&&void 0!=a&&this.pasteItem(j,c,c,!1,a)}catch(d){throw Error(this.moduleName+
"::newItem(): "+d);}return j},pasteItem:function(b,c,a,g,j,d){var e=d?d:this.childrenAttrs[0],f=this.store;c&&h.forEach(this.childrenAttrs,function(a){f.containsValue(c,a,b)&&(g||f.removeReference(b,c,a),e=a)},this);a&&f.addReference(b,a,e,j)},getLabelAttr:function(){if(!this.labelAttr){var b=this.store.getLabelAttributes();b&&this.setLabelAttr(b[0])}return this.labelAttr},setLabelAttr:function(b){if(d.isString(b)&&b.length){if(this.labelAttr!==b){var c=this.labelAttr;this.labelAttr=b;this.onLabelChange(c,
b)}return this.labelAttr}},onChange:function(){},onChildrenChange:function(){},onDataValidated:function(){},onDelete:function(){},onLabelChange:function(){},onNewItem:function(b,c){c&&this.getChildren(c.item,d.hitch(this,function(a){this.onChildrenChange(c.item,a)}));this._updateCheckedParent(b,!0)},onDeleteItem:function(b){this.onDelete(b)},onError:function(b){console.error(this,b)},onSetItem:function(b,c,a,g){-1!=h.indexOf(this.childrenAttrs,c)?this.getChildren(b,d.hitch(this,function(a){a[0]?this._updateCheckedParent(a[0],
!0):this._setChecked(b,this.checkedState);this.onChildrenChange(b,a)})):(c==this.checkedAttr&&this._updateCheckedParent(b,!1),this.onChange(b,c,g))},onStoreLoaded:function(){this.getLabelAttr()},onRootChange:function(){},_mapIdentifierAttr:function(b,c){var a=this.store.getIdentifierAttr();if(a&&!b[a]&&this.newItemIdAttr&&b[this.newItemIdAttr])return b[a]=b[this.newItemIdAttr],c&&delete b[this.newItemIdAttr],!0;if(this.checkedAll&&void 0===b[this.checkedAttr])b[this.checkedAttr]=this.checkedState;
return!1},_diffArrays:function(b,c){var a=c?d.isArray(c)?c:[c]:[],g=b.slice(0),j,e;if(g.length&&a.length)for(e=0;e<a.length;e++)j=h.indexOf(g,a[e]),-1!=j&&g.splice(j,1);return g},_mixinFetch:function(b){return b}})})},"dijit/tree/ForestStoreModel":function(){define("dijit/tree/ForestStoreModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(h,l,d,f,c){return l("dijit.tree.ForestStoreModel",c,{rootId:"$root$",rootLabel:"ROOT",query:null,
constructor:function(c){this.root={store:this,root:!0,id:c.rootId,label:c.rootLabel,children:c.rootChildren}},mayHaveChildren:function(c){return c===this.root||this.inherited(arguments)},getChildren:function(c,d,b){c===this.root?this.root.children?d(this.root.children):this.store.fetch({query:this.query,onComplete:f.hitch(this,function(b){this.root.children=b;d(b)}),onError:b}):this.inherited(arguments)},isItem:function(c){return c===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(c){if(c.identity==
this.root.id){var f=c.scope||d.global;c.onItem&&c.onItem.call(f,this.root)}else this.inherited(arguments)},getIdentity:function(c){return c===this.root?this.root.id:this.inherited(arguments)},getLabel:function(c){return c===this.root?this.root.label:this.inherited(arguments)},newItem:function(c,d,b){return d===this.root?(this.onNewRootItem(c),this.store.newItem(c)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(c,d,b,k,a){if(d===this.root&&!k)this.onLeaveRoot(c);this.inherited(arguments,
[c,d===this.root?null:d,b===this.root?null:b,k,a]);if(b===this.root)this.onAddToRoot(c)},onAddToRoot:function(){},onLeaveRoot:function(){},_requeryTop:function(){var c=this.root.children||[];this.store.fetch({query:this.query,onComplete:f.hitch(this,function(d){this.root.children=d;if(c.length!=d.length||h.some(c,function(b,c){return d[c]!=b}))this.onChildrenChange(this.root,d)})})},onNewItem:function(c,d){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(c){-1!=h.indexOf(this.root.children,
c)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(c,d,b,k){this._requeryTop();this.inherited(arguments)}})})},"commsy/Search":function(){define("commsy/Search","dojo/_base/declare,commsy/base,dojo/_base/lang,dojo/query,dojo/on,dojo/dom-attr".split(","),function(h,l,d,f,c,e){return h(l,{constructor:function(c){c=c||{};h.safeMixin(this,c);this.threshold=3;this.used=!1;this.matches=[];this.ajaxRequests=[]},setup:function(e){c(e,"keyup",d.hitch(this,function(b){this.onKeyUp(b)}));c(e,
"click",d.hitch(this,function(b){this.onClick(b)}))},onKeyUp:function(c){e.set(f("input#search_suggestion")[0],"value",c.target.value);c.target.value.length===this.threshold?(dojo.forEach(this.ajaxRequests,function(b){b.cancel()}),this.ajaxRequests.push(this.AJAXRequest("search","getAutocompleteSuggestions",{search_text:c.target.value.toLowerCase()},d.hitch(this,function(b){this.matches=b;this.autoSuggest(e.get(f("input#search_input")[0],"value"))}),d.hitch(this,function(){}),!1))):c.target.value.length>
this.threshold&&this.autoSuggest(c.target.value)},onClick:function(c){if(!1===this.used)e.set(c.target,"value",""),e.set(f("input#search_suggestion")[0],"value",""),this.used=!0},autoSuggest:function(c){var b=33,d="";dojo.forEach(this.matches,function(a){if(c.toLowerCase()===a.substr(0,c.length)&&a.length>c.length&&a.length<b)b=a.length,d=a});e.set(f("input#search_suggestion")[0],"value",c+d.substr(c.length))}})})},"commsy/AjaxActions":function(){define("commsy/AjaxActions","dojo/_base/declare,commsy/base,dojo/on,dojo/_base/lang,dojo/_base/fx,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/dom-style".split(","),
function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(a){a=a||{};h.safeMixin(this,a)},setup:function(a){dojo.forEach(a,f.hitch(this,function(a){var b=this.getAttrAsObject(a,"data-custom");d(a,"click",f.hitch(this,function(){this[b.action]&&f.hitch(this,this[b.action](b))}))}))},addToClipboard:function(a){this.AJAXRequest("actions","addToClipboard",{itemId:a.iid},f.hitch(this,function(){var a=e("a#tm_clipboard")[0];if(a){var c=e("span#tm_clipboard_copies")[0];c||(c=k.create("span",{id:"tm_clipboard_copies",
innerHTML:0},a,"after"));b.set(c,"innerHTML",parseInt(b.get(c,"innerHTML"))+1)}}))},versionMakeNew:function(a){var b=a.iid;this.AJAXRequest("actions","versionMakeNew",{itemId:b,versionID:a.vid},f.hitch(this,function(){this.reload(b)}))},exportToWordpress:function(a){var b=a.iid;this.AJAXRequest("actions","exportToWordpress",{itemId:b},f.hitch(this,function(){this.reload(b)}))},exportToWiki:function(a){var b=a.iid;this.AJAXRequest("actions","exportToWiki",{itemId:b},f.hitch(this,function(){this.reload(b)}))}})})},
"dojo/dnd/Manager":function(){define("dojo/dnd/Manager","../_base/array,../_base/declare,../_base/event,../_base/lang,../_base/window,../dom-class,../Evented,../has,../keys,../on,../topic,../touch,./common,./autoscroll,./Avatar".split(","),function(h,l,d,f,c,e,i,b,k,a,g,j,p,r,m){var n=l("dojo.dnd.Manager",[i],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:b("touch")?0:16,OFFSET_Y:b("touch")?-64:16,overSource:function(a){if(this.avatar)this.target=
a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update();g.publish("/dnd/source/over",a)},outSource:function(a){if(this.avatar){if(this.target==a)this.target=null,this.canDropFlag=!1,this.avatar.update(),g.publish("/dnd/source/over",null)}else g.publish("/dnd/source/over",null)},startDrag:function(b,k,m){r.autoScrollStart(c.doc);this.source=b;this.nodes=k;this.copy=Boolean(m);this.avatar=this.makeAvatar();c.body().appendChild(this.avatar.node);g.publish("/dnd/start",
b,k,this.copy);this.events=[a(c.doc,j.move,f.hitch(this,"onMouseMove")),a(c.doc,j.release,f.hitch(this,"onMouseUp")),a(c.doc,"keydown",f.hitch(this,"onKeyDown")),a(c.doc,"keyup",f.hitch(this,"onKeyUp")),a(c.doc,"dragstart",d.stop),a(c.body(),"selectstart",d.stop)];e.add(c.body(),"dojoDnd"+(m?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);if(this.canDropFlag!=a)this.canDropFlag=a,this.avatar.update()},stopDrag:function(){e.remove(c.body(),["dojoDndCopy","dojoDndMove"]);h.forEach(this.events,
function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new m(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var c=this.avatar;if(c)r.autoScrollNodes(a),c=c.node.style,c.left=a.pageX+this.OFFSET_X+"px",c.top=a.pageY+this.OFFSET_Y+"px",c=Boolean(this.source.copyState(p.getCopyKeyState(a))),this.copy!=c&&this._setCopyStatus(c);b("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&
this.canDropFlag){var b=Boolean(this.source.copyState(p.getCopyKeyState(a)));g.publish("/dnd/drop/before",this.source,this.nodes,b,this.target,a);g.publish("/dnd/drop",this.source,this.nodes,b,this.target,a)}else g.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case k.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case k.ESCAPE:g.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==
k.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();e.replace(c.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});p._manager=null;n.manager=p.manager=function(){if(!p._manager)p._manager=new n;return p._manager};return n})},"dijit/form/ToggleButton":function(){define("dijit/form/ToggleButton",["dojo/_base/declare","dojo/_base/kernel","./Button",
"./_ToggleButtonMixin"],function(h,l,d,f){return h("dijit.form.ToggleButton",[d,f],{baseClass:"dijitToggleButton",setChecked:function(c){l.deprecated("setChecked("+c+") is deprecated. Use set('checked',"+c+") instead.","","2.0");this.set("checked",c)}})})},"commsy/main":function(){require(["dojo/_base/declare","commsy/base","dojo/_base/lang"],function(h,l,d){(new (h(l,{constructor:function(){},init:function(){require(["dojo/query","dojo/dom-attr","dojo/on","dojo/NodeList-traverse","dojo/domReady!"],
d.hitch(this,function(f,c,e){var i=this.uri_object;this.initCommsyBar();e(document.body,"click",d.hitch(this,function(a){"popup_wrapper"===c.get(a.target,"id")&&alert("Bitte schlie\u00dfen Sie zuerst das Popup-Fenster, bevor Sie sonstige Seitenoperationen ausf\u00fchren")}));if("group"==this.uri_object.mod){var b=f("a#group_detail_group_enter")[0];if(b){var e=this.getAttrAsObject(b,"data-custom"),k=dojo.objectToQuery(this.replaceOrSetURIParam("group_option","1"));e.needsCode&&require(["dojo/on","dijit/form/TextBox",
"dijit/form/Button","dijit/Dialog"],function(a){a(b,"click",d.hitch(this,function(a){var b=new dijit.form.TextBox({}),c=new dijit.form.Button({label:"betreten",onClick:d.hitch(this,function(){location.href="commsy.php?"+k+"&code="+b.value;g.destroyRecursive()})}),g=new dijit.Dialog({title:"Teilnahme-Code"});dojo.place(b.domNode,g.containerNode,"last");dojo.place(c.domNode,g.containerNode,"last");g.show();a.preventDefault();return!1}))})}}var a=f("a#tm_stack")[0];a&&require(["commsy/popups/ToggleStack"],
function(b){new b(a,f("div#tm_menus div#tm_dropmenu_stack")[0])});var g=f("a#tm_widgets")[0];g&&require(["commsy/popups/ToggleWidgets"],function(a){new a(g,f("div#tm_menus div#tm_dropmenu_widget_bar")[0])});var j=f("a#tm_portfolio")[0];j&&require(["commsy/popups/TogglePortfolio"],function(a){new a(j,f("div#tm_menus div#tm_dropmenu_portfolio")[0])});f(".open_popup").forEach(d.hitch(this,function(a){var b=this.getAttrAsObject(a,"data-custom");require(["commsy/popups/Click"+this.ucFirst(b.module)+"Popup"],
function(c){(new c).init(a,b)})}));"index"===this.uri_object.fct&&require(["commsy/DivToggle"],function(a){(new a).setup()});require(["commsy/AjaxActions"],function(a){var b=f("a.ajax_action");b&&(new a).setup(b)});f("div.ckeditor").forEach(function(a){require(["commsy/ckeditor"],function(b){(new b).create(a)})});f("div.tree").forEach(function(a){require(["commsy/tree"],function(b){var c=new b;c.setupTree(a,function(){if(i.seltag){var a=c.buildPath(i.seltag);c.tree.set("paths",[a])}},!0)})});if("discussion"==
this.uri_object.mod&&"detail"==this.uri_object.fct){var p=f("div#discussion_tree")[0];p&&require(["commsy/DiscussionTree"],function(a){(new a).setupTree(p)})}"index"==this.uri_object.fct&&"date"==this.uri_object.mod&&require(["commsy/DateCalendar"],function(a){(new a).setup()});if(!0===this.from_php.dev.indexed_search){var h=f("input#search_input")[0];h&&require(["commsy/Search"],function(a){(new a).setup(h)})}f("a.new_item_2, a.new_item, a.attachment, span#detail_assessment, div.cal_days_events a, div.cal_days_week_events a").forEach(function(a){require(["commsy/Overlay"],
function(b){b().setup(a)})});if("home"===this.uri_object.mod){var m=[];f("div.content_item div[class^='list_wrap']").forEach(function(a){m.push({div:a,actor:f("a.open_close",a.parentNode)[0]})});require(["commsy/DivExpander"],function(a){a().setup(m)})}require(["commsy/Lightbox"],function(a){a().setup(f("a[class^='lightbox']"))});f("div.progressbar").forEach(function(a){require(["commsy/ProgressBar"],function(b){b().setup(a)})});if("detail"===this.uri_object.fct){var n=f("div.item_actions a.edit,div.item_actions a.detail,div.item_actions a.workflow,div.item_actions a.linked,div.item_actions a.annotations,div.item_actions a.versions");
require(["commsy/ActionExpander"],function(a){(new a).setup(n)})}if("index"===this.uri_object.fct){var q=f("input[type='checkbox'][name^='form_data[attach]']"),v=f("div.ii_right span#selected_items")[0];require(["commsy/ListSelection"],function(a){(new a).setup(q,v)})}f("div.uploader").forEach(function(a){require(["commsy/Uploader"],function(b){(new b).setup(a)})});-1!==window.location.href.indexOf("#")&&require(["commsy/AnchorFollower"],function(a){var a=new a,b=window.location.href.substring(window.location.href.indexOf("#")+
1);a.follow(b)});require(["commsy/Assessment"],function(a){(new a).setup(f("span#detail_assessment")[0])});f("div.colorpicker").forEach(function(a){require(["commsy/Colorpicker"],function(b){(new b).setup(a)})});require(["commsy/popups/TogglePersonalConfiguration","commsy/AutoOpenPopup"],function(a,b){(new b).setup()})}))},initCommsyBar:function(){require(["dojo/query","dojo/on","dojo/NodeList-traverse","dojo/domReady!"],d.hitch(this,function(f,c){var e=f("a#tm_settings")[0];if(e)c.once(e,"click",
d.hitch(this,function(){require(["commsy/popups/ToggleRoomConfiguration"],function(a){(new a(e,f("div#tm_menus div#tm_dropmenu_configuration")[0])).open()})}));var i=f("a#tm_user")[0];if(i)c.once(i,"click",d.hitch(this,function(){require(["commsy/popups/TogglePersonalConfiguration"],function(a){(new a(i,f("div#tm_menus div#tm_dropmenu_pers_bar")[0])).open()})}));var b=f("a#tm_bread_crumb")[0];if(b)c.once(b,"click",d.hitch(this,function(){require(["commsy/popups/ToggleBreadcrumb"],function(a){(new a(b,
f("div#tm_menus div#tm_dropmenu_breadcrumb")[0])).open()})}));var k=f("a#tm_clipboard")[0];if(k)c.once(k,"click",d.hitch(this,function(){require(["commsy/popups/ToggleClipboard"],function(a){(new a(k,f("div#tm_menus div#tm_dropmenu_clipboard")[0])).open()})}));var a=f("a#tm_mycalendar")[0];if(a)c.once(a,"click",d.hitch(this,function(){require(["commsy/bar/ToggleCalendar"],function(b){(new b(a,f("div#tm_menus div#tm_dropmenu_mycalendar")[0])).open()})}))}))}}))).init()})},"dojo/data/ItemFileWriteStore":function(){define("dojo/data/ItemFileWriteStore",
"../_base/lang,../_base/declare,../_base/array,../_base/json,../_base/kernel,./ItemFileReadStore,../date/stamp".split(","),function(h,l,d,f,c,e,i){return l("dojo.data.ItemFileWriteStore",e,{constructor:function(b){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap.Date.serialize)this._datatypeMap.Date.serialize=function(b){return i.toISOString(b,{zulu:!0})};if(b&&!1===b.referenceIntegrity)this.referenceIntegrity=
!1;this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(b){if(!b)throw Error("assertion failed in ItemFileWriteStore");},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(b,c){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof b&&"undefined"!=typeof b)throw Error("newItem() was passed something other than an object");var a=null,g=this._getIdentifierAttribute();if(g===Number)a=this._arrayOfAllItems.length;
else{a=b[g];if("undefined"===typeof a)throw Error("newItem() was not passed an identity for the new item");if(h.isArray(a))throw Error("newItem() was not passed an single-valued identity");}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[a]);this._assert("undefined"===typeof this._pending._newItems[a]);this._assert("undefined"===typeof this._pending._deletedItems[a]);var j={};j[this._storeRefPropName]=this;j[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&
(this._itemsByIdentity[a]=j,j[g]=[a]);this._arrayOfAllItems.push(j);g=null;if(c&&c.parent&&c.attribute){var g={item:c.parent,attribute:c.attribute,oldValue:void 0},d=this.getValues(c.parent,c.attribute);if(d&&0<d.length){var e=d.slice(0,d.length);g.oldValue=1===d.length?d[0]:d.slice(0,d.length);e.push(j);this._setValueOrValues(c.parent,c.attribute,e,!1);g.newValue=this.getValues(c.parent,c.attribute)}else this._setValueOrValues(c.parent,c.attribute,j,!1),g.newValue=j}else j[this._rootItemPropName]=
!0,this._arrayOfTopLevelItems.push(j);this._pending._newItems[a]=j;for(var f in b){if(f===this._storeRefPropName||f===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");a=b[f];h.isArray(a)||(a=[a]);j[f]=a;if(this.referenceIntegrity)for(d=0;d<a.length;d++)e=a[d],this.isItem(e)&&this._addReferenceToMap(e,j,f)}this.onNew(j,g);return j},_removeArrayElement:function(b,c){var a=d.indexOf(b,c);return-1!=a?(b.splice(a,1),!0):!1},deleteItem:function(b){this._assert(!this._saveInProgress);
this._assertIsItem(b);var c=b[this._itemNumPropName],a=this.getIdentity(b);if(this.referenceIntegrity){var g=this.getAttributes(b);b[this._reverseRefMap]&&(b["backup_"+this._reverseRefMap]=h.clone(b[this._reverseRefMap]));d.forEach(g,function(a){d.forEach(this.getValues(b,a),function(c){this.isItem(c)&&(b["backupRefs_"+this._reverseRefMap]||(b["backupRefs_"+this._reverseRefMap]=[]),b["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(c),attr:a}),this._removeReferenceFromMap(c,b,a))},this)},
this);if(g=b[this._reverseRefMap])for(var j in g){var e=null;if(e=this._itemsByIdentity?this._itemsByIdentity[j]:this._arrayOfAllItems[j])for(var f in g[j]){var m=this.getValues(e,f)||[],i=d.filter(m,function(b){return!(this.isItem(b)&&this.getIdentity(b)==a)},this);this._removeReferenceFromMap(b,e,f);i.length<m.length&&this._setValueOrValues(e,f,i,!0)}}}this._arrayOfAllItems[c]=null;b[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[a];this._pending._deletedItems[a]=
b;b[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,b);this.onDelete(b);return!0},setValue:function(b,c,a){return this._setValueOrValues(b,c,a,!0)},setValues:function(b,c,a){return this._setValueOrValues(b,c,a,!0)},unsetAttribute:function(b,c){return this._setValueOrValues(b,c,[],!0)},_setValueOrValues:function(b,c,a,g){this._assert(!this._saveInProgress);this._assertIsItem(b);this._assert(h.isString(c));this._assert("undefined"!==typeof a);var j=this._getIdentifierAttribute();
if(c==j)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var j=this._getValueOrValues(b,c),e=this.getIdentity(b);if(!this._pending._modifiedItems[e]){var f={},m;for(m in b)f[m]=m===this._storeRefPropName||m===this._itemNumPropName||m===this._rootItemPropName?b[m]:m===this._reverseRefMap?h.clone(b[m]):b[m].slice(0,b[m].length);this._pending._modifiedItems[e]=f}e=!1;if(h.isArray(a)&&0===a.length){if(e=delete b[c],a=void 0,this.referenceIntegrity&&
j){m=j;h.isArray(m)||(m=[m]);for(var i=0;i<m.length;i++)f=m[i],this.isItem(f)&&this._removeReferenceFromMap(f,b,c)}}else{e=h.isArray(a)?a.slice(0,a.length):[a];if(this.referenceIntegrity)if(j){m=j;h.isArray(m)||(m=[m]);var q={};d.forEach(m,function(a){this.isItem(a)&&(a=this.getIdentity(a),q[a.toString()]=!0)},this);d.forEach(e,function(a){if(this.isItem(a)){var g=this.getIdentity(a);q[g.toString()]?delete q[g.toString()]:this._addReferenceToMap(a,b,c)}},this);for(i in q)this._removeReferenceFromMap(this._itemsByIdentity?
this._itemsByIdentity[i]:this._arrayOfAllItems[i],b,c)}else for(i=0;i<e.length;i++)f=e[i],this.isItem(f)&&this._addReferenceToMap(f,b,c);b[c]=e;e=!0}if(g)this.onSet(b,c,j,a);return e},_addReferenceToMap:function(b,c,a){var c=this.getIdentity(c),g=b[this._reverseRefMap];g||(g=b[this._reverseRefMap]={});(b=g[c])||(b=g[c]={});b[a]=!0},_removeReferenceFromMap:function(b,c,a){var c=this.getIdentity(c),g=b[this._reverseRefMap],j;if(g){for(j in g)j==c&&(delete g[j][a],this._isEmpty(g[j])&&delete g[j]);this._isEmpty(g)&&
delete b[this._reverseRefMap]}},_dumpReferenceMap:function(){var b;for(b=0;b<this._arrayOfAllItems.length;b++);},_getValueOrValues:function(b,c){var a=void 0;this.hasAttribute(b,c)&&(a=this.getValues(b,c),a=1==a.length?a[0]:a);return a},_flatten:function(b){if(this.isItem(b))return{_reference:this.getIdentity(b)};if("object"===typeof b)for(var c in this._datatypeMap){var a=this._datatypeMap[c];if(h.isObject(a)&&!h.isFunction(a)){if(b instanceof a.type){if(!a.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+
c+"]");return{_type:c,_value:a.serialize(b)}}}else if(b instanceof a)return{_type:c,_value:b.toString()}}return b},_getNewFileContentString:function(){var b={},c=this._getIdentifierAttribute();if(c!==Number)b.identifier=c;if(this._labelAttr)b.label=this._labelAttr;b.items=[];for(c=0;c<this._arrayOfAllItems.length;++c){var a=this._arrayOfAllItems[c];if(null!==a){var g={},j;for(j in a)if(j!==this._storeRefPropName&&j!==this._itemNumPropName&&j!==this._reverseRefMap&&j!==this._rootItemPropName){var d=
this.getValues(a,j);if(1==d.length)g[j]=this._flatten(d[0]);else for(var e=[],m=0;m<d.length;++m)e.push(this._flatten(d[m])),g[j]=e}b.items.push(g)}}return f.toJson(b,!0)},_isEmpty:function(b){var c=!0;if(h.isObject(b))for(var a in b){c=!1;break}else h.isArray(b)&&0<b.length&&(c=!1);return c},save:function(b){this._assert(!this._saveInProgress);this._saveInProgress=!0;var d=this,a=function(){d._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};d._saveInProgress=!1;b&&b.onComplete&&b.onComplete.call(b.scope||
c.global)},g=function(a){d._saveInProgress=!1;b&&b.onError&&b.onError.call(b.scope||c.global,a)};if(this._saveEverything){var j=this._getNewFileContentString();this._saveEverything(a,g,j)}this._saveCustom&&this._saveCustom(a,g);!this._saveEverything&&!this._saveCustom&&a()},revert:function(){this._assert(!this._saveInProgress);for(var b in this._pending._modifiedItems){var c=this._pending._modifiedItems[b],a=null,a=this._itemsByIdentity?this._itemsByIdentity[b]:this._arrayOfAllItems[b];c[this._storeRefPropName]=
this;for(var g in a)delete a[g];h.mixin(a,c)}var j;for(b in this._pending._deletedItems)j=this._pending._deletedItems[b],j[this._storeRefPropName]=this,c=j[this._itemNumPropName],j["backup_"+this._reverseRefMap]&&(j[this._reverseRefMap]=j["backup_"+this._reverseRefMap],delete j["backup_"+this._reverseRefMap]),this._arrayOfAllItems[c]=j,this._itemsByIdentity&&(this._itemsByIdentity[b]=j),j[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(j);for(b in this._pending._deletedItems)j=this._pending._deletedItems[b],
j["backupRefs_"+this._reverseRefMap]&&(d.forEach(j["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],j,a.attr)},this),delete j["backupRefs_"+this._reverseRefMap]);for(b in this._pending._newItems)c=this._pending._newItems[b],c[this._storeRefPropName]=null,this._arrayOfAllItems[c[this._itemNumPropName]]=null,c[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,c),this._itemsByIdentity&&
delete this._itemsByIdentity[b];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(b){return b?(b=this.getIdentity(b),(new Boolean(this._pending._newItems[b]||this._pending._modifiedItems[b]||this._pending._deletedItems[b])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(){},onNew:function(){},onDelete:function(){},close:function(b){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"url:dijit/templates/TreeNode.html":'<div class="dijitTreeNode" role="presentation"\n\t><div data-dojo-attach-point="rowNode" class="dijitTreeRow dijitInline" role="presentation"\n\t\t><div data-dojo-attach-point="indentNode" class="dijitInline"></div\n\t\t><img src="${_blankGif}" alt="" data-dojo-attach-point="expandoNode" class="dijitTreeExpando" role="presentation"\n\t\t/><span data-dojo-attach-point="expandoNodeText" class="dijitExpandoText" role="presentation"\n\t\t></span\n\t\t><span data-dojo-attach-point="contentNode"\n\t\t\tclass="dijitTreeContent" role="presentation">\n\t\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="iconNode" class="dijitIcon dijitTreeIcon" role="presentation"\n\t\t\t/><span data-dojo-attach-point="labelNode" class="dijitTreeLabel" role="treeitem" tabindex="-1" aria-selected="false"></span>\n\t\t</span\n\t></div>\n\t<div data-dojo-attach-point="containerNode" class="dijitTreeContainer" role="presentation" style="display: none;"></div>\n</div>\n',
"url:dijit/templates/Tree.html":'<div class="dijitTree dijitTreeContainer" role="tree">\n\t<div class="dijitInline dijitTreeIndent" style="position: absolute; top: -9999px" data-dojo-attach-point="indentDetector"></div>\n</div>\n',"commsy/DivToggle":function(){define("commsy/DivToggle","dojo/_base/declare,commsy/base,dojo/query,dojo/dom-attr,dojo/dom-class,dojo/dom-style,dojo/_base/lang,dojo/fx,dojo/on".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(a){a=a||{};h.safeMixin(this,
a)},setup:function(){var a=d("a.divToggle");dojo.forEach(a,i.hitch(this,function(a){if(a){var b=this.getAttrAsObject(a,"data-custom"),c=d("div#"+b.toggleId)[0];c&&k(a,"click",i.hitch(this,function(){this.onClick(a,c)}))}}))},onClick:function(a,g){if(c.contains(g,"hidden")){f.set(a,"title",this.from_php.translations.common_hide);var j=d("img",a)[0];j&&(f.set(j,"src",this.from_php.template.tpl_path+"img/btn_close_rc.gif"),f.set(j,"alt",this.from_php.translations.common_hide));c.remove(g,"hidden");e.set(g,
"height","0px");b.wipeIn({node:g}).play()}else{f.set(a,"title",this.from_php.translations.common_show);if(j=d("img",a)[0])f.set(j,"src",this.from_php.template.tpl_path+"img/btn_open_rc.gif"),f.set(j,"alt",this.from_php.translations.common_show);b.wipeOut({node:g,onEnd:function(){c.add(g,"hidden")}}).play()}}})})},"dojo/cookie":function(){define("dojo/cookie",["./_base/kernel","./regexp"],function(h,l){h.cookie=function(d,f,c){var e=document.cookie,i;if(1==arguments.length)i=(i=e.match(RegExp("(?:^|; )"+
l.escapeString(d)+"=([^;]*)")))?decodeURIComponent(i[1]):void 0;else{c=c||{};e=c.expires;if("number"==typeof e){var b=new Date;b.setTime(b.getTime()+864E5*e);e=c.expires=b}if(e&&e.toUTCString)c.expires=e.toUTCString();var f=encodeURIComponent(f),e=d+"="+f,k;for(k in c)e+="; "+k,b=c[k],!0!==b&&(e+="="+b);document.cookie=e}return i};h.cookie.isSupported=function(){if(!("cookieEnabled"in navigator))this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),
navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1});return navigator.cookieEnabled};return h.cookie})},"cbtree/Tree":function(){require({cache:{"url:cbtree/templates/cbtreeNode.html":'<div class="dijitTreeNode" role="presentation">\n\t<div data-dojo-attach-point="rowNode" class="dijitTreeRow dijitInline" role="presentation">\n\t\t<div data-dojo-attach-point="indentNode" class="dijitInline"></div>\n\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="expandoNode"class="dijitTreeExpando" role="presentation" />\n\t\t<span data-dojo-attach-point="expandoNodeText" class="dijitExpandoText" role="presentation"></span>\n\t\t<span data-dojo-attach-point="checkBoxNode" class="cbtreeCheckBox" role="presentation"></span>\n\t\t<span data-dojo-attach-point="contentNode" class="dijitTreeContent" role="presentation">\n\t\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="iconNode" class="dijitIcon dijitTreeIcon" role="presentation"/>\n\t\t\t<span data-dojo-attach-point="labelNode" class="dijitTreeLabel" role="treeitem" tabindex="-1" aria-selected="false"></span>\n\t\t</span>\n\t</div>\n\t<div data-dojo-attach-point="containerNode" class="dijitTreeContainer" role="presentation" style="display: none;"></div>\n</div>\n'}});
define("cbtree/Tree","dojo/_base/array,dojo/_base/declare,dojo/_base/event,dojo/_base/lang,dojo/DeferredList,dojo/dom-construct,dojo/text!./templates/cbtreeNode.html,dijit/_Container,dijit/registry,dijit/Tree,./CheckBox,./models/_dndSelector,require".split(","),function(h,l,d,f,c,e,i,b,k,a,g,j,p){var r=l([a._TreeNode],{templateString:i,moduleName:"cbTree/_TreeNode",_checkBox:null,_toggle:!0,_widget:null,constructor:function(a){var b={type:g,target:"INPUT",mixin:null,postCreate:null},c={multiState:null,
checked:void 0,value:"on"};if(a=a.widget)f.mixin(c,a.args),f.mixin(b,a);b.args=c;this._toggle=f.isFunction(b.type.prototype.toggle);this._widget=b},_createCheckBox:function(a){var b=this.tree.model.getItemState(this.item),c=b.checked,b=b.enabled,g=this._widget,j=g.args;if(void 0!==c&&(j.multiState=a,j.checked=c,j.value=this.label,f.isFunction(g.mixin)&&f.hitch(this,g.mixin)(j),this._checkBox=new g.type(j)))f.isFunction(this._widget.postCreate)&&f.hitch(this._checkBox,this._widget.postCreate)(this),
e.place(this._checkBox.domNode,this.checkBoxNode,"replace");this._checkBox&&(this.isExpandable?(this.tree.branchReadOnly||!b)&&this._checkBox.set("readOnly",!0):(this.tree.leafReadOnly||!b)&&this._checkBox.set("readOnly",!0))},_getCheckedAttr:function(){if(this._checkBox)return this.tree.model.getChecked(this.item)},_set_checked_Attr:function(a){this._checkBox&&this._checkBox.set("checked",a)},_setCheckedAttr:function(a){if(this._checkBox)return this.tree.model.setChecked(this.item,a)},_getEnabledAttr:function(){return this.tree.model.getEnabled(this.item)},
_set_enabled_Attr:function(a){this._checkBox.set("readOnly",!a)},_setEnabledAttr:function(a){return this.tree.model.setEnabled(this.item,a)},_toggleCheckBox:function(){var a;this._checkBox&&(this._toggle?a=this._checkBox.toggle():(a=this._checkBox.get("checked"),a="mixed"==a?!0:!a),this.tree.model.setChecked(this.item,a));return a},destroy:function(){this._checkbox&&(this._checkbox.destroy(),delete this._checkbox);this.inherited(arguments)},postCreate:function(){var a=this.tree,b=null;!0===a.checkBoxes&&
this._createCheckBox(a._multiState);a._hasStyling&&a._iconAttr&&(b=a.get("icon",this.item))&&this.set("_icon_",b);this.set("tooltip",this.title);this.inherited(arguments)},setChildItems:function(a){var g=this.tree,j=g.model,d=[],e=this.getChildren();h.forEach(e,function(a){b.prototype.removeChild.call(this,a)},this);this.defer(function(){h.forEach(e,function(a){if(!a._destroyed&&!a.getParent()){g.dndController.removeTreeNode(a);var b=j.getIdentity(a.item),c=g._itemNodesMap[b];1==c.length?delete g._itemNodesMap[b]:
(b=h.indexOf(c,a),-1!=b&&c.splice(b,1));a.destroyRecursive()}})});this.state="LOADED";a&&0<a.length?(this.isExpandable=!0,h.forEach(a,function(a){var b=j.getIdentity(a),c=g._itemNodesMap[b],e;if(c)for(var f=0;f<c.length;f++)if(!c[f]||c[f]._beingDestroyed)c.splice(f,1),0==c.length&&delete g._itemNodesMap[b];else if(!c[f].getParent()){e=c[f];e.set("indent",this.indent+1);break}e||(e=this.tree._createTreeNode({item:a,tree:g,isExpandable:j.mayHaveChildren(a),label:g.getLabel(a),tooltip:g.getTooltip(a),
ownerDocument:g.ownerDocument,dir:g.dir,lang:g.lang,textDir:g.textDir,indent:this.indent+1}),c?c.push(e):g._itemNodesMap[b]=[e]);this.addChild(e);(this.tree.autoExpand||this.tree._state(e))&&d.push(g._expandNode(e))},this),h.forEach(this.getChildren(),function(a){a._updateLayout()})):(g._collapseNode(this),this.isExpandable=!1);this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);if(this==g.rootNode)(a=this.tree.showRoot?this:this.getChildren()[0])?(a.setFocusable(!0),g.lastFocused=
a):g.domNode.setAttribute("tabIndex","0");a=new c(d);this.tree._startPaint(a);return a}});return l([a],{branchIcons:!0,branchReadOnly:!1,checkBoxes:!0,leafReadOnly:!1,nodeIcons:!0,dndController:j,moduleName:"cbTree/Tree",_multiState:!0,_checkedAttr:"",_customWidget:null,_eventAttrMap:null,_dojoRequired:{min:{major:1,minor:8},max:{major:1,minor:9}},_assertVersion:function(){if(dojo.version){var a=10*dojo.version.major+dojo.version.minor,b=999,c=0;if(this._dojoRequired&&(void 0!==this._dojoRequired.min&&
(c=10*this._dojoRequired.min.major+this._dojoRequired.min.minor),void 0!==this._dojoRequired.max&&(b=10*this._dojoRequired.max.major+this._dojoRequired.max.minor),a<c||a>b))throw Error(this.moduleName+"::_assertVersion(): invalid dojo version.");}else throw Error(this.moduleNmae+"::_assertVersion(): unable to determine dojo version.");},_createTreeNode:function(a){a.widget=this._customWidget;if(this._hasStyling&&this._icon)a.icon=this._icon;return new r(a)},_onCheckBoxClick:function(a,b,c){var g=
a.item;this._publish("checkbox",{item:g,node:a,state:b,evt:c});this.onCheckBoxClick(g,a,c);this.onClick(a.item,a,c);this.focusNode(a);d.stop(c)},_onClick:function(a,b){if(b.target.nodeName==a._widget.target){var c=a._checkBox.get("checked");this.model.setChecked(a.item,c);this._onCheckBoxClick(a,c,b)}else this.inherited(arguments)},_onItemChange:function(a,b,c){if(b=this._eventAttrMap[b]){var g=this._itemNodesMap[this.model.getIdentity(a)],j={};g&&(j[b.attribute]=b.value?f.isFunction(b.value)?f.hitch(this,
b.value)(a,b.attribute,c):b.value:c,h.forEach(g,function(a){a.set(j)},this))}},_onKeyPress:function(a){if(!a.altKey){var b=k.getEnclosingWidget(a.target);f.isString(a.charOrCode)&&" "==a.charOrCode&&b._toggleCheckBox()}this.inherited(arguments)},_onLabelChange:function(a,b){this.mapEventToAttr(a,b,"label")},_setWidgetAttr:function(a){var b=a;if(f.isString(a))return this._setWidgetAttr({type:a});if(f.isObject(a)&&a.hasOwnProperty("type"))if(b=a.type,f.isFunction(b))if((b=b.prototype)&&"undefined"!==
typeof b.checked){if(f.isFunction(b.get)&&f.isFunction(b.set)){this._customWidget=a;return}b="Widget does not support get() and/or set()"}else b="widget MUST have a 'checked' property";else{if(f.isString(b)&&~b.indexOf("/")){var c=this;p([b],function(b){a.type=b;c._setWidgetAttr(a)});return}b="argument is not a valid module id"}else b="Object is missing required 'type' property";throw Error(this.moduleName+"::_setWidgetAttr(): "+b);},create:function(){this._assertVersion();this.inherited(arguments)},
destroy:function(){this.model=null;this.inherited(arguments)},getIconStyle:function(a,b){var c=this.model.mayHaveChildren(a),g=this.inherited(arguments)||{};c?this.branchIcons||(g.display="none"):this.nodeIcons||(g.display="none");return g},mixinEvent:function(a,b,c){this.model.isItem(a)&&this._eventAttrMap[b]&&(this._onItemChange(a,b,c),this.onEvent(a,b,c))},onCheckBoxClick:function(){},onEvent:function(){},postMixInProperties:function(){this._eventAttrMap={};this.inherited(arguments)},postCreate:function(){var a=
this.model;if(this.model){if(!0===this.checkBoxes){if(!this._modelOk())throw Error(this.moduleName+"::postCreate(): model does not support getChecked() and/or setChecked().");this._multiState=a.multiState;this._checkedAttr=a.checkedAttr;this.mapEventToAttr(null,this._checkedAttr||"checked","_checked_");a.validateData()}this.connect(a,"onLabelChange","_onLabelChange");this.mapEventToAttr(null,a.get("enabledAttr"),"_enabled_");this.mapEventToAttr(null,a.get("labelAttr"),"label");this.inherited(arguments)}else throw Error(this.moduleName+
"::postCreate(): no model was specified.");},mapEventToAttr:function(a,b,c,g){f.isString(b)&&f.isString(c)&&b.length&&c.length&&(a&&delete this._eventAttrMap[a],this._eventAttrMap[b]={attribute:c,value:g})},_modelOk:function(){return this.model.getChecked&&f.isFunction(this.model.getChecked)&&this.model.setChecked&&f.isFunction(this.model.setChecked)?!0:!1}})})},"url:dijit/form/templates/Button.html":'<span class="dijit dijitReset dijitInline" role="presentation"\n\t><span class="dijitReset dijitInline dijitButtonNode"\n\t\tdata-dojo-attach-event="ondijitclick:_onClick" role="presentation"\n\t\t><span class="dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point="titleNode,focusNode"\n\t\t\trole="button" aria-labelledby="${id}_label"\n\t\t\t><span class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode"></span\n\t\t\t><span class="dijitReset dijitToggleButtonIconChar">&#x25CF;</span\n\t\t\t><span class="dijitReset dijitInline dijitButtonText"\n\t\t\t\tid="${id}_label"\n\t\t\t\tdata-dojo-attach-point="containerNode"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen"\n\t\ttabIndex="-1" role="presentation" data-dojo-attach-point="valueNode"\n/></span>\n',
"cbtree/models/_dndSelector":function(){define("cbtree/models/_dndSelector","dojo/_base/array,dojo/_base/connect,dojo/_base/declare,dojo/_base/Deferred,dojo/_base/kernel,dojo/_base/lang,dojo/cookie,dojo/mouse,dojo/on,dojo/touch,./_dndContainer".split(","),function(h,l,d,f,c,e,i,b,k,a,g){return d("dijit.tree._dndSelector",g,{constructor:function(){this.selection={};this.anchor=null;if(!this.cookieName&&this.tree.id)this.cookieName=this.tree.id+"SaveSelectedCookie";this.events.push(k(this.tree.domNode,
a.press,e.hitch(this,"onMouseDown")),k(this.tree.domNode,a.release,e.hitch(this,"onMouseUp")),k(this.tree.domNode,a.move,e.hitch(this,"onMouseMove")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b,c=this.selection,g;for(g in c)b=c[g],b.domNode&&!b._destroyed?a.push(c[g]):delete c[g];return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));
if(b)this.anchor=a;return a},removeTreeNode:function(a){this.setSelection(this._setDifference(this.getSelectedTreeNodes(),[a]));return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var b=this.getSelectedTreeNodes();h.forEach(this._setDifference(b,a),e.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));h.forEach(this._setDifference(a,b),e.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=
a}));this._updateSelectionProperties()},_setDifference:function(a,b){h.forEach(b,function(a){a.__exclude__=!0});var c=h.filter(a,function(a){return!a.__exclude__});h.forEach(b,function(a){delete a.__exclude__});return c},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[],g=[];h.forEach(a,function(a){var j=a.getTreePath(),d=this.tree.model;c.push(a);b.push(j);j=h.map(j,function(a){return d.getIdentity(a)},this);g.push(j.join("/"))},this);a=h.map(c,function(a){return a.item});
this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null);this.tree.persist&&0<g.length&&i(this.cookieName,g.join(","),{expires:365})},_getSavedPaths:function(){var a=this.tree;if(a.persist&&a.dndController.cookieName){var b=[];(a=i(a.dndController.cookieName))&&(b=h.map(a.split(","),function(a){return a.split("/")}));return b}},onMouseDown:function(a){if(!(!this.current||
this.tree.isExpandoNode(a.target,this.current)||"touchstart"!=a.type&&!b.isLeft(a))){a.preventDefault();var c=this.current,g=l.isCopyKey(a),d=c.id;!this.singular&&!a.shiftKey&&this.selection[d]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(c,g,a.shiftKey))}},onMouseUp:function(a){if(this._doDeselect)this._doDeselect=!1,this.userSelect(this.current,l.isCopyKey(a),a.shiftKey)},onMouseMove:function(){this._doDeselect=!1},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-
b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);var g=doc.createRange();g.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,g)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&
this.anchor){c=this.anchor;0>this._compareNodes(this.anchor.rowNode,a.rowNode)?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNextNode(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,b){var b=b||c.global,g;for(g in this.selection)a.call(b,this.getItem(g),g,this)}})})},"url:dijit/form/templates/CheckBox.html":'<div class="dijit dijitReset dijitInline" role="presentation"\n\t><input\n\t \t${!nameAttrSetting} type="${type}" ${checkedAttrSetting}\n\t\tclass="dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point="focusNode"\n\t \tdata-dojo-attach-event="onclick:_onClick"\n/></div>\n',
"commsy/popups/ToggleRoomConfiguration":function(){define("commsy/popups/ToggleRoomConfiguration","dojo/_base/declare,commsy/TogglePopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b){return h(l,{sendImages:[],constructor:function(b,a){this.popup_button_node=b;this.contentNode=a;this.module="configuration";this.features=["editor","upload","upload-single","colorpicker"];this.registerPopupClick()},onTogglePopup:function(){!0===
this.is_open?(f.add(this.popup_button_node,"tm_settings_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_settings_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){var f=d("input#add_community_room",this.contentNode)[0];f&&i(f,"click",b.hitch(this,function(){this.onClickAssignCommunityRoom()}));i(d("input#add_additional_status",this.contentNode)[0],"click",b.hitch(this,function(){this.onClickAdditionalStatus()}));this.updateConfigurationSchemaPreview();
i(d("select#room_color_choice",this.contentNode)[0],"change",b.hitch(this,function(){this.updateConfigurationSchemaPreview()}));dojo.forEach(d("input[name='form_data[member_check]']",this.contentNode),b.hitch(this,function(a){"withcode"===c.get(a,"value")?i(a,"click",function(){c.set(d("input#code",this.contentNode)[0],"disabled",!1)}):i(a,"click",function(){c.set(d("input#code",this.contentNode)[0],"disabled",!0)})}));f=d("select#moderation_rubric",this.contentNode)[0];this.updateUsageHints(c.get(f,
"value"));i(f,"change",b.hitch(this,function(){var a=d("select#moderation_rubric",this.contentNode)[0];this.updateUsageHints(c.get(a,"value"))}));var a=d("select#mailtext_rubric",this.contentNode)[0],f=d("option:checked",a)[0];this.updateMailText(c.get(f,"id"));i(a,"change",b.hitch(this,function(){var b=d("option:checked",a)[0];this.updateMailText(c.get(b,"id"))}));f=d("select#additional_agb_description_text",this.contentNode)[0];this.updateUsageContract(c.get(f,"value"));i(f,"change",b.hitch(this,
function(){var a=d("select#additional_agb_description_text",this.contentNode)[0];this.updateUsageContract(c.get(a,"value"))}));dojo.ready(b.hitch(this,function(){this.featureHandles["upload-single"][0].setCallback(b.hitch(this,function(a){var b=d("div.filePreview",this.featureHandles["upload-single"][0].uploader.form)[0];e.empty(b);e.create("img",{src:"commsy.php?cid="+this.uri_object.cid+"&mod=picture&fct=getTemp&fileName="+a.file},b,"last");this.sendImages.push({part:"room_logo",fileInfo:a})}));
this.featureHandles["upload-single"][1].setCallback(b.hitch(this,function(a){var b=d("div.filePreview",this.featureHandles["upload-single"][0].uploader.form)[0];e.empty(b);e.create("img",{src:"commsy.php?cid="+this.uri_object.cid+"&mod=picture&fct=getTemp&fileName="+a.file},b,"last");this.sendImages.push({part:"room_bg",fileInfo:a})}))}));require(["commsy/Accounts"],b.hitch(this,function(a){a=new a;a.init(this.cid,this.from_php.template.tpl_path);var b=this.from_php.autoOpenPopup;if(b){var c=d("a[href='"+
b.tab+"']")[0];c&&(a.setStatus(b.parameters.filter),c.click())}}));(f=d("#submit_delete_wordpress",this.contentNode)[0])&&i(f,"click",b.hitch(this,function(){this.button_delete=new dijit.form.Button({label:"Blog endg&uuml;ltig l&ouml;schen",onClick:b.hitch(this,function(){this.onPopupSubmit({part:"external_configuration",action:"delete_wordpress"});this.dialog.destroyRecursive()})});this.button_cancel=new dijit.form.Button({label:"Abbrechen",onClick:b.hitch(this,function(){this.dialog.destroyRecursive()})});
this.dialog=new dijit.Dialog({title:"Wordpress l&ouml;schen",content:"<b style='color:#ff0000;'>Achtung: Alle Daten im Blog werden gel&ouml;scht. Dieser Vorgang kann nicht r&uuml;ckg&auml;ngig gemacht werden!</b><br/><br/>"});dojo.place(this.button_delete.domNode,this.dialog.containerNode);dojo.place(this.button_cancel.domNode,this.dialog.containerNode);this.dialog.show()}));(f=d("#submit_delete_wiki",this.contentNode)[0])&&i(f,"click",b.hitch(this,function(){this.button_delete=new dijit.form.Button({label:"Wiki endg&uuml;ltig l&ouml;schen",
onClick:b.hitch(this,function(){this.onPopupSubmit({part:"external_configuration",action:"delete_wiki"});this.dialog.destroyRecursive()})});this.button_cancel=new dijit.form.Button({label:"Abbrechen",onClick:b.hitch(this,function(){this.dialog.destroyRecursive()})});this.dialog=new dijit.Dialog({title:"Wiki l&ouml;schen",content:"<b style='color:#ff0000;'>Ein gel&ouml;schtes Wiki kann nicht wieder rekonstruiert werden. M&ouml;chten Sie dieses Wiki endg&uuml;ltig l&ouml;schen?</b><br/><br/>"});dojo.place(this.button_delete.domNode,
this.dialog.containerNode);dojo.place(this.button_cancel.domNode,this.dialog.containerNode);this.dialog.show()}));(f=d("#submit_delete_room",this.contentNode)[0])&&i(f,"click",b.hitch(this,function(){this.button_delete=new dijit.form.Button({label:"Raum endg&uuml;ltig l&ouml;schen",onClick:b.hitch(this,function(){this.onPopupSubmit({part:"room_configuration",action:"delete_room"});this.dialog.destroyRecursive()})});this.button_cancel=new dijit.form.Button({label:"Abbrechen",onClick:b.hitch(this,function(){this.dialog.destroyRecursive()})});
this.dialog=new dijit.Dialog({title:"Raum l&ouml;schen",content:"<b style='color:#ff0000;'>Achtung: Der gesamte Raum und alle Daten im Raum werden gel&ouml;scht. Dieser Vorgang kann nicht r&uuml;ckg&auml;ngig gemacht werden!</b><br/><br/>"});dojo.place(this.button_delete.domNode,this.dialog.containerNode);dojo.place(this.button_cancel.domNode,this.dialog.containerNode);this.dialog.show()}))},onClickAssignCommunityRoom:function(){var b=d("select#room_communityrooms",this.contentNode)[0],a=c.get(b,
"value");if(!isNaN(a)&&-1<a){var g=!1;dojo.forEach(d("input[name^='form_data[communityroomlist_']"),function(b){if(/form_data\[communityroomlist_([0-9]*)\]/.exec(c.get(b,"name"))[1]==a)return g=!0,!1});if(!1===g){var j=d("div#assigned_community_rooms",this.contentNode)[0];e.create("input",{id:"room_communityroomlist",type:"checkbox",checked:!0,value:a,name:"form_data[communityroomlist_"+a+"]"},j,"last");b=c.get(d("option[value='"+a+"']",b)[0],"innerHTML");e.create("span",{innerHTML:b},j,"last")}}},
onClickAdditionalStatus:function(){var b=d("input#status")[0],a=c.get(b,"value");c.set(b,"value","");if(""!==a){var b=d("div#additional_status_list")[0],g=5;dojo.forEach(d("input",b),function(a,b){b=/form_data\[additional_status_([0-9]*)\]/.exec(c.get(a,"name"))[1];b>=g&&(g=parseInt(b)+1)});e.create("input",{type:"checkbox",checked:!0,value:a,name:"form_data[additional_status_"+g+"]"},b,"last");e.create("span",{innerHTML:a},b,"last")}},updateConfigurationSchemaPreview:function(){var b=d("select#room_color_choice option:checked",
this.contentNode)[0],a=c.get(b,"value");c.get(b,"innerHTML");var b=d("div#room_color_preview img",this.contentNode)[0],g=d("div#room_color_preview",this.contentNode)[0],j=d("div#room_color_own",this.contentNode)[0];"individual"===a?(f.add(g,"hidden"),f.remove(j,"hidden")):(f.remove(g,"hidden"),f.add(j,"hidden"),c.set(b,"src","templates/themes/"+a+"/preview.gif"))},updateUsageHints:function(b){dojo.forEach(d("input[id^='moderation_title_']",this.contentNode),function(a){f.add(a,"hidden")});dojo.forEach(d("div[id^='moderation_description_'], textarea[id^='moderation_description_']",
this.contentNode),function(a){f.add(a.parentNode,"hidden")});f.remove(d("input#moderation_title_"+b,this.contentNode)[0],"hidden");f.remove(d("div#moderation_description_"+b+", textarea#moderation_description_"+b,this.contentNode)[0].parentNode,"hidden")},updateMailText:function(b){b=/mail_text_([0-9]*)/.exec(b)[1];dojo.forEach(d("textarea[id^='moderation_mail_body_']",this.contentNode),function(a){f.add(a.parentNode,"hidden");f.add(a.parentNode.parentNode,"hidden")});dojo.forEach(d("textarea#moderation_mail_body_de_"+
b+", textarea#moderation_mail_body_en_"+b,this.contentNode),function(a){f.remove(a.parentNode,"hidden");f.remove(a.parentNode.parentNode,"hidden")})},updateUsageContract:function(b){dojo.forEach(d("div[id^='agb_text_']",this.contentNode),function(a){f.add(a.parentNode,"hidden");f.add(a.parentNode.parentNode,"hidden")});b=d("div[id^='agb_text_"+b+"']")[0];f.remove(b.parentNode,"hidden");f.remove(b.parentNode.parentNode,"hidden")},onPopupSubmit:function(b){var a=b.part,b=b.action;dojo.forEach(this.featureHandles.editor,
function(a){a.getInstance();var b=a.getNode().parentNode;c.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});this.submit({tabs:[{id:a}],nodeLists:[]},{part:a,action:b})},onPopupSubmitSuccess:function(c){0<this.sendImages.length?this.AJAXRequest("popup","save",{module:"configuration",additional:{part:this.sendImages[0].part,fileInfo:this.sendImages[0].fileInfo}},b.hitch(this,function(){this.sendImages[1]?this.AJAXRequest("popup","save",{module:"configuration",additional:{part:this.sendImages[1].part,
fileInfo:this.sendImages[1].fileInfo}},function(){location.reload()}):location.reload()})):c?location.href="commsy.php?cid="+c:location.reload()}})})},"commsy/popups/ToggleBreadcrumb":function(){define("commsy/popups/ToggleBreadcrumb","dojo/_base/declare,commsy/TogglePopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang,dojo/dnd/Source".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(a,b){this.popup_button_node=a;this.contentNode=b;
this.module="breadcrumb";this.features=[];this.registerPopupClick()},onTogglePopup:function(){!0===this.is_open?(f.add(this.popup_button_node,"tm_user_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_user_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){var a=d("a#edit_roomlist",this.contentNode)[0];if(a)i.once(a,"click",b.hitch(this,function(){this.setupEditMode()}));dojo.forEach(d("div.room_change_item",this.contentNode),b.hitch(this,function(a){var b=
this.getAttrAsObject(a,"data-custom").href;i(a,"click",function(){location.href=b})}))},onPopupSubmit:function(a){a=a.part;this.submit({tabs:[{id:a}],nodeLists:[]},{part:a})},setupEditMode:function(){var a=d("div#profile_content_row_three, div#profile_content_row_four",this.contentNode);f.remove(a[1],"hidden");dojo.forEach(d("div.room_block",this.contentNode),b.hitch(this,function(a){var g=d("div.breadcrumb_room_area",a),j=null,i=null;dojo.forEach(g,b.hitch(this,function(a,b){0===b?(j=a,i=d("div.clear",
j)[0]):(dojo.forEach(d("div.room_change_item",a),function(a){e.place(a,i,"before")}),e.destroy(a))}));var k=-1,h=0;dojo.forEach(d("div.room_change_item, div.room_dummy",j),b.hitch(this,function(a,b){f.contains(a,"room_dummy")?f.remove(a,"room_dummy_no_border"):k=b;h++}));g=0;0!==h%4?g=8-h%4:k>h-3&&(g=4);for(var l=0;l<g;l++)e.create("div",{className:"room_dummy"},i,"before");dojo.forEach(d("> h3",a),function(b){e.destroy(b,a)});dojo.forEach(d("> h2",a),function(a){e.create("input",{value:c.get(a,"innerHTML")},
a,"replace")})}));var g=e.create("div",{className:"roomlist_append_block"}),j=e.create("a",{id:"roomlist_append_block",href:"#",innerHTML:this.from_php.i18n.COMMON_NEW_BLOCK},g,"last");e.place(g,d("div#profile_content_row_three div.room_block:last-child",this.contentNode)[0],"after");i(j,"click",b.hitch(this,function(a){this.appendNewBlock();a.preventDefault()}));g=e.create("div",{className:"roomlist_save"});j=e.create("a",{id:"roomlist_save",href:"#",innerHTML:this.from_php.i18n.COMMON_SAVE_BUTTON},
g,"last");e.place(g,d("div#profile_content_row_three",this.contentNode)[0],"last");e.create("div",{className:"clear"},g,"after");i(j,"click",b.hitch(this,function(a){this.saveRoomList();a.preventDefault()}));this.setupSortables(a)},setupSortables:function(a){var c=[];dojo.forEach(a,function(a){dojo.forEach(d("div.breadcrumb_room_area",a),function(a){c.push(a)})});var j=[];dojo.forEach(c,b.hitch(this,function(a,b){j.push(new k(a,{singular:!0}));var c=d("div.room_change_item, div.room_dummy",a);j[b].insertNodes(!1,
c,d("div.clear",a)[0])}))},appendNewBlock:function(){var a=e.create("div",{className:"room_block"},d("div#profile_content_row_three div.roomlist_append_block",this.contentNode)[0],"before");e.create("input",{value:this.from_php.i18n.COMMON_NEW_BLOCK},a,"last");for(var b=e.create("div",{className:"breadcrumb_room_area"},a,"last"),c=0;8>c;c++)e.create("div",{className:"room_dummy"},b,"last");e.create("div",{className:"clear"},b,"last");this.setupSortables(new dojo.NodeList(a))},onPopupSubmitSuccess:function(){this.close()},
saveRoomList:function(){var a={module:"breadcrumb",form_data:[]},g=[];dojo.forEach(d("div#profile_content_row_three div.room_block"),function(a){g.push({type:"title",value:c.get(d(">input",a)[0],"value")});dojo.forEach(d("div.breadcrumb_room_area div.room_change_item, div.breadcrumb_room_area div.room_dummy",a),function(a){var b="room",j="";f.contains(a,"room_dummy")?b="dummy":j=c.get(d("input[name='hidden_item_id']",a)[0],"value");g.push({type:b,value:j})})});a.form_data.push({name:"room_config",
value:g});this.AJAXRequest("popup","save",a,b.hitch(this,function(){this.close()}))}})})},"commsy/popups/ClickTopicPopup":function(){define("commsy/popups/ClickTopicPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on".split(","),function(h,l,d,f,c,e,i){return h(l,{sendImages:[],constructor:function(){this.sendImages=[]},init:function(b,c){this.triggerNode=b;this.item_id=c.iid;this.module="topic";this.editType=c.editType;
this.fileInfo=null;this.features="editor,upload,upload-single,netnavigation,calendar,path".split(",");this.registerPopupClick()},setupSpecific:function(){dojo.ready(c.hitch(this,function(){this.featureHandles["upload-single"]&&this.featureHandles["upload-single"][0].setCallback(c.hitch(this,function(b){var c=d("div.filePreview",this.featureHandles["upload-single"][0].uploader.form)[0];e.empty(c);e.create("img",{src:"commsy.php?cid="+this.uri_object.cid+"&mod=picture&fct=getTemp&fileName="+b.file},
c,"last");this.sendImages.push({part:"upload_picture",fileInfo:b})}))}))},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(b){b.getInstance();var c=b.getNode().parentNode;i.set(d("input[type='hidden']",c)[0],"value",b.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",this.contentNode)},{query:d("input[name='form_data[title]']",
this.contentNode)}]})},onPopupSubmitSuccess:function(b){if(0<this.sendImages.length)var d={module:"group",additional:{action:this.sendImages[0].part,fileInfo:this.sendImages[0].fileInfo,iid:b}};"NEW"===this.item_id?this.featureHandles.netnavigation[0].afterItemCreation(b,c.hitch(this,function(){this.featureHandles.path[0].save(b,c.hitch(this,function(){0<this.sendImages.length?this.AJAXRequest("popup","save",d,c.hitch(this,function(){this.reload(b)})):this.reload(b)}))})):0<this.sendImages.length?
this.AJAXRequest("popup","save",d,c.hitch(this,function(){this.featureHandles.path[0].save(b,c.hitch(this,function(){this.reload(b)}))})):this.featureHandles.path[0].save(b,c.hitch(this,function(){this.reload(b)}))}})})},"dijit/form/_FormWidgetMixin":function(){define("dijit/form/_FormWidgetMixin","dojo/_base/array,dojo/_base/declare,dojo/dom-attr,dojo/dom-style,dojo/_base/lang,dojo/mouse,dojo/sniff,dojo/window,../a11y".split(","),function(h,l,d,f,c,e,i,b,k){return l("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(a){this._set("disabled",a);d.set(this.focusNode,"disabled",a);this.valueNode&&d.set(this.valueNode,"disabled",a);this.focusNode.setAttribute("aria-disabled",a?"true":"false");a?(this._set("hovering",!1),this._set("active",!1),a="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:
"focusNode",h.forEach(c.isArray(a)?a:[a],function(a){a=this[a];i("webkit")||k.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var c=this.connect(this.focusNode,"onfocus",function(){this.disconnect(d);this.disconnect(c)}),d=this.connect(this.ownerDocumentBody,"onmouseup",function(){this.disconnect(d);this.disconnect(c);this.focused&&this.focus()});
this.scrollOnFocus&&this.defer(function(){b.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=f.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){if(void 0==this._lastValueReported&&
(null===b||!this._onChangeActive))this._resetValue=this._lastValueReported=a;this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);if((this.intermediateChanges||b||void 0===b)&&this._pendingOnChange)if(this._lastValueReported=a,this._pendingOnChange=!1,this._onChangeActive)this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)})},create:function(){this.inherited(arguments);
this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"commsy/ListSelection":function(){define("commsy/ListSelection","dojo/_base/declare,commsy/base,dojo/_base/lang,dojo/query,dojo/on,dojo/cookie,dojo/dom-attr,dojo/dom-construct,dojo/_base/array".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{cookieName:"commsy_list_selection",cookieObject:{lastRubric:null,selectedIDs:[]},currentRubric:null,
inputNodes:null,counterNode:null,constructor:function(a){a=a||{};h.safeMixin(this,a)},setup:function(a,b){this.inputNodes=a;this.counterNode=b;this.currentRubric=this.uri_object.mod;var j=e(this.cookieName),i={};j&&(i=dojo.fromJson(j));this.cookieObject.lastRubric=i.lastRubric||this.currentRubric;this.cookieObject.selectedIDs=i.selectedIDs||[];c(this.inputNodes,"click",d.hitch(this,function(a){this.onClickCheckbox(a.target)}));(j=f("input#delete_confirmselect_option")[0])&&c(j,"click",d.hitch(this,
function(a){this.onClickListActionSubmit(a.target)}));(j=f("input#selectAll")[0])&&c(j,"click",d.hitch(this,function(a){this.onSelectAll(a.target)}));this.currentRubric===this.cookieObject.lastRubric?this.restoreSelection():this.cookieObject.selectedIDs=[];this.cookieObject.lastRubric=this.currentRubric;e(this.cookieName,dojo.toJson(this.cookieObject))},restoreSelection:function(){dojo.forEach(this.inputNodes,d.hitch(this,function(a){var b=i.get(a,"name"),b=b.substr(18).substr(0,b.length-19);-1!==
k.indexOf(this.cookieObject.selectedIDs,b)&&i.set(a,"checked","checked")}));this.counterNode&&i.set(this.counterNode,"innerHTML",this.cookieObject.selectedIDs.length)},onClickCheckbox:function(a){var b=i.get(a,"name"),b=b.substr(18).substr(0,b.length-19);i.get(a,"checked")?this.cookieObject.selectedIDs.push(b):this.cookieObject.selectedIDs.splice(k.indexOf(this.cookieObject.selectedIDs,b),1);e(this.cookieName,dojo.toJson(this.cookieObject));this.restoreSelection()},performListOption:function(a){"listoption_download"==
a&&dojo.forEach(this.cookieObject.selectedIDs,d.hitch(this,function(a){a=b.create("a",{href:"commsy.php?cid="+this.uri_object.cid+"&mod=download&fct=action&iid="+a,target:"_blank"},f("body")[0],"last");a.click();b.destroy(a)}))},onClickListActionSubmit:function(){this.performListOption(i.get(f("select[name='form_data[option][list]']")[0],"value"));this.cookieObject.selectedIDs=[];e(this.cookieName,dojo.toJson(this.cookieObject))},onSelectAll:function(){dojo.forEach(f("div.row_even input[type='checkbox'], div.row_odd input[type='checkbox']"),
d.hitch(this,function(a){a.click()}))}})})},"url:cbtree/templates/cbtreeNode.html":'<div class="dijitTreeNode" role="presentation">\n\t<div data-dojo-attach-point="rowNode" class="dijitTreeRow dijitInline" role="presentation">\n\t\t<div data-dojo-attach-point="indentNode" class="dijitInline"></div>\n\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="expandoNode"class="dijitTreeExpando" role="presentation" />\n\t\t<span data-dojo-attach-point="expandoNodeText" class="dijitExpandoText" role="presentation"></span>\n\t\t<span data-dojo-attach-point="checkBoxNode" class="cbtreeCheckBox" role="presentation"></span>\n\t\t<span data-dojo-attach-point="contentNode" class="dijitTreeContent" role="presentation">\n\t\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="iconNode" class="dijitIcon dijitTreeIcon" role="presentation"/>\n\t\t\t<span data-dojo-attach-point="labelNode" class="dijitTreeLabel" role="treeitem" tabindex="-1" aria-selected="false"></span>\n\t\t</span>\n\t</div>\n\t<div data-dojo-attach-point="containerNode" class="dijitTreeContainer" role="presentation" style="display: none;"></div>\n</div>\n',
"commsy/popups/ClickAnnouncementPopup":function(){define("commsy/popups/ClickAnnouncementPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on".split(","),function(h,l,d,f,c,e,i){return h(l,{constructor:function(){},init:function(b,c){this.triggerNode=b;this.item_id=c.iid;this.module="announcement";this.editType=c.editType;this.features=["editor","tree","upload","netnavigation","calendar"];this.registerPopupClick()},
setupSpecific:function(){},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(b){b.getInstance();var c=b.getNode().parentNode;i.set(d("input[type='hidden']",c)[0],"value",b.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",this.contentNode)},
{query:d("input[name='form_data[dayEnd]']",this.contentNode)},{query:d("input[name='form_data[timeEnd]']",this.contentNode)},{query:d("input.tabStatus",this.contentNode)},{query:d("input[name='form_data[title]']",this.contentNode)}]})},onPopupSubmitSuccess:function(b){"NEW"===this.item_id?this.featureHandles.netnavigation[0].afterItemCreation(b,c.hitch(this,function(){this.reload(b)})):this.reload(b)}})})},"cbtree/models/ItemWriteStoreEX":function(){define("cbtree/models/ItemWriteStoreEX",["dojo/_base/array",
"dojo/_base/lang","dojo/data/ItemFileWriteStore"],function(h,l,d){l.extend(d,{_validated:!1,addReference:function(d,c,e,i){if(!this.isItem(d)||!this.isItem(c))throw Error("ItemWriteStoreEX::addReference(): refItem and/or parentItem is not a valid store item");if(d!==c){var b;c[e]?(b=c[e],this._addReferenceToMap(d,c,e),"number"===typeof i?c[e].splice(i,0,d):c[e].push(d)):(this._addReferenceToMap(d,c,e),c[e]=[d]);this.onSet(c,e,b,c[e]);return!0}throw Error("ItemWriteStoreEX::addReference(): parent and reference items are identical");
},attachToRoot:function(d){this.isRootItem(d)||(d[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(d),this.onRoot(d,"attach"))},detachFromRoot:function(d){this.isRootItem(d)&&(this._removeArrayElement(this._arrayOfTopLevelItems,d),delete d[this._rootItemPropName],this.onRoot(d,"detach"))},getIdentifierAttr:function(){this._loadFinished||this._forceLoad();return this._getIdentifierAttribute()},getParents:function(d){var c=[],e;if(d){if(d=d[this._reverseRefMap]||d["backup_"+this._reverseRefMap])for(e in d)c.push(this._getItemByIdentity(e));
return c}},isRootItem:function(d){this._assertIsItem(d);return d[this._rootItemPropName]?!0:!1},isValidated:function(){return this._validated},itemExist:function(d){var c,e;if("object"!=typeof d&&"undefined"!=typeof d)throw Error("ItemWriteStoreEX::itemExist(): argument is not an object");this._assert(!this._saveInProgress);c=this.getIdentifierAttr();if(c!==Number&&this._itemsByIdentity){d=d[c];if("undefined"===typeof d)throw Error("ItemWriteStoreEX::itemExist(): item has no identity");if(this._pending._deletedItems[d])throw Error("ItemWriteStoreEX::itemExist(): item is pending deletion");
e=this._itemsByIdentity[d]}return e},loadStore:function(d){function c(b,a){var c=a.loadArgs||null,d=c.scope;i.onLoad(b);c&&c.onComplete&&c.onComplete.call(d,b)}var e=d.scope||window.global,i=this;if(this._loadFinished)onComplete&&onComplete.call(e,this._allFileItems.length);else{d={queryOptions:{deep:!0},loadArgs:d,onBegin:c,onError:d.onError,scope:this};try{this.fetch(d)}catch(b){if(onError)onError.call(e,b);else throw b;}}},onDelete:function(d){if(!0===d[this._rootItemPropName])this.onRoot(d,"delete")},
onNew:function(d){if(this.isRootItem(d))this.onRoot(d,"new")},onLoad:function(){},onRoot:function(){},setValidated:function(d){this._validated=Boolean(d)},removeReference:function(d,c,e){if(!this.isItem(d)||!this.isItem(c))throw Error("ItemWriteStoreEX::removeReference(): refItem and/or parentItem is not a valid store item");if(c[e]){this._removeReferenceFromMap(d,c,e);var i=c[e];if(this._removeArrayElement(c[e],d))return this._isEmpty(c[e])&&delete c[e],this.onSet(c,e,i,c[e]),!0}return!1}})})},"cbtree/models/_dndContainer":function(){define("cbtree/models/_dndContainer",
"dojo/aspect,dojo/_base/declare,dojo/dom-class,dojo/_base/event,dojo/_base/lang,dojo/on,dojo/touch".split(","),function(h,l,d,f,c,e,i){return l("dijit.tree._dndContainer",null,{constructor:function(b,k){this.tree=b;this.node=b.domNode;c.mixin(this,k);this.current=null;this.containerState="";d.add(this.node,"dojoDndContainer");this.events=[e(this.node,i.enter,c.hitch(this,"onOverEvent")),e(this.node,i.leave,c.hitch(this,"onOutEvent")),h.after(this.tree,"_onNodeMouseEnter",c.hitch(this,"onMouseOver"),
!0),h.after(this.tree,"_onNodeMouseLeave",c.hitch(this,"onMouseOut"),!0),e(this.node,"dragstart",c.hitch(f,"stop")),e(this.node,"selectstart",c.hitch(f,"stop"))]},destroy:function(){for(var b;b=this.events.pop();)b.remove();this.node=this.parent=null},onMouseOver:function(b){this.current=b},onMouseOut:function(){this.current=null},_changeState:function(b,c){var a="dojoDnd"+b,g=b.toLowerCase()+"State";d.replace(this.node,a+c,a+this[g]);this[g]=c},_addItemClass:function(b,c){d.add(b,"dojoDndItem"+c)},
_removeItemClass:function(b,c){d.remove(b,"dojoDndItem"+c)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"dojo/dnd/Avatar":function(){define("dojo/dnd/Avatar","../_base/declare,../_base/window,../dom,../dom-attr,../dom-class,../dom-construct,../hccss,../query".split(","),function(h,l,d,f,c,e,i,b){return h("dojo.dnd.Avatar",null,{constructor:function(b){this.manager=b;this.construct()},construct:function(){var b=e.create("table",
{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),a=this.manager.source,c,d=e.create("tbody",null,b),h=e.create("tr",null,d),l=e.create("td",null,h),m=Math.min(5,this.manager.nodes.length),n=0;i("highcontrast")&&e.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},l);e.create("span",{innerHTML:a.generateText?this._generateText():""},l);for(f.set(h,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});n<m;++n)a.creator?c=a._normalizedCreator(a.getItem(this.manager.nodes[n].id).data,
"avatar").node:(c=this.manager.nodes[n].cloneNode(!0),"tr"==c.tagName.toLowerCase()&&(h=e.create("table"),e.create("tbody",null,h).appendChild(c),c=h)),c.id="",h=e.create("tr",null,d),l=e.create("td",null,h),l.appendChild(c),f.set(h,{"class":"dojoDndAvatarItem",style:{opacity:(9-n)/10}});this.node=b},destroy:function(){e.destroy(this.node);this.node=!1},update:function(){c.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(i("highcontrast")){var e=d.byId("a11yIcon"),a="+";this.manager.canDropFlag&&
!this.manager.copy?a="< ":!this.manager.canDropFlag&&!this.manager.copy?a="o":this.manager.canDropFlag||(a="x");e.innerHTML=a}b("tr.dojoDndAvatarHeader td span"+(i("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"dijit/form/Button":function(){require({cache:{"url:dijit/form/templates/Button.html":'<span class="dijit dijitReset dijitInline" role="presentation"\n\t><span class="dijitReset dijitInline dijitButtonNode"\n\t\tdata-dojo-attach-event="ondijitclick:_onClick" role="presentation"\n\t\t><span class="dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point="titleNode,focusNode"\n\t\t\trole="button" aria-labelledby="${id}_label"\n\t\t\t><span class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode"></span\n\t\t\t><span class="dijitReset dijitToggleButtonIconChar">&#x25CF;</span\n\t\t\t><span class="dijitReset dijitInline dijitButtonText"\n\t\t\t\tid="${id}_label"\n\t\t\t\tdata-dojo-attach-point="containerNode"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen"\n\t\ttabIndex="-1" role="presentation" data-dojo-attach-point="valueNode"\n/></span>\n'}});
define("dijit/form/Button","require,dojo/_base/declare,dojo/dom-class,dojo/has,dojo/_base/kernel,dojo/_base/lang,dojo/ready,./_FormWidget,./_ButtonMixin,dojo/text!./templates/Button.html".split(","),function(h,l,d,f,c,e,i,b,k,a){f("dijit-legacy-requires")&&i(0,function(){h(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});return l("dijit.form.Button",[b,k],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",
templateString:a,_setValueAttr:"valueNode",_onClick:function(a){var b=this.inherited(arguments);b&&this.valueNode&&(this.valueNode.click(),a.preventDefault(),a.stopPropagation());return b},_fillContent:function(a){if(a&&(!this.params||!("label"in this.params)))if(a=e.trim(a.innerHTML))this.label=a},_setShowLabelAttr:function(a){this.containerNode&&d.toggle(this.containerNode,"dijitDisplayNone",!a);this._set("showLabel",a)},setLabel:function(a){c.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.",
"","2.0");this.set("label",a)},_setLabelAttr:function(a){this.inherited(arguments);if(!this.showLabel&&!("title"in this.params))this.titleNode.title=e.trim(this.containerNode.innerText||this.containerNode.textContent||"")}})})},"cbtree/CheckBox":function(){define("cbtree/CheckBox",["dijit/form/CheckBox","dojo/_base/declare","dojo/_base/event","dojo/dom-attr"],function(h,l,d,f){return l([h],{baseClass:"cbtreeCheckBox",multiState:!0,_getCheckedAttr:function(){return this.checked},_onClick:function(c){return!this.readOnly&&
!this.disabled?(this.toggle(),this.onClick(c)):d.stop(c)},_setCheckedAttr:function(c,d){var i=c,b;if("mixed"!==i||!this.multiState)i=i?!0:!1;b="mixed"==i?i:i?"true":"false";this._set("checked",i);f.set(this.focusNode||this.domNode,"checked",i);(this.focusNode||this.domNode).setAttribute("aria-checked",b);this._handleOnChange(i,d);return i},_setValueAttr:function(c){if("string"==typeof c)this.value=c,f.set(this.focusNode,"value",c)},toggle:function(){var c=this.get("checked");return!this.readOnly&&
!this.disabled?this._setCheckedAttr("mixed"==c?!0:!c):c}})})},"dojo/regexp":function(){define("dojo/regexp",["./_base/kernel","./_base/lang"],function(h,l){var d={};l.setObject("dojo.regexp",d);d.escapeString=function(d,c){return d.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(d){return c&&-1!=c.indexOf(d)?d:"\\"+d})};d.buildGroupRE=function(f,c,e){if(!(f instanceof Array))return c(f);for(var i=[],b=0;b<f.length;b++)i.push(c(f[b]));return d.group(i.join("|"),e)};d.group=function(d,c){return"("+
(c?"?:":"")+d+")"};return d})},"dojo/data/util/simpleFetch":function(){define("dojo/data/util/simpleFetch",["../../_base/lang","../../_base/kernel","./sorter"],function(h,l,d){var f={};h.setObject("dojo.data.util.simpleFetch",f);f.errorHandler=function(c,d){d.onError&&d.onError.call(d.scope||l.global,c,d)};f.fetchHandler=function(c,e){var f=e.abort||null,b=!1,h=e.start?e.start:0,a=e.count&&Infinity!==e.count?h+e.count:c.length;e.abort=function(){b=!0;f&&f.call(e)};var g=e.scope||l.global;if(!e.store)e.store=
this;e.onBegin&&e.onBegin.call(g,c.length,e);e.sort&&c.sort(d.createSortFunction(e.sort,this));if(e.onItem)for(var j=h;j<c.length&&j<a;++j){var p=c[j];b||e.onItem.call(g,p,e)}e.onComplete&&!b&&(j=null,e.onItem||(j=c.slice(h,a)),e.onComplete.call(g,j,e))};f.fetch=function(c){c=c||{};if(!c.store)c.store=this;this._fetchItems(c,h.hitch(this,"fetchHandler"),h.hitch(this,"errorHandler"));return c};return f})},"dijit/form/_CheckBoxMixin":function(){define("dijit/form/_CheckBoxMixin",["dojo/_base/declare",
"dojo/dom-attr","dojo/_base/event"],function(h,l,d){return h("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(d){this._set("readOnly",d);l.set(this.focusNode,"readOnly",d);this.focusNode.setAttribute("aria-readonly",d)},_setLabelAttr:void 0,_getSubmitValue:function(d){return!d&&0!==d?"on":d},_setValueAttr:function(d){d=this._getSubmitValue(d);this._set("value",d);l.set(this.focusNode,"value",d)},reset:function(){this.inherited(arguments);
this._set("value",this.params.value||"on");l.set(this.focusNode,"value",this.value)},_onClick:function(f){return this.readOnly?(d.stop(f),!1):this.inherited(arguments)}})})},"commsy/popups/ToggleStack":function(){define("commsy/popups/ToggleStack","dojo/_base/declare,commsy/WidgetPopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b){return h(l,{constructor:function(){this.module="stack";this.features=[]},onTogglePopup:function(){!0===
this.is_open?(f.add(this.popup_button_node,"tm_stack_hover"),f.remove(this.contentNode,"hidden")):(f.remove(this.popup_button_node,"tm_stack_hover"),f.add(this.contentNode,"hidden"))},setupSpecific:function(){this.loadWidgetsManual(["widgets/StackStack","widgets/StackNew","widgets/StackTagView","widgets/StackBuzzwordView"]).then(b.hitch(this,function(c){dojo.forEach(c,b.hitch(this,function(a,b){0===b?a[1].handle.placeAt(d("div.widgetAreaLeft",this.contentNode)[0]):a[1].handle.placeAt(d("div.widgetAreaRight",
this.contentNode)[0])}))}))}})})},"commsy/popups/ClickTodoPopup":function(){define("commsy/popups/ClickTodoPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on,dojo/topic".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module="todo";this.editType=b.editType;this.contextId=b.contextId;this.features=["editor","tree","upload","netnavigation",
"calendar"];this.registerPopupClick()},setupSpecific:function(){},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(a){a.getInstance();var b=a.getNode().parentNode;i.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",
this.contentNode)},{query:d("input[name='form_data[day_end]']",this.contentNode)},{query:d("input[name='form_data[time_end]']",this.contentNode)},{query:d("input[name='form_data[minutes]']",this.contentNode)},{query:d("select[name='form_data[time_type]']",this.contentNode)},{query:d("select[name='form_data[status]']",this.contentNode)},{query:d("input.tabStatus",this.contentNode)},{query:d("input[name='form_data[title]']",this.contentNode)}]},{contextId:this.contextId})},onPopupSubmitSuccess:function(a){if("NEW"===
this.item_id)this.featureHandles.netnavigation[0].afterItemCreation(a,c.hitch(this,function(){this.contextId?(this.close(),k.publish("newOwnRoomItem",{itemId:a})):this.reload(a)}));else if(this.contextId){this.close();var b=d("a#listItem"+a)[0];b&&b.click()}else this.reload(a)}})})},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(h,l){return h("dijit._Contained",null,{_getSibling:function(d){var f=this.domNode;do f=f[d+"Sibling"];while(f&&1!=f.nodeType);
return f&&l.byNode(f)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var d=this.getParent();return!d||!d.getIndexOfChild?-1:d.getIndexOfChild(this)}})})},"commsy/DivExpander":function(){define("commsy/DivExpander","dojo/_base/declare,commsy/base,dojo/dom-attr,dojo/dom-class,dojo/dom-style,dojo/query,dojo/on,dojo/fx,dojo/_base/lang".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{display:!1,
anim:null,constructor:function(a){a=a||{};h.safeMixin(this,a)},setup:function(a){dojo.forEach(a,k.hitch(this,function(a){var b=a.actor,c=a.div,d=e("> img",b)[0];i(b,"click",k.hitch(this,function(a){this.onEvent(b,c,d);a.preventDefault()}))}))},onEvent:function(a,g,j){j&&("none"===c.get(g,"display")||f.contains(g,"hidden")?(f.contains(g,"hidden")&&(c.set(g,"display","none"),f.remove(g,"hidden")),b.wipeIn({node:g}).play(),d.set(j,"src",this.from_php.template.tpl_path+"img/btn_ci_close.gif")):(b.wipeOut({node:g}).play(),
d.set(j,"src",this.from_php.template.tpl_path+"img/btn_ci_open.gif")))}})})},"dijit/form/CheckBox":function(){require({cache:{"url:dijit/form/templates/CheckBox.html":'<div class="dijit dijitReset dijitInline" role="presentation"\n\t><input\n\t \t${!nameAttrSetting} type="${type}" ${checkedAttrSetting}\n\t\tclass="dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point="focusNode"\n\t \tdata-dojo-attach-event="onclick:_onClick"\n/></div>\n'}});define("dijit/form/CheckBox","require,dojo/_base/declare,dojo/dom-attr,dojo/has,dojo/query,dojo/ready,./ToggleButton,./_CheckBoxMixin,dojo/text!./templates/CheckBox.html,dojo/NodeList-dom".split(","),
function(h,l,d,f,c,e,i,b,k){f("dijit-legacy-requires")&&e(0,function(){h(["dijit/form/RadioButton"])});return l("dijit.form.CheckBox",[i,b],{templateString:k,baseClass:"dijitCheckBox",_setValueAttr:function(a,b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,b)},_getValueAttr:function(){return this.checked?this.value:!1},_setIconClassAttr:null,postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=this.checked?"checked":""},_fillContent:function(){},
_onFocus:function(){this.id&&c("label[for='"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&c("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dijit/tree/_dndSelector","dojo/_base/array,dojo/_base/connect,dojo/_base/declare,dojo/_base/Deferred,dojo/_base/kernel,dojo/_base/lang,dojo/cookie,dojo/mouse,dojo/on,dojo/touch,./_dndContainer".split(","),function(h,l,
d,f,c,e,i,b,k,a,g){return d("dijit.tree._dndSelector",g,{constructor:function(){this.selection={};this.anchor=null;if(!this.cookieName&&this.tree.id)this.cookieName=this.tree.id+"SaveSelectedCookie";this.events.push(k(this.tree.domNode,a.press,e.hitch(this,"onMouseDown")),k(this.tree.domNode,a.release,e.hitch(this,"onMouseUp")),k(this.tree.domNode,a.move,e.hitch(this,"onMouseMove")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);
return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));if(b)this.anchor=a;return a},removeTreeNode:function(a){this.setSelection(this._setDifference(this.getSelectedTreeNodes(),[a]));return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var b=this.getSelectedTreeNodes();h.forEach(this._setDifference(b,a),e.hitch(this,function(a){a.setSelected(!1);
this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));h.forEach(this._setDifference(a,b),e.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){h.forEach(b,function(a){a.__exclude__=!0});var c=h.filter(a,function(a){return!a.__exclude__});h.forEach(b,function(a){delete a.__exclude__});return c},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[],d=[];h.forEach(a,function(a){var g=
a.getTreePath(),e=this.tree.model;c.push(a);b.push(g);g=h.map(g,function(a){return e.getIdentity(a)},this);d.push(g.join("/"))},this);a=h.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null);this.tree.persist&&0<d.length&&i(this.cookieName,d.join(","),{expires:365})},_getSavedPaths:function(){var a=this.tree;
if(a.persist&&a.dndController.cookieName){var b=[];(a=i(a.dndController.cookieName))&&(b=h.map(a.split(","),function(a){return a.split("/")}));return b}},onMouseDown:function(a){if(!(!this.current||this.tree.isExpandoNode(a.target,this.current)||"touchstart"!=a.type&&!b.isLeft(a))){a.preventDefault();var c=this.current,d=l.isCopyKey(a),g=c.id;!this.singular&&!a.shiftKey&&this.selection[g]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(c,d,a.shiftKey))}},onMouseUp:function(a){if(this._doDeselect)this._doDeselect=
!1,this.userSelect(this.current,l.isCopyKey(a),a.shiftKey)},onMouseMove:function(){this._doDeselect=!1},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);var d=doc.createRange();d.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){c=this.anchor;0>this._compareNodes(this.anchor.rowNode,a.rowNode)?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNextNode(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){var b=b||c.global,d;for(d in this.selection)a.call(b,this.getItem(d),d,this)}})})},"dojo/dnd/Source":function(){define("dojo/dnd/Source","../_base/array,../_base/connect,../_base/declare,../_base/kernel,../_base/lang,../dom-class,../dom-geometry,../mouse,../ready,../topic,./common,./Selector,./Manager".split(","),function(h,l,d,f,c,e,i,b,k,a,g,j,p){f.isAsync||k(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var r=d("dojo.dnd.Source",j,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,
selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(b,d){c.mixin(this,c.mixin({},d));var g=this.accept;if(g.length){this.accept={};for(var j=0;j<g.length;++j)this.accept[g[j]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&e.add(this.node,"dojoDndSource");this.targetState="";this.accept&&e.add(this.node,"dojoDndTarget");this.horizontal&&
e.add(this.node,"dojoDndHorizontal");this.topics=[a.subscribe("/dnd/source/over",c.hitch(this,"onDndSourceOver")),a.subscribe("/dnd/start",c.hitch(this,"onDndStart")),a.subscribe("/dnd/drop",c.hitch(this,"onDndDrop")),a.subscribe("/dnd/cancel",c.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,g=!1,e=0;e<d.length;++e)if(d[e]in this.accept){g=!0;break}if(!g)return!1}return!0},copyState:function(a,
b){if(a)return!0;2>arguments.length&&(b=this==p.manager().target);if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){r.superclass.destroy.call(this);h.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){r.superclass.onMouseMove.call(this,a);var b=p.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-
this._lastY)>this.delay)){var c=this.getSelectedNodes();c.length&&b.startDrag(this,c,this.copyState(g.getCopyKeyState(a),!0))}if(this.isDragging){c=!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=i.position(this.current,!0);c=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==i.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||c!=this.before)this._markTargetAnchor(c),b.canDrop(!this.current||
b.source!=this||!(this.current.id in this.selection))}}},onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||!g.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,r.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){if(this.mouseDown)this.mouseDown=!1,r.superclass.onMouseUp.call(this,a)},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=p.manager(),a.canDrop("Disabled"!=
this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,b,c){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?c?"Copied":"Moved":"");this._changeState("Target",this.accept&&this.checkAcceptance(a,b)?"":"Disabled");this==a&&p.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){if(this.targetAnchor)this._unmarkTargetAnchor(),
this.targetAnchor=null;this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,c){var d=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return d.call(this,a.getItem(b.id).data,c)}:c?function(b){var c=a.getItem(b.id),b=b.cloneNode(!0);b.id=g.getUniqueId();return{node:b,data:c.data,type:c.type}}:function(b){var c=
a.getItem(b.id);a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();!c&&!this.creator&&a.selectNone();this.insertNodes(!0,b,this.before,this.current);!c&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=d},onDropInternal:function(a,b){var c=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return c.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id),a=a.cloneNode(!0);
a.id=g.getUniqueId();return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=c}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){r.superclass.onOverEvent.call(this);p.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},
onOutEvent:function(){r.superclass.onOutEvent.call(this);p.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(!(this.current==this.targetAnchor&&this.before==a))this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){if(this.targetAnchor)this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!b.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(e.contains(a,"dojoDndHandle"))return!0;if(e.contains(a,"dojoDndItem")||e.contains(a,"dojoDndIgnore"))break}return!1}});return r})},"dojo/data/ItemFileReadStore":function(){define("dojo/data/ItemFileReadStore",
"../_base/kernel,../_base/lang,../_base/declare,../_base/array,../_base/xhr,../Evented,./util/filter,./util/simpleFetch,../date/stamp".split(","),function(h,l,d,f,c,e,i,b,k){d=d("dojo.data.ItemFileReadStore",[e],{constructor:function(a){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=a.url;this._jsonData=a.data;this.data=null;this._datatypeMap=a.typeMap||{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return k.fromISOString(a)}});
this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];if(void 0!==a.urlPreventCache)this.urlPreventCache=a.urlPreventCache?!0:!1;if(void 0!==a.hierarchical)this.hierarchical=a.hierarchical?!0:!1;if(a.clearOnClose)this.clearOnClose=!0;if("failOk"in a)this.failOk=a.failOk?!0:!1},url:"",_ccUrl:"",data:null,
typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(a,b,c){a=this.getValues(a,b);return 0<a.length?a[0]:c},getValues:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return(a[b]||[]).slice(0)},getAttributes:function(a){this._assertIsItem(a);
var b=[],c;for(c in a)c!==this._storeRefPropName&&c!==this._itemNumPropName&&c!==this._rootItemPropName&&c!==this._reverseRefMap&&b.push(c);return b},hasAttribute:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return b in a},containsValue:function(a,b,c){var d=void 0;"string"===typeof c&&(d=i.patternToRegExp(c,!1));return this._containsValue(a,b,c,d)},_containsValue:function(a,b,c,d){return f.some(this.getValues(a,b),function(a){if(null!==a&&!l.isObject(a)&&d){if(a.toString().match(d))return!0}else if(c===
a)return!0})},isItem:function(a){return a&&a[this._storeRefPropName]===this&&this._arrayOfAllItems[a[this._itemNumPropName]]===a?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){this._assertIsItem(a.item)},getFeatures:function(){return this._features},getLabel:function(a){if(this._labelAttr&&this.isItem(a))return this.getValue(a,this._labelAttr)},getLabelAttributes:function(){return this._labelAttr?[this._labelAttr]:null},filter:function(a,b,c){var d=[],e,f;if(a.query){var h;
e=a.queryOptions?a.queryOptions.ignoreCase:!1;var k={};for(f in a.query)h=a.query[f],"string"===typeof h?k[f]=i.patternToRegExp(h,e):h instanceof RegExp&&(k[f]=h);for(e=0;e<b.length;++e){var l=!0,o=b[e];if(null===o)l=!1;else for(f in a.query)h=a.query[f],this._containsValue(o,f,h,k[f])||(l=!1);l&&d.push(o)}}else for(e=0;e<b.length;++e)f=b[e],null!==f&&d.push(f);c(d,a)},_fetchItems:function(a,b,d){var e=this;if(this._loadFinished)this.filter(a,this._getItemsArray(a.queryOptions),b);else{if(this._jsonFileUrl!==
this._ccUrl)h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl;else if(this.url!==this._ccUrl)this._ccUrl=this._jsonFileUrl=this.url;if(null!=this.data)this._jsonData=this.data,this.data=null;if(this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:l.hitch(e,"filter"),findCallback:l.hitch(e,b)});else{this._loadInProgress=!0;var f=
c.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});f.addCallback(function(c){try{e._getItemsFromLoadedData(c),e._loadFinished=!0,e._loadInProgress=!1,e.filter(a,e._getItemsArray(a.queryOptions),b),e._handleQueuedFetches()}catch(f){e._loadFinished=!0,e._loadInProgress=!1,d(f,a)}});f.addErrback(function(b){e._loadInProgress=!1;d(b,a)});var i=null;if(a.abort)i=a.abort;a.abort=function(){f&&-1===f.fired&&f.cancel();i&&i.call(a)}}else if(this._jsonData)try{this._loadFinished=
!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,e.filter(a,this._getItemsArray(a.queryOptions),b)}catch(k){d(k,a)}else d(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),a)}},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var b=this._queuedFetches[a],c=b.args,d=b.filter,b=b.findCallback;d?d(c,this._getItemsArray(c.queryOptions),b):this.fetchItemByIdentity(c)}this._queuedFetches=
[]}},_getItemsArray:function(a){return a&&a.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress)this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[]},_getItemsFromLoadedData:function(a){function b(a){return null!==a&&"object"===typeof a&&(!l.isArray(a)||d)&&!l.isFunction(a)&&(a.constructor==Object||l.isArray(a))&&"undefined"===
typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&e.hierarchical}function c(a){e._arrayOfAllItems.push(a);for(var d in a){var f=a[d];if(f)if(l.isArray(f))for(var i=0;i<f.length;++i){var h=f[i];b(h)&&c(h)}else b(f)&&c(f)}}var d=!1,e=this;this._labelAttr=a.label;var f,i;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=a.items;for(f=0;f<this._arrayOfTopLevelItems.length;++f)i=this._arrayOfTopLevelItems[f],l.isArray(i)&&(d=!0),c(i),i[this._rootItemPropName]=!0;var h=
{},k;for(f=0;f<this._arrayOfAllItems.length;++f)for(k in i=this._arrayOfAllItems[f],i){if(k!==this._rootItemPropName){var o=i[k];null!==o?l.isArray(o)||(i[k]=[o]):i[k]=[null]}h[k]=k}for(;h[this._storeRefPropName];)this._storeRefPropName+="_";for(;h[this._itemNumPropName];)this._itemNumPropName+="_";for(;h[this._reverseRefMap];)this._reverseRefMap+="_";if(h=a.identifier){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=h;for(f=0;f<this._arrayOfAllItems.length;++f)if(i=this._arrayOfAllItems[f],
a=i[h],a=a[0],Object.hasOwnProperty.call(this._itemsByIdentity,a)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+a+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+a+"]");}else this._itemsByIdentity[a]=i}else this._features["dojo.data.api.Identity"]=
Number;for(f=0;f<this._arrayOfAllItems.length;++f)i=this._arrayOfAllItems[f],i[this._storeRefPropName]=this,i[this._itemNumPropName]=f;for(f=0;f<this._arrayOfAllItems.length;++f)for(k in i=this._arrayOfAllItems[f],i){a=i[k];for(h=0;h<a.length;++h)if(o=a[h],null!==o&&"object"==typeof o){if("_type"in o&&"_value"in o){var u=o._type,s=this._datatypeMap[u];if(s)if(l.isFunction(s))a[h]=new s(o._value);else if(l.isFunction(s.deserialize))a[h]=s.deserialize(o._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");
else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+u+"'");}if(o._reference){o=o._reference;if(l.isObject(o))for(u=0;u<this._arrayOfAllItems.length;++u){var s=this._arrayOfAllItems[u],t=!0,w;for(w in o)s[w]!=o[w]&&(t=!1);t&&(a[h]=s)}else a[h]=this._getItemByIdentity(o);this.referenceIntegrity&&(o=a[h],this.isItem(o)&&this._addReferenceToMap(o,i,k))}else this.isItem(o)&&this.referenceIntegrity&&this._addReferenceToMap(o,i,
k)}}},_addReferenceToMap:function(){},getIdentity:function(a){var b=this._features["dojo.data.api.Identity"];return b===Number?a[this._itemNumPropName]:(a=a[b])?a[0]:null},fetchItemByIdentity:function(a){var b,d;if(this._loadFinished)b=this._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,b));else{var e=this;if(this._jsonFileUrl!==this._ccUrl)h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
this.url=this._ccUrl=this._jsonFileUrl;else if(this.url!==this._ccUrl)this._ccUrl=this._jsonFileUrl=this.url;if(null!=this.data&&null==this._jsonData)this._jsonData=this.data,this.data=null;if(this._jsonFileUrl)this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,d=c.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),d.addCallback(function(c){var d=a.scope?a.scope:h.global;try{e._getItemsFromLoadedData(c),e._loadFinished=
!0,e._loadInProgress=!1,b=e._getItemByIdentity(a.identity),a.onItem&&a.onItem.call(d,b),e._handleQueuedFetches()}catch(f){e._loadInProgress=!1,a.onError&&a.onError.call(d,f)}}),d.addErrback(function(b){e._loadInProgress=!1;a.onError&&a.onError.call(a.scope?a.scope:h.global,b)}));else if(this._jsonData)e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0,b=e._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,b))}},_getItemByIdentity:function(a){var b=
null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,a)&&(b=this._itemsByIdentity[a]):Object.hasOwnProperty.call(this._arrayOfAllItems,a)&&(b=this._arrayOfAllItems[a]);void 0===b&&(b=null);return b},getIdentityAttributes:function(){var a=this._features["dojo.data.api.Identity"];return a===Number?null:[a]},_forceLoad:function(){var a=this;if(this._jsonFileUrl!==this._ccUrl)h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
this.url=this._ccUrl=this._jsonFileUrl;else if(this.url!==this._ccUrl)this._ccUrl=this._jsonFileUrl=this.url;if(null!=this.data)this._jsonData=this.data,this.data=null;if(this._jsonFileUrl){var b=c.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});b.addCallback(function(b){try{if(!0!==a._loadInProgress&&!a._loadFinished)a._getItemsFromLoadedData(b),a._loadFinished=!0;else if(a._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");
}catch(c){throw c;}});b.addErrback(function(a){throw a;})}else if(this._jsonData)a._getItemsFromLoadedData(a._jsonData),a._jsonData=null,a._loadFinished=!0}});l.extend(d,b);return d})},"dojo/data/util/filter":function(){define("dojo/data/util/filter",["../../_base/lang"],function(h){var l={};h.setObject("dojo.data.util.filter",l);l.patternToRegExp=function(d,f){for(var c="^",e=null,i=0;i<d.length;i++)switch(e=d.charAt(i),e){case "\\":c+=e;i++;c+=d.charAt(i);break;case "*":c+=".*";break;case "?":c+=
".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":c+="\\";default:c+=e}c+="$";return f?RegExp(c,"mi"):RegExp(c,"m")};return l})},"commsy/popups/ClickMaterialPopup":function(){define("commsy/popups/ClickMaterialPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on,dojo/topic".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(){},
init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module="material";this.editType=b.editType;this.version_id=b.vid;this.contextId=b.contextId;this.features=["editor","tree","upload","netnavigation","calendar"];this.registerPopupClick()},setupSpecific:function(){var a=d("select#bibliographic_select",this.contentNode)[0];a&&(this.showHideBibliographic(a),b(a,"change",c.hitch(this,function(){this.showHideBibliographic(a)})))},onPopupSubmit:function(a){dojo.forEach(this.featureHandles.editor,
function(a){a.getInstance();var b=a.getNode().parentNode;i.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});var b={tabs:[{id:"rights_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"},{id:"workflow_tab"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",this.contentNode)},{query:d("input[name='form_data[title]']",this.contentNode)},
{query:d("input.tabStatus",this.contentNode)},{query:d("select#bibliographic_select",this.contentNode)}]};dojo.forEach(d("div#bibliographic div[id^='bib_content_']",this.contentNode),function(a){if(!f.contains(a,"hidden"))return a=i.get(a,"id"),b.nodeLists.push({query:d("div#"+a,this.contentNode)}),!1});this.submit(b,{part:a.part,version_id:this.version_id,contextId:this.contextId})},onPopupSubmitSuccess:function(a){if("NEW"===this.item_id)this.featureHandles.netnavigation[0].afterItemCreation(a,
c.hitch(this,function(){this.contextId?(this.close(),k.publish("newOwnRoomItem",{itemId:a})):this.reload(a)}));else if(this.contextId){this.close();var b=d("a#listItem"+a)[0];b&&b.click()}else"undefined"!=typeof this.version_id?this.reload(a+"&version_id="+this.version_id):this.reload(a)},showHideBibliographic:function(a){var b=i.get(a,"value");dojo.forEach(d("div#bibliographic div[id^='bib_content_']",this.contentNode),function(a){i.get(a,"id")==="bib_content_"+b?f.remove(a,"hidden"):f.add(a,"hidden")})}})})},
"dojo/data/util/sorter":function(){define("dojo/data/util/sorter",["../../_base/lang"],function(h){var l={};h.setObject("dojo.data.util.sorter",l);l.basicComparator=function(d,f){var c=-1;null===d&&(d=void 0);null===f&&(f=void 0);if(d==f)c=0;else if(d>f||null==d)c=1;return c};l.createSortFunction=function(d,f){function c(a,b,c,d){return function(e,g){var f=d.getValue(e,a),j=d.getValue(g,a);return b*c(f,j)}}for(var e=[],i,b=f.comparatorMap,h=l.basicComparator,a=0;a<d.length;a++){i=d[a];var g=i.attribute;
if(g){i=i.descending?-1:1;var j=h;b&&("string"!==typeof g&&"toString"in g&&(g=g.toString()),j=b[g]||h);e.push(c(g,i,j,f))}}return function(a,b){for(var c=0;c<e.length;){var d=e[c++](a,b);if(0!==d)return d}return 0}};return l})},"dijit/form/_ButtonMixin":function(){define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/_base/event","../registry"],function(h,l,d,f){return h("dijit.form._ButtonMixin",null,{label:"",type:"button",_onClick:function(c){if(this.disabled)return d.stop(c),
!1;var e=!1===this.onClick(c);if(!e&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var i=this.domNode;i.parentNode;i=i.parentNode){var b=f.byNode(i);if(b&&"function"==typeof b._onSubmit){b._onSubmit(c);e=!0;break}}e&&c.preventDefault();return!e},postCreate:function(){this.inherited(arguments);l.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(c){this._set("label",c);(this.containerNode||this.focusNode).innerHTML=c}})})},"dijit/tree/_dndContainer":function(){define("dijit/tree/_dndContainer",
"dojo/aspect,dojo/_base/declare,dojo/dom-class,dojo/_base/event,dojo/_base/lang,dojo/on,dojo/touch".split(","),function(h,l,d,f,c,e,i){return l("dijit.tree._dndContainer",null,{constructor:function(b,k){this.tree=b;this.node=b.domNode;c.mixin(this,k);this.current=null;this.containerState="";d.add(this.node,"dojoDndContainer");this.events=[e(this.node,i.enter,c.hitch(this,"onOverEvent")),e(this.node,i.leave,c.hitch(this,"onOutEvent")),h.after(this.tree,"_onNodeMouseEnter",c.hitch(this,"onMouseOver"),
!0),h.after(this.tree,"_onNodeMouseLeave",c.hitch(this,"onMouseOut"),!0),e(this.node,"dragstart",c.hitch(f,"stop")),e(this.node,"selectstart",c.hitch(f,"stop"))]},destroy:function(){for(var b;b=this.events.pop();)b.remove();this.node=this.parent=null},onMouseOver:function(b){this.current=b},onMouseOut:function(){this.current=null},_changeState:function(b,c){var a="dojoDnd"+b,e=b.toLowerCase()+"State";d.replace(this.node,a+c,a+this[e]);this[e]=c},_addItemClass:function(b,c){d.add(b,"dojoDndItem"+c)},
_removeItemClass:function(b,c){d.remove(b,"dojoDndItem"+c)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"dijit/form/_FormWidget":function(){define("dijit/form/_FormWidget","dojo/_base/declare,dojo/has,dojo/_base/kernel,dojo/ready,../_Widget,../_CssStateMixin,../_TemplatedMixin,./_FormWidgetMixin".split(","),function(h,l,d,f,c,e,i,b){l("dijit-legacy-requires")&&f(0,function(){require(["dijit/form/_FormValueWidget"])});
return h("dijit.form._FormWidget",[c,i,e,b],{setDisabled:function(b){d.deprecated("setDisabled("+b+") is deprecated. Use set('disabled',"+b+") instead.","","2.0");this.set("disabled",b)},setValue:function(b){d.deprecated("dijit.form._FormWidget:setValue("+b+") is deprecated.  Use set('value',"+b+") instead.","","2.0");this.set("value",b)},getValue:function(){d.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=
this.name?'name="'+this.name.replace(/"/g,"&quot;")+'"':"";this.inherited(arguments)},_setTypeAttr:null})})},"dojo/DeferredList":function(){define("dojo/DeferredList",["./_base/kernel","./_base/Deferred","./_base/array"],function(h,l,d){h.DeferredList=function(f,c,e,i){var b=[];l.call(this);var h=this;0===f.length&&!c&&this.resolve([0,[]]);var a=0;d.forEach(f,function(d,j){function l(c,d){b[j]=[c,d];a++;a===f.length&&h.resolve(b)}d.then(function(a){c?h.resolve([j,a]):l(!0,a)},function(a){e?h.reject(a):
l(!1,a);if(i)return null;throw a;})})};h.DeferredList.prototype=new l;h.DeferredList.prototype.gatherResults=function(f){f=new h.DeferredList(f,!1,!0,!1);f.addCallback(function(c){var e=[];d.forEach(c,function(c){e.push(c[1])});return e});return f};return h.DeferredList})},"commsy/WidgetPopupHandler":function(){define("commsy/WidgetPopupHandler","dojo/_base/declare,commsy/TogglePopupHandler,dojo/query,dojo/dom-class,dojo/dom-attr,dojo/dom-construct,dojo/on,dojo/_base/lang,dojo/_base/Deferred,dojo/DeferredList".split(","),
function(h,l,d,f,c,e,i,b,k,a){return h(l,{widgetArray:[],widgetHandles:[],constructor:function(a,b){this.popup_button_node=a;this.contentNode=b;this.widgetArray=[];this.widgetHandles=[];this.defWidgets=null;this.registerPopupClick()},setupSpecific:function(){this.AJAXRequest("widgets","get"+this.ucFirst(this.module)+"Configuration",{},b.hitch(this,function(a){this.widgetArray=this.widgetArray.concat(a.displayConfig);this.loadWidgets()}))},loadWidgets:function(){dojo.forEach(this.widgetArray,b.hitch(this,
function(a){var a=a.split("_"),b="widgets/"+this.ucFirst(this.module)+this.ucFirst(a[1]);a[3]&&"preferences"==a[3]&&(b+="Preferences");this.loadWidget(b)}))},loadWidgetsManual:function(c){var d=[];dojo.forEach(c,b.hitch(this,function(a){d.push(this.loadWidget(a))}));return new a(d)},loadWidget:function(a,c){var c=c||{},d=new k;require(["commsy/"+a],b.hitch(this,function(e){this.AJAXRequest("widgets","getHTMLForWidget",{widgetPath:a},b.hitch(this,function(b){b={templateString:b,widgetHandler:this};
h.safeMixin(b,c);b=new e(b);b.startup();this.widgetHandles.push({path:a,handler:b});d.resolve({handle:b})}))}));return d},getWidget:function(a){return dojo.filter(this.widgetHandles,function(b){return b.path==a})[0].handler||null},onPopupSubmit:function(){},onPopupSubmitSuccess:function(){}})})},"commsy/TogglePopupHandler":function(){define("commsy/TogglePopupHandler","dojo/_base/declare,commsy/PopupHandler,dojo/on,dojo/topic,dojo/_base/lang,dojo/query,dojo/dom-class,dojo/dom-construct,dojo/dom-attr".split(","),
function(h,l,d,f,c,e,i,b){return h(l,{is_loaded:!1,is_open:!1,popup_button_node:null,statics:{togglePopups:[]},constructor:function(){this.fct="popup"},registerPopupClick:function(){d(this.popup_button_node,"click",c.hitch(this,function(b){this.open();b.preventDefault()}))},open:function(){if(!1===this.is_loaded)this.setupLoading(),this.statics.togglePopups.push(this),this.AJAXRequest("popup","getHTML",{module:this.module},c.hitch(this,function(f){b.place(f,this.contentNode,"last");this.setupTabs();
this.setupFeatures();this.setupSpecific();this.onCreate();d(e("a",this.contentNode)[0],"click",c.hitch(this,function(a){this.close();a.preventDefault()}));d(e("input.submit",this.contentNode),"click",c.hitch(this,function(a){this.onPopupSubmit(this.getAttrAsObject(a.target,"data-custom"));a.preventDefault()}));this.destroyLoading()})),this.is_loaded=!0;(this.is_open=!this.is_open)&&dojo.forEach(this.statics.togglePopups,c.hitch(this,function(b){if(b!==this)b.close(),b.is_open=!1}));this.onTogglePopup()},
close:function(){this.inherited(arguments);this.onTogglePopup()}})})},"commsy/popups/ClickBuzzwordsPopup":function(){define("commsy/popups/ClickBuzzwordsPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/dom-style,dojo/on,dojo/topic,dojo/NodeList-traverse".split(","),function(h,l,d,f,c,e,i,b,k,a){return h(l,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.module="buzzwords";this.list=null;this.features=
[];this.contextId=b.contextId;this.registerPopupClick()},setupSpecific:function(){var b=d("select#buzzword_merge_one")[0],e=d("select#buzzword_merge_two")[0];k(b,"change",c.hitch(this,function(a){this.enableAllOptionsExceptOne(e,i.get(a.target,"value"))}));k(e,"change",c.hitch(this,function(a){this.enableAllOptionsExceptOne(b,i.get(a.target,"value"))}));require(["commsy/List"],c.hitch(this,function(a){this.list=new a;this.list.init(this.cid,this.from_php.template.tpl_path,{activatorNode:d("a.list_activator")[0],
module:"buzzwords",roomId:this.contextId,OnInitDone:c.hitch(this,function(){this.list.performRequest()})});if(a=d("div#edit_tab input.buzzword_change_name:first-child")[0])this.list.requestData.item_id=i.get(a,"id"),this.list.requestData.contextId=this.contextId}));dojo.forEach(d("input.buzzword_attach"),c.hitch(this,function(a){k(a,"click",c.hitch(this,function(){var b=i.get(a,"name");this.list.requestData.item_id=b.substr(10,b.length-11);this.list.requestData.contextId=this.contextId;this.list.performRequest();
b=i.get((new dojo.NodeList(a)).siblings("input.buzzword_change_name")[0],"value");i.set(d("div.open_close_head span.text_important")[0],"innerHTML","&bdquo;"+b+"&rdquo;")}))}));dojo.forEach(d("input.buzzword_change"),c.hitch(this,function(b){k(b,"click",c.hitch(this,function(){var e=i.get(b,"name"),f=e.substr(10,e.length-11),g=i.get((new dojo.NodeList(b)).siblings("input.buzzword_change_name")[0],"value");this.AJAXRequest("buzzwords","updateBuzzword",{buzzword_id:f,buzzword:g},c.hitch(this,function(){this.list.requestData.item_id===
f&&(i.set(d("div.open_close_head span.text_important")[0],"innerHTML","&bdquo;"+g+"&rdquo;"),this.contextId&&a.publish("newOwnRoomBuzzword",{}))}),c.hitch(this,function(){}))}))}));dojo.forEach(d("input.buzzword_delete"),c.hitch(this,function(b){k(b,"click",c.hitch(this,function(){var d=i.get(b,"name"),d=d.substr(10,d.length-11),e=i.get((new dojo.NodeList(b)).siblings("input.buzzword_change_name")[0],"value");this.AJAXRequest("buzzwords","deleteBuzzword",{buzzword_id:d},c.hitch(this,function(){this.removeBuzzwordFromLists(e);
this.removeBuzzwordFromMergeSelects(e);this.removeBuzzwordFromEditTab(e);this.contextId&&a.publish("newOwnRoomBuzzword",{})}),c.hitch(this,function(){}))}))}))},enableAllOptionsExceptOne:function(a,b){var e=d("option",a);dojo.forEach(e,c.hitch(this,function(a){i.get(a,"value")===b?i.set(a,"disabled","disabled"):i.has(a,"disabled")&&i.remove(a,"disabled")}));if(i.get(a,"value")===b){var f=!1;dojo.some(e,c.hitch(this,function(c){if(f)return!1;c=i.get(c,"value");c!==b&&(i.set(a,"value",c),f=!0)}))}},
onPopupSubmit:function(a){a=a.part;"add"===a?this.OnAddNewBuzzword():"merge"==a&&this.OnMergeBuzzwords()},addBuzzwordToLists:function(a){dojo.forEach(d("ul.popup_buzzword_list"),c.hitch(this,function(b){b=d("div.clear",b)[0];e.create("li",{className:"ui-state-default popup_buzzword_item",innerHTML:a},b,"before")}))},removeBuzzwordFromLists:function(a){dojo.forEach(d("li.popup_buzzword_item"),c.hitch(this,function(b){i.get(b,"innerHTML")===a&&e.destroy(b)}))},addBuzzwordToMergeSelects:function(a,b){var c=
d("select#buzzword_merge_one")[0],f=d("select#buzzword_merge_two")[0];e.create("option",{value:a,innerHTML:b},c,"last");e.create("option",{value:a,innerHTML:b},f,"last")},removeBuzzwordFromMergeSelects:function(a){var b=d("select#buzzword_merge_one option, select#buzzword_merge_two option");dojo.forEach(b,c.hitch(this,function(b){i.get(b,"innerHTML")===a&&e.destroy(b)}))},addBuzzwordToEditTab:function(a,b){var c=d("div#edit_tab div#content_row_one")[0],c=e.create("div",{className:"input_row"},c,"last");
e.create("input",{className:"buzzword_change_name size_200",type:"text",value:b},c,"last");e.create("input",{className:"popup_button buzzword_change mandatory",type:"button",value:"\u00c4ndern",name:"form_data["+a+"]"},c,"last");e.create("input",{className:"popup_button buzzword_attach",type:"button",value:"Eintr\u00e4ge zuordnen",name:"form_data["+a+"]"},c,"last");e.create("input",{className:"popup_button buzzword_delete",type:"button",value:"L\u00f6schen",name:"form_data["+a+"]"},c,"last")},removeBuzzwordFromEditTab:function(a){dojo.forEach(d("input.buzzword_change_name"),
c.hitch(this,function(b){if(b.value==a)return b=(new dojo.NodeList(b)).parents("div.input_row")[0],e.destroy(b),!0}))},OnAddNewBuzzword:function(){var e=c.trim(i.get(d("input#buzzword_create_name")[0],"value"));""!==e&&this.AJAXRequest("buzzwords","createNewBuzzword",{buzzword:e,roomId:this.contextId},c.hitch(this,function(b){this.addBuzzwordToLists(e);this.addBuzzwordToMergeSelects(b.id,e);this.addBuzzwordToEditTab(b.id,e);this.destroyLoading();this.contextId&&a.publish("newOwnRoomBuzzword",{})}),
c.hitch(this,function(a){"107"==a.code&&dojo.forEach(d("li.popup_buzzword_item"),c.hitch(this,function(a){var c=i.get(a,"innerHTML");b.set(a,"color",c===e?"red":"#393939")}));this.destroyLoading()}))},OnMergeBuzzwords:function(){var b=i.get(d("select#buzzword_merge_one")[0],"value"),e=i.get(d("select#buzzword_merge_two")[0],"value");b!==e&&this.AJAXRequest("buzzwords","mergeBuzzwords",{idOne:b,idTwo:e},c.hitch(this,function(c){this.removeBuzzwordFromLists(c.buzzwordOne);this.removeBuzzwordFromLists(c.buzzwordTwo);
this.addBuzzwordToLists(c.newBuzzword);this.removeBuzzwordFromMergeSelects(c.buzzwordOne);this.removeBuzzwordFromMergeSelects(c.buzzwordTwo);this.addBuzzwordToMergeSelects(b,c.newBuzzword);this.destroyLoading();this.contextId&&a.publish("newOwnRoomBuzzword",{})}),c.hitch(this,function(){this.destroyLoading()}))},onPopupSubmitSuccess:function(){}})})},"commsy/popups/ClickDiscussionPopup":function(){define("commsy/popups/ClickDiscussionPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on,dojo/topic".split(","),
function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module="discussion";this.editType=b.editType;this.contextId=b.contextId;this.features=["editor","tree","upload","netnavigation","calendar"];this.registerPopupClick()},setupSpecific:function(){},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(a){a.getInstance();var b=a.getNode().parentNode;i.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});
this.submit({tabs:[{id:"rights_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",this.contentNode)},{query:d("input[name='form_data[discussion_type]']",this.contentNode)},{query:d("input[name='form_data[subject]']",this.contentNode)},{query:d("input.tabStatus",this.contentNode)},{query:d("input[name='form_data[title]']",
this.contentNode)}]},{contextId:this.contextId})},onPopupSubmitSuccess:function(a){if("NEW"===this.item_id)this.featureHandles.netnavigation[0].afterItemCreation(a,c.hitch(this,function(){this.contextId?(this.close(),k.publish("newOwnRoomItem",{itemId:a})):this.reload(a)}));else if(this.contextId){this.close();var b=d("a#listItem"+a)[0];b&&b.click()}else this.reload(a)}})})},"commsy/popups/ClickTagsPopup":function(){define("commsy/popups/ClickTagsPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/dom-style,dojo/on,dojo/NodeList-traverse".split(","),
function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.module="tags";this.tree=null;this.features=[];this.contextId=b.contextId;this.registerPopupClick()},setupSpecific:function(){require(["commsy/EditTree"],c.hitch(this,function(a){this.tree=new a({followUrl:!1,checkboxes:!1,room_id:this.contextId,expanded:!1,item_id:this.item_id});this.tree.setupTree(d("div.tree",this.contentNode)[0],c.hitch(this,function(a){k(a.tree,"open",c.hitch(this,function(){this.tree.addCreateAndRenameToAllLabels()}))}))}));
var a=d("select#tag_merge_one")[0],b=d("select#tag_merge_two")[0];k(a,"change",c.hitch(this,function(a){this.enableAllOptionsExceptOne(b,i.get(a.target,"value"))}));k(b,"change",c.hitch(this,function(b){this.enableAllOptionsExceptOne(a,i.get(b.target,"value"))}));require(["commsy/List"],c.hitch(this,function(a){this.list=new a;this.list.init(this.cid,this.from_php.template.tpl_path,{activatorNode:d("a.list_activator")[0],module:"tags",roomId:this.contextId,OnInitDone:c.hitch(this,function(){this.list.performRequest()})});
if(a=d("div#attach_tab input.tag_attach")[0])this.list.requestData.item_id=i.get(a,"id"),this.list.requestData.contextId=this.contextId}));dojo.forEach(d("input.tag_attach"),c.hitch(this,function(a){k(a,"click",c.hitch(this,function(){var b=i.get(a,"name");this.list.requestData.item_id=b.substr(10,b.length-11);this.list.requestData.contextId=this.contextId;this.list.performRequest();b=i.get((new dojo.NodeList(a)).siblings("label")[0],"innerHTML");i.set(d("div.open_close_head span.text_important")[0],
"innerHTML","&bdquo;"+b+"&rdquo;")}))}))},enableAllOptionsExceptOne:function(a,b){var e=d("option",a);dojo.forEach(e,c.hitch(this,function(a){i.get(a,"value")===b?i.set(a,"disabled","disabled"):i.has(a,"disabled")&&i.remove(a,"disabled")}));if(i.get(a,"value")===b){var f=!1;dojo.some(e,c.hitch(this,function(c){if(f)return!1;c=i.get(c,"value");c!==b&&(i.set(a,"value",c),f=!0)}))}},addTagToLists:function(a){dojo.forEach(d("ul.popup_tag_list"),c.hitch(this,function(b){b=d("div.clear",b)[0];e.create("li",
{className:"ui-state-default popup_buzzword_item",innerHTML:a},b,"before")}))},removeTagFromLists:function(a){dojo.forEach(d("li.popup_tag_item"),c.hitch(this,function(b){i.get(b,"innerHTML")===a&&e.destroy(b)}))},addTagToMergeSelects:function(a,b){var c=d("select#tag_merge_one")[0],f=d("select#tag_merge_two")[0];e.create("option",{value:a,innerHTML:b},c,"last");e.create("option",{value:a,innerHTML:b},f,"last")},removeTagFromMergeSelects:function(a){var b=d("select#tag_merge_one option, select#tag_merge_two option");
dojo.forEach(b,c.hitch(this,function(b){i.get(b,"innerHTML")===a&&e.destroy(b)}))},onPopupSubmit:function(a){a=a.part;if("sort_abc"===a)this.onSortABC();else if("merge"==a)this.onMergeTags()},onSortABC:function(){this.AJAXRequest("tags","sortABC",{roomId:this.contextId},c.hitch(this,function(){this.close()}))},onMergeTags:function(){var a=i.get(d("select#tag_merge_one")[0],"value"),b=i.get(d("select#tag_merge_two")[0],"value");a!==b&&this.AJAXRequest("tags","mergeTags",{idOne:a,idTwo:b},c.hitch(this,
function(){this.close()}),c.hitch(this,function(){}))},onPopupSubmitSuccess:function(){location.reload()}})})},"dijit/form/_ToggleButtonMixin":function(){define("dijit/form/_ToggleButtonMixin",["dojo/_base/declare","dojo/dom-attr"],function(h,l){return h("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(d){var f=this.checked;this._set("checked",!f);var c=this.inherited(arguments);this.set("checked",c?this.checked:f);return c},_setCheckedAttr:function(d,f){this._set("checked",
d);l.set(this.focusNode||this.domNode,"checked",d);(this.focusNode||this.domNode).setAttribute(this._aria_attr,d?"true":"false");this._handleOnChange(d,f)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dojo/dnd/Container":function(){define("dojo/dnd/Container","../_base/array,../_base/declare,../_base/event,../_base/kernel,../_base/lang,../_base/window,../dom,../dom-class,../dom-construct,../Evented,../has,../on,../query,../ready,../touch,./common".split(","),
function(h,l,d,f,c,e,i,b,k,a,g,j,p,r,m,n){l=l("dojo.dnd.Container",a,{skipForm:!1,allowNested:!1,constructor:function(a,d){this.node=i.byId(a);d||(d={});this.creator=d.creator||null;this.skipForm=d.skipForm;this.parent=d.dropParent&&i.byId(d.dropParent);this.map={};this.current=null;this.containerState="";b.add(this.node,"dojoDndContainer");(!d||!d._skipStartup)&&this.startup();this.events=[j(this.node,m.over,c.hitch(this,"onMouseOver")),j(this.node,m.out,c.hitch(this,"onMouseOut")),j(this.node,"dragstart",
c.hitch(this,"onSelectStart")),j(this.node,"selectstart",c.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,b){var b=b||f.global,c=this.map,d=n._empty,e;for(e in c)e in d||a.call(b,c[e],e,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return p((this.allowNested?"":"> ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=
this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=n.getUniqueId();var c=b.getAttribute("dndType"),d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){if(this.parent.firstChild)if(b){if(!c)c=this.parent.firstChild}else{if(c)c=c.nextSibling}else c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,
c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);return this},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");
if(a&&a.length)this.parent=a[0]}this.defaultCreator=n._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&!(b==this.node);)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);if(this.current!=b)this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=
null}}if(this.current)this._removeItemClass(this.current,"Over"),this.current=null;this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){(!this.skipForm||!n.isFormElement(a))&&d.stop(a)},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,c){var d="dojoDnd"+a,e=a.toLowerCase()+"State";b.replace(this.node,d+c,d+this[e]);this[e]=c},_addItemClass:function(a,c){b.add(a,"dojoDndItem"+c)},_removeItemClass:function(a,c){b.remove(a,"dojoDndItem"+c)},_getChildByEvent:function(a){if(a=
a.target)for(var c=a.parentNode;c;a=c,c=a.parentNode)if((c==this.parent||this.allowNested)&&b.contains(a,"dojoDndItem"))return a;return null},_normalizedCreator:function(a,d){var e=(this.creator||this.defaultCreator).call(this,a,d);if(!c.isArray(e.type))e.type=["text"];if(!e.node.id)e.node.id=n.getUniqueId();b.add(e.node,"dojoDndItem");return e}});n._createNode=function(a){return!a?n._createSpan:function(b){return k.create(a,{innerHTML:b})}};n._createTrTd=function(a){var b=k.create("tr");k.create("td",
{innerHTML:a},b);return b};n._createSpan=function(a){return k.create("span",{innerHTML:a})};n._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};n._defaultCreator=function(a){var a=a.tagName.toLowerCase(),b="tbody"==a||"thead"==a?n._createTrTd:n._createNode(n._defaultCreatorNodes[a]);return function(a,d){var e=a&&c.isObject(a),f,g;e&&a.tagName&&a.nodeType&&a.getAttribute?(f=a.getAttribute("dndData")||a.innerHTML,e=(e=a.getAttribute("dndType"))?e.split(/\s*,\s*/):["text"],g=a):(f=e&&a.data?a.data:
a,e=e&&a.type?a.type:["text"],g=("avatar"==d?n._createSpan:b)(""+f));if(!g.id)g.id=n.getUniqueId();return{node:g,data:f,type:e}}};return l})},"commsy/popups/ClickGroupPopup":function(){define("commsy/popups/ClickGroupPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on".split(","),function(h,l,d,f,c,e,i){return h(l,{sendImages:[],constructor:function(){this.sendImages=[]},init:function(b,c){this.triggerNode=b;this.item_id=
c.iid;this.module="group";this.editType=c.editType;this.features=["editor","upload","netnavigation","calendar","upload-single"];this.registerPopupClick()},setupSpecific:function(){dojo.ready(c.hitch(this,function(){this.featureHandles["upload-single"][0].setCallback(c.hitch(this,function(b){var c=d("div.filePreview",this.featureHandles["upload-single"][0].uploader.form)[0];e.empty(c);e.create("img",{src:"commsy.php?cid="+this.uri_object.cid+"&mod=picture&fct=getTemp&fileName="+b.file},c,"last");this.sendImages.push({part:"upload_picture",
fileInfo:b})}))}))},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(b){b.getInstance();var c=b.getNode().parentNode;i.set(d("input[type='hidden']",c)[0],"value",b.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"},{id:"grouproom_tab"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("div#popup_content",this.contentNode)}]})},onPopupSubmitSuccess:function(b){if(0<this.sendImages.length)var d=
{module:"group",additional:{action:this.sendImages[0].part,fileInfo:this.sendImages[0].fileInfo,iid:b}};"NEW"===this.item_id?this.featureHandles.netnavigation[0].afterItemCreation(b,c.hitch(this,function(){0<this.sendImages.length?this.AJAXRequest("popup","save",d,c.hitch(this,function(){this.reload(b)})):this.reload(b)})):0<this.sendImages.length?this.AJAXRequest("popup","save",d,c.hitch(this,function(){this.reload(b)})):this.reload(b)}})})},"commsy/popups/ClickMailtomodPopup":function(){define("commsy/popups/ClickMailtomodPopup",
"dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on".split(","),function(h,l,d){return h(l,{constructor:function(){},init:function(d,c){this.triggerNode=d;this.item_id=c.iid;this.module="mailtomod";this.editType=c.mailType;this.features=[];this.registerPopupClick()},setupSpecific:function(){},onPopupSubmit:function(){this.submit({tabs:[],nodeLists:[{query:d("div#reciever",this.contentNode),group:"reciever"},{query:d("textarea[name='form_data[mailcontent]']",
this.contentNode)},{query:d("input[name='form_data[subject]']",this.contentNode)}]})},onPopupSubmitSuccess:function(){this.close()}})})},"commsy/popups/ClickDatePopup":function(){define("commsy/popups/ClickDatePopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on,dojo/topic".split(","),function(h,l,d,f,c,e,i,b,k){return h(l,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module=
"date";this.editType=b.editType;this.contextId=b.contextId;this.date_new=b.date_new;this.features=["editor","tree","upload","netnavigation","calendar"];this.registerPopupClick()},setupSpecific:function(){var a=d("select[name='form_data[recurring_select]']")[0],e=d("div[id^='recurring_details_']");a&&b(a,"change",c.hitch(this,function(){var b=i.get(a,"value");dojo.forEach(e,c.hitch(this,function(a){f.add(a,"hidden")}));f.remove(d("div#recurring_details_"+b)[0],"hidden")}))},onPopupSubmit:function(a){dojo.forEach(this.featureHandles.editor,
function(a){a.getInstance();var b=a.getNode().parentNode;i.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"},{id:"addon_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#files_finished",this.contentNode),group:"files"},{query:d("input[name='form_data[description]']",this.contentNode)},{query:d("input[name='form_data[dayStart]']",this.contentNode)},
{query:d("input[name='form_data[timeStart]']",this.contentNode)},{query:d("input[name='form_data[dayEnd]']",this.contentNode)},{query:d("input[name='form_data[timeEnd]']",this.contentNode)},{query:d("input[name='form_data[place]']",this.contentNode)},{query:d("input.tabStatus",this.contentNode)},{query:d("input[name='form_data[title]']",this.contentNode)}]},{part:a.part,contextId:this.contextId})},onPopupSubmitSuccess:function(a){if("NEW"===this.item_id)this.featureHandles.netnavigation[0].afterItemCreation(a,
c.hitch(this,function(){this.contextId?(this.close(),k.publish("newOwnRoomItem",{itemId:a})):this.reload(a)}));else if(this.contextId){this.close();var b=d("a#listItem"+a)[0];b&&b.click()}else this.reload(a)}})})},"dijit/Tree":function(){require({cache:{"url:dijit/templates/TreeNode.html":'<div class="dijitTreeNode" role="presentation"\n\t><div data-dojo-attach-point="rowNode" class="dijitTreeRow dijitInline" role="presentation"\n\t\t><div data-dojo-attach-point="indentNode" class="dijitInline"></div\n\t\t><img src="${_blankGif}" alt="" data-dojo-attach-point="expandoNode" class="dijitTreeExpando" role="presentation"\n\t\t/><span data-dojo-attach-point="expandoNodeText" class="dijitExpandoText" role="presentation"\n\t\t></span\n\t\t><span data-dojo-attach-point="contentNode"\n\t\t\tclass="dijitTreeContent" role="presentation">\n\t\t\t<img src="${_blankGif}" alt="" data-dojo-attach-point="iconNode" class="dijitIcon dijitTreeIcon" role="presentation"\n\t\t\t/><span data-dojo-attach-point="labelNode" class="dijitTreeLabel" role="treeitem" tabindex="-1" aria-selected="false"></span>\n\t\t</span\n\t></div>\n\t<div data-dojo-attach-point="containerNode" class="dijitTreeContainer" role="presentation" style="display: none;"></div>\n</div>\n',
"url:dijit/templates/Tree.html":'<div class="dijitTree dijitTreeContainer" role="tree">\n\t<div class="dijitInline dijitTreeIndent" style="position: absolute; top: -9999px" data-dojo-attach-point="indentDetector"></div>\n</div>\n'}});define("dijit/Tree","dojo/_base/array,dojo/_base/connect,dojo/cookie,dojo/_base/declare,dojo/Deferred,dojo/DeferredList,dojo/dom,dojo/dom-class,dojo/dom-geometry,dojo/dom-style,dojo/_base/event,dojo/errors/create,dojo/fx,dojo/_base/kernel,dojo/keys,dojo/_base/lang,dojo/on,dojo/topic,dojo/touch,dojo/when,./focus,./registry,./_base/manager,./_Widget,./_TemplatedMixin,./_Container,./_Contained,./_CssStateMixin,dojo/text!./templates/TreeNode.html,dojo/text!./templates/Tree.html,./tree/TreeStoreModel,./tree/ForestStoreModel,./tree/_dndSelector".split(","),
function(h,l,d,f,c,e,i,b,k,a,g,j,p,r,m,n,q,v,o,u,s,t,w,y,z,A,C,D,E,F,I,G,H){var c=f(c,{addCallback:function(a){this.then(a)},addErrback:function(a){this.then(null,a)}}),B=f("dijit._TreeNode",[y,z,A,C,D],{item:null,isTreeNode:!0,label:"",_setLabelAttr:{node:"labelNode",type:"innerText"},isExpandable:null,isExpanded:!1,state:"UNCHECKED",templateString:E,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);
this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(b){var c=Math.max(b,0)*this.tree._nodePixelIndent+"px";a.set(this.domNode,"backgroundPosition",c+" 0px");a.set(this.indentNode,this.isLeftToRight()?"paddingLeft":"paddingRight",c);h.forEach(this.getChildren(),function(a){a.set("indent",b+1)});this._set("indent",b)},markProcessing:function(){this.state="LOADING";this._setExpando(!0)},
unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(c,d,e){var f="_"+d+"Class",d=d+"Node",g=this[f];this[f]=this.tree["get"+e+"Class"](c,this.isExpanded);b.replace(this[d],this[f]||"",g||"");a.set(this[d],this.tree["get"+e+"Style"](c,
this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent();!a||!a.rowNode||"none"==a.rowNode.style.display?b.add(this.domNode,"dijitTreeIsRoot"):b.toggle(this.domNode,"dijitTreeIsLast",!this.getNextSibling())},_setExpando:function(a){var c=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"],a=a?0:this.isExpandable?this.isExpanded?1:2:3;b.replace(this.expandoNode,c[a],c);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return this._expandDeferred;
this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&this.containerNode.setAttribute("role","group");b.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a,d=p.wipeIn({node:this.containerNode,
duration:w.defaultDuration,onEnd:function(){a.resolve(!0)}});a=this._expandDeferred=new c(function(){d.stop()});d.play();return a},collapse:function(){if(this._collapseDeferred)return this._collapseDeferred;this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");b.remove(this.contentNode,"dijitTreeContentExpanded");
this._setExpando();this._updateItemClasses(this.item);var a,d=p.wipeOut({node:this.containerNode,duration:w.defaultDuration,onEnd:function(){a.resolve(!0)}});a=this._collapseDeferred=new c(function(){d.stop()});d.play();return a},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,d=[],f=this.getChildren();h.forEach(f,function(a){A.prototype.removeChild.call(this,a)},this);this.defer(function(){h.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){b.dndController.removeTreeNode(a);var d=
c.getIdentity(a.item),e=b._itemNodesMap[d];1==e.length?delete b._itemNodesMap[d]:(d=h.indexOf(e,a),-1!=d&&e.splice(d,1));a.destroyRecursive()}})});this.state="LOADED";a&&0<a.length?(this.isExpandable=!0,h.forEach(a,function(a){var e=c.getIdentity(a),f=b._itemNodesMap[e],g;if(f)for(var i=0;i<f.length;i++)if(f[i]&&!f[i].getParent()){g=f[i];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),tooltip:b.getTooltip(a),
ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[e]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&d.push(b._expandNode(g))},this),h.forEach(this.getChildren(),function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);if(this==b.rootNode)(a=this.tree.showRoot?this:this.getChildren()[0])?(a.setFocusable(!0),b.lastFocused=a):b.domNode.setAttribute("tabIndex",
"0");a=new e(d);this.tree._startPaint(a);return a},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();if(0==b.length)this.isExpandable=!1,this.collapse();h.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},
setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");b.toggle(this.rowNode,"dijitTreeRowSelected",a)},setFocusable:function(a){this.labelNode.setAttribute("tabIndex",a?"0":"-1")},_setTextDirAttr:function(a){if(a&&(this.textDir!=a||!this._created))this._set("textDir",a),this.applyTextDir(this.labelNode,this.labelNode.innerText||this.labelNode.textContent||""),h.forEach(this.getChildren(),function(b){b.set("textDir",a)},this)}}),x=f("dijit.Tree",[y,z],{store:null,model:null,
query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:F,persist:!0,autoExpand:!1,dndController:H,dndParams:"onDndDrop,itemCreator,onDndCancel,checkAcceptance,checkItemAcceptance,dragThreshold,betweenThreshold".split(","),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){v.publish(this.id,
n.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;if(this.autoExpand)this.persist=!1;this._itemNodesMap={};if(!this.cookieName&&this.id)this.cookieName=this.id+"SaveStateCookie";this.pendingCommandsDeferred=this.expandChildrenDeferred=new c;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(q(this.domNode,q.selector(".dijitTreeNode",o.enter),function(b){a._onNodeMouseEnter(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeNode",
o.leave),function(b){a._onNodeMouseLeave(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeNode","click"),function(b){a._onClick(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeNode","dblclick"),function(b){a._onDblClick(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeNode","keypress"),function(b){a._onKeyPress(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeNode","keydown"),function(b){a._onKeyDown(t.byNode(this),b)}),q(this.domNode,q.selector(".dijitTreeRow","focusin"),
function(b){a._onNodeFocus(t.getEnclosingWidget(this),b)}));this.model||this._store2model();this.connect(this.model,"onChange","_onItemChange");this.connect(this.model,"onChildrenChange","_onItemChildrenChange");this.connect(this.model,"onDelete","_onItemDelete");this.inherited(arguments);if(this.dndController){if(n.isString(this.dndController))this.dndController=n.getObject(this.dndController);for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();!this.params.path&&!this.params.paths&&this.persist&&this.set("paths",this.dndController._getSavedPaths());this.onLoadDeferred=this.pendingCommandsDeferred;this.onLoadDeferred.then(n.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;r.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};
if(this.params.mayHaveChildren)a.mayHaveChildren=n.hitch(this,"mayHaveChildren");if(this.params.getItemChildren)a.getChildren=n.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)});this.model=new G(a);this.showRoot=Boolean(this.label)},onLoad:function(){},_load:function(){this.model.getRoot(n.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),textDir:this.textDir,indent:this.showRoot?
0:-1});this.showRoot?this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),b.labelNode.setAttribute("role","presentation"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));
this.domNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(n.hitch(this,function(){this.expandChildrenDeferred.resolve(!0)}))}),n.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){return!a?[]:[].concat(this._itemNodesMap[n.isString(a)?a:this.model.getIdentity(a)])},_setSelectedItemAttr:function(a){this.set("selectedItems",
[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsDeferred=this.pendingCommandsDeferred.then(n.hitch(this,function(){var c=h.map(a,function(a){return!a||n.isString(a)?a:b.model.getIdentity(a)}),d=[];h.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?this.set("paths",[a]):this.set("paths",[])},_setPathsAttr:function(a){function b(a,c,e){var f=a.shift(),g=h.filter(c,function(a){return a.getIdentity()==
f})[0];g?a.length?d._expandNode(g).then(function(){b(a,g.getChildren(),e)}):e.resolve(g):e.reject(new x.PathError("Could not expand path at "+f))}var d=this;return this.pendingCommandsDeferred=this.pendingCommandsDeferred.then(function(){return new e(h.map(a,function(a){var e=new c,a=h.map(a,function(a){return n.isString(a)?a:d.model.getIdentity(a)});a.length?b(a,[d.rootNode],e):e.reject(new x.PathError("Empty path"));return e}))}).then(function(a){d.set("selectedNodes",h.map(h.filter(a,function(a){return a[0]}),
function(a){return a[1]}))})},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},expandAll:function(){function a(c){var d=new dojo.Deferred;b._expandNode(c).then(function(){var b=h.filter(c.getChildren()||[],function(a){return a.isExpandable}),b=h.map(b,a);(new dojo.DeferredList(b)).then(function(){d.resolve(!0)})});return d}var b=this;return a(this.rootNode)},collapseAll:function(){function a(c){var d=new dojo.Deferred;
d.label="collapseAllDeferred";var e=h.filter(c.getChildren()||[],function(a){return a.isExpandable}),e=h.map(e,a);(new dojo.DeferredList(e)).then(function(){!c.isExpanded||c==b.rootNode&&!b.showRoot?d.resolve(!0):b._collapseNode(c).then(function(){d.resolve(!0)})});return d}var b=this;return a(this.rootNode)},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":
"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onKeyPress:function(a,b){if(!(32>=b.charCode)&&!b.altKey&&!b.ctrlKey&&!b.shiftKey&&!b.metaKey){var c=String.fromCharCode(b.charCode);this._onLetterKeyNav({node:a,key:c.toLowerCase()});g.stop(b)}},_onKeyDown:function(a,b){var c=b.keyCode,d=this._keyHandlerMap;if(!d)d={},d[m.ENTER]=d[m.SPACE]=d[" "]="_onEnterKey",
d[this.isLeftToRight()?m.LEFT_ARROW:m.RIGHT_ARROW]="_onLeftArrow",d[this.isLeftToRight()?m.RIGHT_ARROW:m.LEFT_ARROW]="_onRightArrow",d[m.UP_ARROW]="_onUpArrow",d[m.DOWN_ARROW]="_onDownArrow",d[m.HOME]="_onHomeKey",d[m.END]="_onEndKey",this._keyHandlerMap=d;this._keyHandlerMap[c]&&(this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch),this[this._keyHandlerMap[c]]({node:a,item:a.item,evt:b}),g.stop(b))},_onEnterKey:function(a){this._publish("execute",{item:a.item,node:a.node});this.dndController.userSelect(a.node,
l.isCopyKey(a.evt),a.evt.shiftKey);this.onClick(a.item,a.node,a.evt)},_onDownArrow:function(a){(a=this._getNextNode(a.node))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a){var a=a.node,b=a.getPreviousSibling();if(b)for(a=b;a.isExpandable&&a.isExpanded&&a.hasChildren();)a=a.getChildren(),a=a[a.length-1];else if(b=a.getParent(),this.showRoot||b!==this.rootNode)a=b;a&&a.isTreeNode&&this.focusNode(a)},_onRightArrow:function(a){a=a.node;a.isExpandable&&!a.isExpanded?this._expandNode(a):a.hasChildren()&&
(a=a.getChildren()[0])&&a.isTreeNode&&this.focusNode(a)},_onLeftArrow:function(a){a=a.node;a.isExpandable&&a.isExpanded?this._collapseNode(a):(a=a.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},_onHomeKey:function(){var a=this._getRootOrFirstNode();a&&this.focusNode(a)},_onEndKey:function(){for(var a=this.rootNode;a.isExpanded;)a=a.getChildren(),a=a[a.length-1];a&&a.isTreeNode&&this.focusNode(a)},multiCharSearchDuration:250,_onLetterKeyNav:function(a){var b=this._curSearch;
b?(b.pattern+=a.key,b.timer.remove()):b=this._curSearch={pattern:a.key,startNode:a.node};b.timer=this.defer(function(){delete this._curSearch},this.multiCharSearchDuration);a=b.startNode;do(a=this._getNextNode(a))||(a=this._getRootOrFirstNode());while(a!==b.startNode&&a.label.toLowerCase().substr(0,b.pattern.length)!=b.pattern);a&&a.isTreeNode&&a!==b.startNode&&this.focusNode(a)},isExpandoNode:function(a,b){return i.isDescendant(a,b.expandoNode)},_onClick:function(a,b){var c=this.isExpandoNode(b.target,
a);this.openOnClick&&a.isExpandable||c?a.isExpandable&&this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this.onClick(a.item,a,b),this.focusNode(a));g.stop(b)},_onDblClick:function(a,b){var c=b.target,c=c==a.expandoNode||c==a.expandoNodeText;this.openOnDblClick&&a.isExpandable||c?a.isExpandable&&this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this.onDblClick(a.item,a,b),this.focusNode(a));g.stop(b)},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},_getRootOrFirstNode:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("LOADING"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){var b=new c;if(a._expandNodeDeferred)return a._expandNodeDeferred;var d=this.model,e=a.item,f=this;if(!a._loadDeferred)a.markProcessing(),a._loadDeferred=new c,d.getChildren(e,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(f,": error loading "+
a.label+" children: ",b);a._loadDeferred.reject(b)});a._loadDeferred.then(n.hitch(this,function(){a.expand().then(function(){b.resolve(!0)});this.onOpen(a.item,a);this._state(a,!0)}));this._startPaint(b);return b},focusNode:function(a){s.focus(a.labelNode)},_onNodeFocus:function(a){if(a&&a!=this.lastFocused)this.lastFocused&&!this.lastFocused._destroyed&&this.lastFocused.setFocusable(!1),a.setFocusable(!0),this.lastFocused=a},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=
this._itemNodesMap[this.model.getIdentity(a)];if(b){var c=this.getLabel(a),d=this.getTooltip(a);h.forEach(b,function(b){b.set({item:a,label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){var c=this._itemNodesMap[this.model.getIdentity(a)];c&&h.forEach(c,function(a){a.setChildItems(b)})},_onItemDelete:function(a){var a=this.model.getIdentity(a),b=this._itemNodesMap[a];b&&(h.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);
a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=d(this.cookieName);a&&h.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=h.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];if(this.persist&&this.cookieName){var c=
[],e;for(e in this._openedNodes)c.push(e);d(this.cookieName,c.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!n.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&k.setMarginBox(this.domNode,a);this._nodePixelIndent=k.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(n.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=n.hitch(this,function(){this._outstandingPaintOperations--;if(0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started)this._adjustWidthsTimer=this.defer("_adjustWidths")});
u(a,b,b)},_adjustWidths:function(){function a(d){var e=d.rowNode;e.style.width="auto";b=Math.max(b,e.clientWidth);c.push(e);d.isExpanded&&h.forEach(d.getChildren(),a)}this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=0,c=[];a(this.rootNode);b=Math.max(b,k.getContentBox(this.domNode).w);h.forEach(c,function(a){a.style.width=b+"px"})},_createTreeNode:function(a){return new B(a)},_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",
a))}});x.PathError=j("TreePathError");x._TreeNode=B;return x})},"cbtree/models/ForestStoreModel":function(){define("cbtree/models/ForestStoreModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","./TreeStoreModel"],function(h,l,d,f,c){return l([c],{rootLabel:"ROOT",rootId:"$root$",moduleName:"cbTree/models/ForestStoreModel",constructor:function(c){this.root={store:this,root:!0,id:this.rootId,label:this.rootLabel,children:c.rootChildren};this.root[this.checkedAttr]=
this.checkedState;this.hasFakeRoot=!0},getChildren:function(c,f,b,h){c===this.root?this.root.children?f(this.root.children):this.store.fetch(this._mixinFetch({query:this.query,onComplete:d.hitch(this,function(a){this.root.children=a;f(a)}),onError:b})):this.inherited(arguments)},getParents:function(c){var d=[];if(c)return c!==this.root&&(d=this.store.getParents(c),!d.length)?[this.root]:d},mayHaveChildren:function(c){return c===this.root||this.inherited(arguments)},fetchItemByIdentity:function(c){if(c.identity==
this.root.id){var d=c.scope?c.scope:f.global;c.onItem&&c.onItem.call(d,this.root)}else this.inherited(arguments)},getIcon:function(c){if(this.iconAttr)return c!==this.root?this.store.getValue(c,this.iconAttr):this.root[this.iconAttr]},getIdentity:function(c){return c===this.root?this.root.id:this.inherited(arguments)},getLabel:function(c){return c===this.root?this.root.label:this.inherited(arguments)},isItem:function(c){return c===this.root?!0:this.inherited(arguments)},isChildOf:function(c,d){if(c===
this.root){if(-1!==h.indexOf(this.root.children,d))return!0}else return this.inherited(arguments)},deleteItem:function(c){if(c===this.root){var c=this.root.children||[],d;for(d=0;d<c.length;d++)this.store.deleteItem(c[d])}else return this.store.deleteItem(c)},newItem:function(c,d,b,f){if(d===this.root){var a=this.store.newItem(c);this._updateCheckedParent(a);return a}return this.inherited(arguments)},pasteItem:function(c,d,b,f,a,g){d===this.root&&(f||this.store.detachFromRoot(c));b===this.root&&this.store.attachToRoot(c);
this.inherited(arguments,[c,d===this.root?null:d,b===this.root?null:b,f,a,g])},onDeleteItem:function(c){-1!=h.indexOf(this.root.children,c)&&this._requeryTop();this.inherited(arguments)},onNewItem:function(c,f){f?(this.getChildren(f.item,d.hitch(this,function(b){this.onChildrenChange(f.item,b)})),this._updateCheckedParent(c,!0)):this._requeryTop()},onSetItem:function(c,d,b,f){this._queryAttrs.length&&-1!=h.indexOf(this._queryAttrs,d)&&this._requeryTop();this.inherited(arguments)},onRootChange:function(c,
d){("attach"===d||"detach"===d)&&this._requeryTop()},_requeryTop:function(){var c=this.root.children||[];this.store.fetch(this._mixinFetch({query:this.query,onComplete:d.hitch(this,function(d){this.root.children=d;if(c.length!=d.length||h.some(c,function(b,c){return d[c]!=b}))this.onChildrenChange(this.root,d),this._updateCheckedParent(d[0])})}))}})})}}});define("final/commsy",[],1);