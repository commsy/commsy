//>>built
define("commsy/bar/CalendarConfig","dojo/_base/declare,dijit/_WidgetBase,commsy/base,dijit/_TemplatedMixin,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/query,dojo/on,dojo/topic,dijit/MenuItem,dijit/CheckedMenuItem,dijit/form/ComboButton,dijit/DropDownMenu,dijit/MenuSeparator,dijit/PopupMenuItem,dijit/registry,dojo/i18n!./nls/calendar".split(","),function(h,l,m,n,c,r,s,t,u,i,o,f,p,g,j,k,q,e){return h([m,l,n],{baseClass:"CommSyWidgetBorderless",widgetHandler:null,itemId:null,constructor:function(a){a=
a||{};h.safeMixin(this,a);this.roomList=[]},postCreate:function(){this.inherited(arguments);this.itemId=this.from_php.ownRoom.id;this.loadRoomList().then(c.hitch(this,function(){this.createMenu()}))},loadRoomList:function(){return this.AJAXRequest("myCalendar","getRoomList",{},c.hitch(this,function(a){this.roomList=a}))},createMenu:function(){var a=new g;a.addChild(new f({label:e.configToDo,onClick:this.onClickConfigToDo}));a.addChild(new f({label:e.configRestrictions,onClick:this.onClickConfigRestrictions}));
a.addChild(new j);var b=new g;this.createRoomMenu(b,"checkedInDates");a.addChild(new k({label:e.configDate,popup:b}));b=new g;this.createRoomMenu(b,"checkedInTodo");a.addChild(new k({label:e.configToDo,popup:b}));(new p({label:e.configHeadline,dropDown:a})).placeAt(this.widgetBodyNode)},createRoomMenu:function(a,b){a.addChild(new o({label:e.configFromAll,onClick:c.partial(c.hitch(this,this.onClickAllRooms),"checkedInDates"===b?"dates":"todo")}));a.addChild(new j);dojo.forEach(this.roomList,c.hitch(this,
function(d){a.addChild(new f({label:d.title,checked:d[b],onChange:c.partial(c.hitch(this,this.onRoomSelectChange),d.id,"checkedInDates"===b?"dates":"todo")}))}))},onClickConfigToDo:function(a){a.preventDefault()},onClickConfigRestrictions:function(a){a.preventDefault()},onClickAllRooms:function(a,b){this.AJAXRequest("myCalendar","storeRoomSelectAll",{type:a},c.hitch(this,function(){i.publish("updatePrivateCalendar",{})}));var d=q.findWidgets(b.rangeParent);dojo.forEach(d,function(a){"dijit.CheckedMenuItem"===
a.get("declaredClass")&&a.set("checked",!0)})},onRoomSelectChange:function(a,b,d){this.AJAXRequest("myCalendar","storeRoomChange",{roomId:a,type:b,checked:d},c.hitch(this,function(){i.publish("updatePrivateCalendar",{})}))}})});