//>>built
define("commsy/popups/ClickMaterialPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on,dojo/topic".split(","),function(g,h,b,e,f,k,d,i,j){return g(h,{constructor:function(){},init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module="material";this.editType=b.editType;this.version_id=b.vid;this.contextId=b.contextId;this.features=["editor","tree","upload","netnavigation","calendar"];this.registerPopupClick()},
setupSpecific:function(){var a=b("select#bibliographic_select",this.contentNode)[0];a&&(this.showHideBibliographic(a),i(a,"change",f.hitch(this,function(){this.showHideBibliographic(a)})))},onPopupSubmit:function(a){dojo.forEach(this.featureHandles.editor,function(a){a.getInstance();var c=a.getNode().parentNode;d.set(b("input[type='hidden']",c)[0],"value",a.getInstance().getData())});var c={tabs:[{id:"rights_tab"},{id:"buzzwords_tab",group:"buzzwords"},{id:"tags_tab",group:"tags"},{id:"workflow_tab"}],
nodeLists:[{query:b("div#files_attached",this.contentNode)},{query:b("div#files_finished",this.contentNode),group:"files"},{query:b("input[name='form_data[description]']",this.contentNode)},{query:b("input[name='form_data[title]']",this.contentNode)},{query:b("input.tabStatus",this.contentNode)},{query:b("select#bibliographic_select",this.contentNode)}]};dojo.forEach(b("div#bibliographic div[id^='bib_content_']",this.contentNode),function(a){if(!e.contains(a,"hidden"))return a=d.get(a,"id"),c.nodeLists.push({query:b("div#"+
a,this.contentNode)}),!1});this.submit(c,{part:a.part,version_id:this.version_id,contextId:this.contextId})},onPopupSubmitSuccess:function(a){if("NEW"===this.item_id)this.featureHandles.netnavigation[0].afterItemCreation(a,f.hitch(this,function(){this.contextId?(this.close(),j.publish("newOwnRoomItem",{itemId:a})):this.reload(a)}));else if(this.contextId){this.close();var c=b("a#listItem"+a)[0];c&&c.click()}else"undefined"!=typeof this.version_id?this.reload(a+"&version_id="+this.version_id):this.reload(a)},
showHideBibliographic:function(a){var c=d.get(a,"value");dojo.forEach(b("div#bibliographic div[id^='bib_content_']",this.contentNode),function(a){d.get(a,"id")==="bib_content_"+c?e.remove(a,"hidden"):e.add(a,"hidden")})}})});