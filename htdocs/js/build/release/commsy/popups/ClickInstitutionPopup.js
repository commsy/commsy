//>>built
define("commsy/popups/ClickInstitutionPopup","dojo/_base/declare,commsy/ClickPopupHandler,dojo/query,dojo/dom-class,dojo/_base/lang,dojo/dom-construct,dojo/dom-attr,dojo/on".split(","),function(f,g,d,i,c,e,h){return f(g,{sendImages:[],constructor:function(){this.sendImages=[]},init:function(a,b){this.triggerNode=a;this.item_id=b.iid;this.module="institution";this.editType=b.editType;this.fileInfo=null;this.features=["editor","upload","upload-single","netnavigation","calendar"];this.registerPopupClick()},
setupSpecific:function(){dojo.ready(c.hitch(this,function(){this.featureHandles["upload-single"][0].setCallback(c.hitch(this,function(a){var b=d("div.filePreview",this.featureHandles["upload-single"][0].uploader.form)[0];e.empty(b);e.create("img",{src:"commsy.php?cid="+this.uri_object.cid+"&mod=picture&fct=getTemp&fileName="+a.file},b,"last");this.sendImages.push({part:"upload_picture",fileInfo:a})}))}))},onPopupSubmit:function(){dojo.forEach(this.featureHandles.editor,function(a){a.getInstance();
var b=a.getNode().parentNode;h.set(d("input[type='hidden']",b)[0],"value",a.getInstance().getData())});this.submit({tabs:[{id:"rights_tab"}],nodeLists:[{query:d("div#files_attached",this.contentNode)},{query:d("div#popup_content",this.contentNode)}]})},onPopupSubmitSuccess:function(a){if(0<this.sendImages.length)var b={module:"institution",additional:{action:this.sendImages[0].part,fileInfo:this.sendImages[0].fileInfo,iid:a}};"NEW"===this.item_id?this.featureHandles.netnavigation[0].afterItemCreation(a,
c.hitch(this,function(){0<this.sendImages.length?this.AJAXRequest("popup","save",b,c.hitch(this,function(){this.reload(a)})):this.reload(a)})):0<this.sendImages.length?this.AJAXRequest("popup","save",b,c.hitch(this,function(){this.reload(a)})):this.reload(a)}})});