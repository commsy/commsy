//>>built
define("dojo/store/JsonRest",["../_base/xhr","../_base/lang","../json","../_base/declare","./util/QueryResults"],function(e,g,j,f,k){return f("dojo.store.JsonRest",null,{constructor:function(b){this.headers={};f.safeMixin(this,b)},headers:{},target:"",idProperty:"id",get:function(b,a){var a=a||{},d=g.mixin({Accept:this.accepts},this.headers,a.headers||a);return e("GET",{url:this.target+b,handleAs:"json",headers:d})},accepts:"application/javascript, application/json",getIdentity:function(b){return b[this.idProperty]},
put:function(b,a){var a=a||{},d="id"in a?a.id:this.getIdentity(b),c="undefined"!=typeof d;return e(c&&!a.incremental?"PUT":"POST",{url:c?this.target+d:this.target,postData:j.stringify(b),handleAs:"json",headers:g.mixin({"Content-Type":"application/json",Accept:this.accepts,"If-Match":!0===a.overwrite?"*":null,"If-None-Match":!1===a.overwrite?"*":null},this.headers,a.headers)})},add:function(b,a){a=a||{};a.overwrite=!1;return this.put(b,a)},remove:function(b,a){a=a||{};return e("DELETE",{url:this.target+
b,headers:g.mixin({},this.headers,a.headers)})},query:function(b,a){var a=a||{},d=g.mixin({Accept:this.accepts},this.headers,a.headers);if(0<=a.start||0<=a.count)d.Range=d["X-Range"]="items="+(a.start||"0")+"-"+("count"in a&&Infinity!=a.count?a.count+(a.start||0)-1:"");var c=-1<this.target.indexOf("?");b&&"object"==typeof b&&(b=(b=e.objectToQuery(b))?(c?"&":"?")+b:"");if(a&&a.sort){for(var i=this.sortParam,b=b+((b||c?"&":"?")+(i?i+"=":"sort(")),c=0;c<a.sort.length;c++)var f=a.sort[c],b=b+((0<c?",":
"")+(f.descending?"-":"+")+encodeURIComponent(f.attribute));i||(b+=")")}var h=e("GET",{url:this.target+(b||""),handleAs:"json",headers:d});h.total=h.then(function(){var a=h.ioArgs.xhr.getResponseHeader("Content-Range");return a&&(a=a.match(/\/(.*)/))&&+a[1]});return k(h)}})});