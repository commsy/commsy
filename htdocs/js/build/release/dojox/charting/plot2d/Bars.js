//>>built
define("dojox/charting/plot2d/Bars","dojo/_base/kernel,dojo/_base/lang,dojo/_base/array,dojo/_base/declare,./CartesianBase,./_PlotEvents,./common,dojox/gfx/fx,dojox/lang/utils,dojox/lang/functional,dojox/lang/functional/reversed".split(","),function(D,r,v,s,t,u,l,z,n,A,B){var C=B.lambda("item.purgeGroup()");return s("dojox.charting.plot2d.Bars",[t,u],{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},
styleFunc:null,font:"",fontColor:""},constructor:function(a,b){this.opt=r.clone(this.defaultParams);n.updateWithObject(this.opt,b);n.updateWithPattern(this.opt,b,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate},getSeriesStats:function(){var a=l.collectSimpleStats(this.series),b;a.hmin-=0.5;a.hmax+=0.5;b=a.hmin;a.hmin=a.vmin;a.vmin=b;b=a.hmax;a.hmax=a.vmax;a.vmax=b;return a},createRect:function(a,b,e){var f;this.opt.enableCache&&
0<a._rectFreePool.length?(f=a._rectFreePool.pop(),f.setShape(e),b.add(f)):f=b.createRect(e);this.opt.enableCache&&a._rectUsePool.push(f);return f},render:function(a,b){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,b);this.dirty=this.isDirty();this.resetEvents();var e;if(this.dirty)v.forEach(this.series,C),this._eventSeries={},this.cleanGroup(),e=this.group,A.forEachRev(this.series,function(a){a.cleanGroup(e)});for(var f=this.chart.theme,l=this._hScaler.scaler.getTransformerFromModel(this._hScaler),
n=this._vScaler.scaler.getTransformerFromModel(this._vScaler),w=Math.max(0,this._hScaler.bounds.lower),o=l(w),s=this.events(),p=this.getBarProperties(),m=this.series.length-1;0<=m;--m){var c=this.series[m];if(!this.dirty&&!c.dirty)f.skip(),this._reconnectEvents(c.name);else{c.cleanGroup();if(this.opt.enableCache)c._rectFreePool=(c._rectFreePool?c._rectFreePool:[]).concat(c._rectUsePool?c._rectUsePool:[]),c._rectUsePool=[];var x=f.next("bar",[this.opt,c]),y=Array(c.data.length);e=c.group;for(var t=
this.getDataLength(c),u=v.some(c.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),i=0;i<t;++i){var d=c.data[i];if(null!=d){var h=this.getValue(d,i,m,u),j=l(h.y),q=Math.abs(j-o),g;if(this.opt.styleFunc||"number"!=typeof d){var k="number"!=typeof d?[d]:[];this.opt.styleFunc&&k.push(this.opt.styleFunc(d));d=f.addMixin(x,"bar",k,!0)}else d=f.post(x,"bar");if(0<=q&&1<=p.height)j={x:b.l+(h.y<w?j:o),y:a.height-b.b-n(h.x+1.5)+p.gap+p.thickness*(this.series.length-m-1),width:q,height:p.height},
d.series.shadow&&(g=r.clone(j),g.x+=d.series.shadow.dx,g.y+=d.series.shadow.dy,g=this.createRect(c,e,g).setFill(d.series.shadow.color).setStroke(d.series.shadow),this.animate&&this._animateBar(g,b.l+o,-q)),k=this._plotFill(d.series.fill,a,b),k=this._shapeFill(k,j),d=this.createRect(c,e,j).setFill(k).setStroke(d.series.stroke),c.dyn.fill=d.getFill(),c.dyn.stroke=d.getStroke(),s&&(h={element:"bar",index:i,run:c,shape:d,shadow:g,x:h.y,y:h.x+1.5},this._connectEvents(h),y[i]=h),this.animate&&this._animateBar(d,
b.l+o,-q)}}this._eventSeries[c.name]=y;c.dirty=!1}}this.dirty=!1;return this},getDataLength:function(a){return Math.min(a.data.length,Math.ceil(this._vScaler.bounds.to))},getValue:function(a,b,e,f){f?(e="number"==typeof a?a:a.y,a=b):(e=a.y,a=a.x-1);return{y:e,x:a}},getBarProperties:function(){var a=l.calculateBarSize(this._vScaler.bounds.scale,this.opt);return{gap:a.gap,height:a.size,thickness:0}},_animateBar:function(a,b,e){0==e&&(e=1);z.animateTransform(r.delegate({shape:a,duration:1200,transform:[{name:"translate",
start:[b-b/e,0],end:[0,0]},{name:"scale",start:[1/e,1],end:[1,1]},{name:"original"}]},this.animate)).play()}})});