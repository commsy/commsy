//>>built
define("dojox/charting/DataSeries",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojox/lang/functional"],function(d,g,f,e,h){return g("dojox.charting.DataSeries",null,{constructor:function(a,c,b){this.store=a;this.kwArgs=c;this.value=b?d.isFunction(b)?b:d.isObject(b)?d.hitch(this,"_dictValue",h.keys(b),b):d.hitch(this,"_fieldValue",b):d.hitch(this,"_defaultValue");this.data=[];this._events=[];this.store.getFeatures()["dojo.data.api.Notification"]&&this._events.push(e.connect(this.store,
"onNew",this,"_onStoreNew"),e.connect(this.store,"onDelete",this,"_onStoreDelete"),e.connect(this.store,"onSet",this,"_onStoreSet"));this._initialRendering=!0;this.fetch()},destroy:function(){f.forEach(this._events,e.disconnect)},setSeriesObject:function(a){this.series=a},_dictValue:function(a,c,b,d){var e={};f.forEach(a,function(a){e[a]=b.getValue(d,c[a])});return e},_fieldValue:function(a,c,b){return c.getValue(b,a)},_defaultValue:function(a,c){return a.getValue(c,"value")},fetch:function(){if(!this._inFlight){this._inFlight=
!0;var a=d.delegate(this.kwArgs);a.onComplete=d.hitch(this,"_onFetchComplete");a.onError=d.hitch(this,"onFetchError");this.store.fetch(a)}},_onFetchComplete:function(a){this.items=a;this._buildItemMap();this.data=f.map(this.items,function(a){return this.value(this.store,a)},this);this._pushDataChanges();this._inFlight=!1},onFetchError:function(){this._inFlight=!1},_buildItemMap:function(){if(this.store.getFeatures()["dojo.data.api.Identity"]){var a={};f.forEach(this.items,function(c,b){a[this.store.getIdentity(c)]=
b},this);this.itemMap=a}},_pushDataChanges:function(){if(this.series)this.series.chart.updateSeries(this.series.name,this,this._initialRendering),this._initialRendering=!1,this.series.chart.delayedRender()},_onStoreNew:function(){this.fetch()},_onStoreDelete:function(a){this.items&&f.some(this.items,function(c,b){return c===a?(this.items.splice(b,1),this._buildItemMap(),this.data.splice(b,1),!0):!1},this)&&this._pushDataChanges()},_onStoreSet:function(a){if(this.itemMap){var c=this.itemMap[this.store.getIdentity(a)];
"number"==typeof c&&(this.data[c]=this.value(this.store,this.items[c]),this._pushDataChanges())}else this.items&&f.some(this.items,function(b,c){return b===a?(this.data[c]=this.value(this.store,b),!0):!1},this)&&this._pushDataChanges()}})});