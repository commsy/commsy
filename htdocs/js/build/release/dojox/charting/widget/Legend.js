//>>built
define("dojox/charting/widget/Legend","dojo/_base/lang,dojo/_base/declare,dijit/_WidgetBase,dojox/gfx,dojo/_base/array,dojox/lang/functional,dojox/lang/functional/array,dojox/lang/functional/fold,dojo/dom,dojo/dom-construct,dojo/dom-class,dijit/registry".split(","),function(p,k,l,m,f,g,q,r,n,d,h,i){var o=/\.(StackedColumns|StackedAreas|ClusteredBars)$/;return k("dojox.charting.widget.Legend",l,{chartRef:"",horizontal:!0,swatchSize:18,legendBody:null,postCreate:function(){if(!this.chart&&this.chartRef)this.chart=
i.byId(this.chartRef)||i.byNode(n.byId(this.chartRef));this.chart=this.chart.chart||this.chart;this.refresh()},buildRendering:function(){this.domNode=d.create("table",{role:"group","aria-label":"chart legend","class":"dojoxLegendNode"});this.legendBody=d.create("tbody",null,this.domNode);this.inherited(arguments)},refresh:function(){this._surfaces&&f.forEach(this._surfaces,function(a){a.destroy()});for(this._surfaces=[];this.legendBody.lastChild;)d.destroy(this.legendBody.lastChild);if(this.horizontal)h.add(this.domNode,
"dojoxLegendHorizontal"),this._tr=d.create("tr",null,this.legendBody),this._inrow=0;var b=this.series||this.chart.series;if(0!=b.length)if("dojox.charting.plot2d.Pie"==b[0].chart.stack[0].declaredClass){var c=b[0].chart.stack[0];"number"==typeof c.run.data[0]?(b=g.map(c.run.data,"Math.max(x, 0)"),b=g.map(b,"/this",g.foldl(b,"+",0)),f.forEach(b,function(a,b){this._addLabel(c.dyn[b],c._getLabel(100*a)+"%")},this)):f.forEach(c.run.data,function(a,b){this._addLabel(c.dyn[b],a.legend||a.text||a.y)},this)}else this._isReversal()&&
(b=b.slice(0).reverse()),f.forEach(b,function(a){this._addLabel(a.dyn,a.legend||a.name)},this)},_addLabel:function(b,c){var a=d.create("td"),j=d.create("div",null,a),e=d.create("label",null,a),f=d.create("div",{style:{width:this.swatchSize+"px",height:this.swatchSize+"px","float":"left"}},j);h.add(j,"dojoxLegendIcon dijitInline");h.add(e,"dojoxLegendText");if(this._tr){if(this._tr.appendChild(a),++this._inrow===this.horizontal)this._tr=d.create("tr",null,this.legendBody),this._inrow=0}else d.create("tr",
null,this.legendBody).appendChild(a);this._makeIcon(f,b);e.innerHTML=""+c;e.dir=this.getTextDir(c,e.dir)},_makeIcon:function(b,c){var a=this.swatchSize,d=this.swatchSize,e=m.createSurface(b,d,a);this._surfaces.push(e);if(c.fill)e.createRect({x:2,y:2,width:d-4,height:a-4}).setFill(c.fill).setStroke(c.stroke);else if(c.stroke||c.marker){var f={x1:0,y1:a/2,x2:d,y2:a/2};c.stroke&&e.createLine(f).setStroke(c.stroke);c.marker&&e.createPath({path:"M"+d/2+" "+a/2+" "+c.marker}).setFill(c.markerFill).setStroke(c.markerStroke)}else e.createRect({x:2,
y:2,width:d-4,height:a-4}).setStroke("black"),e.createLine({x1:2,y1:2,x2:d-2,y2:a-2}).setStroke("black"),e.createLine({x1:2,y1:a-2,x2:d-2,y2:2}).setStroke("black")},_isReversal:function(){return!this.horizontal&&f.some(this.chart.stack,function(b){return o.test(b.declaredClass)})}})});