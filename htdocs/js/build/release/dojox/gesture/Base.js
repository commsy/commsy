//>>built
define("dojox/gesture/Base","dojo/_base/kernel,dojo/_base/declare,dojo/_base/array,dojo/_base/lang,dojo/dom,dojo/on,dojo/touch,dojo/has,../main".split(","),function(m,n,g,e,o,h,j,p,q){m.experimental("dojox.gesture.Base");e.getObject("gesture",!0,q);return n(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(a){e.mixin(this,a);this.init()},init:function(){this._elements=[];if(!p("touch")&&this.touchOnly)console.warn("Gestures:[",this.defaultEvent,"] is only supported on touch devices!");
else{var a=this.defaultEvent;this.call=this._handle(a);this._events=[a];g.forEach(this.subEvents,function(c){this[c]=this._handle(a+"."+c);this._events.push(a+"."+c)},this)}},_handle:function(a){var c=this;return function(b,d){var i=arguments;2<i.length&&(b=i[1],d=i[2]);if(b&&(b.nodeType||b.attachEvent||b.addEventListener)){var e=c._add(b,a,d);return{remove:function(){e.remove();c._remove(b,a)}}}return h(b,a,d)}},_add:function(a,c,b){var d=this._getGestureElement(a);if(!d){var d={target:a,data:{},
handles:{}},i=e.hitch(this,"_process",d,"press"),g=e.hitch(this,"_process",d,"move"),k=e.hitch(this,"_process",d,"release"),l=e.hitch(this,"_process",d,"cancel"),f=d.handles;this.touchOnly?(f.press=h(a,"touchstart",i),f.move=h(a,"touchmove",g),f.release=h(a,"touchend",k),f.cancel=h(a,"touchcancel",l)):(f.press=j.press(a,i),f.move=j.move(a,g),f.release=j.release(a,k),f.cancel=j.cancel(a,l));this._elements.push(d)}d.handles[c]=!d.handles[c]?1:++d.handles[c];return h(a,c,b)},_getGestureElement:function(a){for(var c=
0,b;c<this._elements.length;c++)if(b=this._elements[c],b.target===a)return b},_process:function(a,c,b){b._locking=b._locking||{};!b._locking[this.defaultEvent]&&!this.isLocked(b.currentTarget)&&(b.preventDefault(),b._locking[this.defaultEvent]=!0,this[c](a.data,b))},press:function(){},move:function(){},release:function(){},cancel:function(){},fire:function(a,c){if(a&&c)c.bubbles=!0,c.cancelable=!0,h.emit(a,c.type,c)},_remove:function(a,c){var b=this._getGestureElement(a);if(b&&b.handles){b.handles[c]--;
var d=b.handles;g.some(this._events,function(a){return 0<d[a]})||(this._cleanHandles(d),b=g.indexOf(this._elements,b),0<=b&&this._elements.splice(b,1))}},_cleanHandles:function(a){for(var c in a)a[c].remove&&a[c].remove(),delete a[c]},lock:function(a){this._lock=a},unLock:function(){this._lock=null},isLocked:function(a){return!this._lock||!a?!1:this._lock!==a&&o.isDescendant(a,this._lock)},destroy:function(){g.forEach(this._elements,function(a){this._cleanHandles(a.handles)},this);this._elements=
null}})});