//>>built
define("dojox/testing/DocTest",["dojo/string"],function(){dojo.declare("dojox.testing.DocTest",null,{errors:[],getTests:function(a){a=dojo.moduleUrl(a).path;a=a.substring(0,a.length-1)+".js";dojo.xhrGet({url:a,handleAs:"text"});return this._getTestsFromString(dojo._getText(a),!0)},getTestsFromString:function(a){return this._getTestsFromString(a,!1)},_getTestsFromString:function(a,d){for(var b=dojo.hitch(dojo.string,"trim"),f=a.split("\n"),j=f.length,i=[],e=[],g=[],h=null,k=0;k<j+1;k++){var c=b(f[k]||
"");d&&c.match(/^\/\/\s+>>>\s.*/)||c.match(/^\s*>>>\s.*/)?(h||(h=k+1),0<g.length&&(i.push({commands:e,expectedResult:g.join("\n"),line:h}),e=[],g=[],h=k+1),c=d?b(c).substring(2,c.length):c,c=b(c).substring(3,c.length),e.push(b(c))):(!d||c.match(/^\/\/\s+.*/))&&e.length&&0==g.length?(c=d?b(c).substring(3,c.length):c,g.push(b(c))):0<e.length&&g.length&&((!d||c.match(/^\/\/\s*$/))&&i.push({commands:e,expectedResult:g.join("\n"),line:h}),d&&!c.match(/^\/\//)&&i.push({commands:e,expectedResult:g.join("\n"),
line:h}),e=[],g=[],h=0)}return i},run:function(a){this.errors=[];(a=this.getTests(a))&&this._run(a)},_run:function(a){var d=a.length;this.tests=d;for(var b=0;b<d;b++){var f=a[b],j=this.runTest(f.commands,f.expectedResult),i="Test "+(b+1)+": ",e=f.commands.join(" "),e=50<e.length?e.substr(0,50)+"...":e;j.success||(this.errors.push({commands:f.commands,actual:j.actualResult,expected:f.expectedResult}),console.error(i+"Failed: "+e,{commands:f.commands,actualResult:j.actualResult,expectedResult:f.expectedResult}))}},
runTest:function(a,d){var b={success:!1,actualResult:null},f=a.join("\n");b.actualResult=eval(f);if(""+b.actualResult==d||dojo.toJson(b.actualResult)==d||'"'==d.charAt(0)&&'"'==d.charAt(d.length-1)&&""+b.actualResult==d.substring(1,d.length-1))b.success=!0;return b}});return dojox.testing.DocTest});