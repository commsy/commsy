//>>built
define("dojox/grid/enhanced/plugins/exporter/TableWriter",["dojo/_base/declare","dojo/_base/array","dojo/dom-geometry","./_ExportWriter","../Exporter"],function(h,g,e,i,j){j.registerWriter("table","dojox.grid.enhanced.plugins.exporter.TableWriter");return h("dojox.grid.enhanced.plugins.exporter.TableWriter",i,{constructor:function(a){this._viewTables=[];this._tableAttrs=a||{}},_getTableAttrs:function(a){(a=this._tableAttrs[a]||"")&&" "!=a[0]&&(a=" "+a);return a},_getRowClass:function(a){return a.isHeader?
" grid_header":[" grid_row grid_row_",a.rowIdx+1,a.rowIdx%2?" grid_even_row":" grid_odd_row"].join("")},_getColumnClass:function(a){a=a.cell.index+a.colOffset+1;return[" grid_column grid_column_",a,a%2?" grid_odd_column":" grid_even_column"].join("")},beforeView:function(a){var b=a.viewIdx,c=this._viewTables[b],f=e.getMarginBox(a.view.contentNode).w;if(!c){for(var d=c=0;d<b;++d)c+=this._viewTables[d]._width;c=this._viewTables[b]=['<div class="grid_view" style="position: absolute; top: 0; ',e.isBodyLtr()?
"left":"right",":",c,'px;">']}c._width=f;b=a.isHeader?e.getContentBox(a.view.headerContentNode).h:(b=a.grid.getRowNode(a.rowIdx))?e.getContentBox(b).h:a.grid.scroller.averageRowHeight;c.push('<table class="',this._getRowClass(a),'" style="table-layout:fixed; height:',b,"px; width:",f,'px;" ','border="0" cellspacing="0" cellpadding="0" ',this._getTableAttrs("table"),"><tbody ",this._getTableAttrs("tbody"),">");return!0},afterView:function(a){this._viewTables[a.viewIdx].push("</tbody></table>")},beforeSubrow:function(a){this._viewTables[a.viewIdx].push("<tr",
this._getTableAttrs("tr"),">");return!0},afterSubrow:function(a){this._viewTables[a.viewIdx].push("</tr>")},handleCell:function(a){var b=a.cell;if(!(b.hidden||0<=g.indexOf(a.spCols,b.index))){var c=a.isHeader?"th":"td",f=[b.colSpan?' colspan="'+b.colSpan+'"':"",b.rowSpan?' rowspan="'+b.rowSpan+'"':"",' style="width: ',e.getContentBox(b.getHeaderNode()).w,'px;"',this._getTableAttrs(c),' class="',this._getColumnClass(a),'"'].join(""),d=this._viewTables[a.viewIdx];d.push("<",c,f,">");a.isHeader?d.push(b.name||
b.field):d.push(this._getExportDataForCell(a.rowIdx,a.row,b,a.grid));d.push("</",c,">")}},afterContent:function(){g.forEach(this._viewTables,function(a){a.push("</div>")})},toString:function(){return['<div style="position: relative;">',g.map(this._viewTables,function(a){return a.join("")}).join(""),"</div>"].join("")}})});