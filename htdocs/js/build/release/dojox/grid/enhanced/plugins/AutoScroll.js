//>>built
define("dojox/grid/enhanced/plugins/AutoScroll","dojo/_base/declare,dojo/_base/array,dojo/_base/lang,dojo/_base/html,dojo/_base/window,../_Plugin,../../_RowSelector,../../EnhancedGrid".split(","),function(k,l,m,j,n,o,p,q){k=k("dojox.grid.enhanced.plugins.AutoScroll",o,{name:"autoScroll",autoScrollInterval:1E3,autoScrollMargin:30,constructor:function(c,a){this.grid=c;this._scrolling=this.readyForAutoScroll=!1;a=m.isObject(a)?a:{};if("interval"in a)this.autoScrollInterval=a.interval;if("margin"in a)this.autoScrollMargin=
a.margin;this._initEvents();this._mixinGrid()},_initEvents:function(){var c=this.grid;this.connect(c,"onCellMouseDown",function(){this.readyForAutoScroll=!0});this.connect(c,"onHeaderCellMouseDown",function(){this.readyForAutoScroll=!0});this.connect(c,"onRowSelectorMouseDown",function(){this.readyForAutoScroll=!0});this.connect(n.doc,"onmouseup",function(){this._manageAutoScroll(!0);this.readyForAutoScroll=!1});this.connect(n.doc,"onmousemove",function(a){if(this.readyForAutoScroll){this._event=
a;var b=j.position(c.domNode),e=c._getHeaderHeight(),d=this.autoScrollMargin,f=a.clientY,i=a.clientX,a=b.y,g=b.x,h=b.h,b=b.w;if(i>=g&&i<=g+b){if(f>=a+e&&f<a+e+d){this._manageAutoScroll(!1,!0,!1);return}if(f>a+h-d&&f<=a+h){this._manageAutoScroll(!1,!0,!0);return}if(f>=a&&f<=a+h&&l.some(c.views.views,function(a){if(a instanceof p)return!1;var b=j.position(a.domNode);if(i<b.x+d&&i>=b.x)return this._manageAutoScroll(!1,!1,!1,a),!0;return i>b.x+b.w-d&&i<b.x+b.w?(this._manageAutoScroll(!1,!1,!0,a),!0):
!1},this))return}this._manageAutoScroll(!0)}})},_mixinGrid:function(){var c=this.grid;c.onStartAutoScroll=function(){};c.onEndAutoScroll=function(){}},_fireEvent:function(c,a){var b=this.grid;switch(c){case "start":b.onStartAutoScroll.apply(b,a);break;case "end":b.onEndAutoScroll.apply(b,a)}},_manageAutoScroll:function(c,a,b,e){if(c)this._scrolling=!1,clearInterval(this._handler);else if(!this._scrolling)this._scrolling=!0,this._fireEvent("start",[a,b,e]),this._autoScroll(a,b,e),this._handler=setInterval(m.hitch(this,
"_autoScroll",a,b,e),this.autoScrollInterval)},_autoScroll:function(c,a,b){var e=this.grid,d=null;if(c){var f=e.scroller.firstVisibleRow+(a?1:-1);0<=f&&f<e.rowCount&&(e.scrollToRow(f),d=f)}else d=this._scrollColumn(a,b);null!==d&&this._fireEvent("end",[c,a,b,d,this._event])},_scrollColumn:function(c,a){var b=a.scrollboxNode,e=null;if(b.clientWidth<b.scrollWidth){var d=l.filter(this.grid.layout.cells,function(a){return!a.hidden}),f=j.position(a.domNode),i,g,h;if(c){i=b.clientWidth;for(h=0;h<d.length;++h)if(g=
j.position(d[h].getHeaderNode()),g=g.x-f.x+g.w,g>i){e=d[h].index;b.scrollLeft+=g-i+10;break}}else{i=0;for(h=d.length-1;0<=h;--h)if(g=j.position(d[h].getHeaderNode()),g=g.x-f.x,g<i){e=d[h].index;b.scrollLeft+=g-i-10;break}}}return e}});q.registerPlugin(k);return k});