//>>built
define("dojox/gfx/gradient",["dojo/_base/lang","./matrix","dojo/_base/Color"],function(n,h,j){function l(a,c,i,e,f,b){a=h.multiplyPoint(i,a,c);e=h.multiplyPoint(e,a);return{r:a,p:e,o:h.multiplyPoint(f,e).x/b}}function o(a,c){return a.o-c.o}var m=n.getObject("dojox.gfx.gradient",!0);m.rescale=function(a,c,i){var e=a.length,f=i<c,b;f&&(b=c,c=i,i=b);if(!e)return[];if(i<=a[0].offset)b=[{offset:0,color:a[0].color},{offset:1,color:a[0].color}];else if(c>=a[e-1].offset)b=[{offset:0,color:a[e-1].color},{offset:1,
color:a[e-1].color}];else{var h=i-c,d,k,g;b=[];0>c&&b.push({offset:0,color:new j(a[0].color)});for(g=0;g<e&&!(d=a[g],d.offset>=c);++g);g?(k=a[g-1],b.push({offset:0,color:j.blendColors(new j(k.color),new j(d.color),(c-k.offset)/(d.offset-k.offset))})):b.push({offset:0,color:new j(d.color)});for(;g<e;++g){d=a[g];if(d.offset>=i)break;b.push({offset:(d.offset-c)/h,color:new j(d.color)})}g<e?(k=a[g-1],b.push({offset:1,color:j.blendColors(new j(k.color),new j(d.color),(i-k.offset)/(d.offset-k.offset))})):
b.push({offset:1,color:new j(a[e-1].color)})}if(f){b.reverse();for(g=0,e=b.length;g<e;++g)d=b[g],d.offset=1-d.offset}return b};m.project=function(a,c,i,e){var a=a||h.identity,f=h.multiplyPoint(a,c.x1,c.y1),b=h.multiplyPoint(a,c.x2,c.y2),j=Math.atan2(b.y-f.y,b.x-f.x),d=h.project(b.x-f.x,b.y-f.y),f=h.multiplyPoint(d,f),b=h.multiplyPoint(d,b),f=new h.Matrix2D([h.rotate(-j),{dx:-f.x,dy:-f.y}]),b=h.multiplyPoint(f,b).x,a=[l(i.x,i.y,a,d,f,b),l(e.x,e.y,a,d,f,b),l(i.x,e.y,a,d,f,b),l(e.x,i.y,a,d,f,b)].sort(o),
c=m.rescale(c.colors,a[0].o,a[3].o);Math.atan2(a[3].r.y-a[0].r.y,a[3].r.x-a[0].r.x);return{type:"linear",x1:a[0].p.x,y1:a[0].p.y,x2:a[3].p.x,y2:a[3].p.y,colors:c,angle:j}};return m});