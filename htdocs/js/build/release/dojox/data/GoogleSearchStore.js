//>>built
define("dojox/data/GoogleSearchStore","dojo/_base/kernel,dojo/_base/lang,dojo/_base/declare,dojo/_base/query,dojo/dom-construct,dojo/io/script".split(","),function(l,m,d,v,w,x){l.experimental("dojox.data.GoogleSearchStore");var c=d("dojox.data.GoogleSearchStore",null,{constructor:function(a){if(a){if(a.label)this.label=a.label;if(a.key)this._key=a.key;if(a.lang)this._lang=a.lang;if("urlPreventCache"in a)this.urlPreventCache=a.urlPreventCache?!0:!1}this._id=dojox.data.GoogleSearchStore.prototype._id++},
_id:0,_requestCount:0,_googleUrl:"http://ajax.googleapis.com/ajax/services/search/",_storeRef:"_S",_attributes:"unescapedUrl,url,visibleUrl,cacheUrl,title,titleNoFormatting,content,estimatedResultCount".split(","),_aggregatedAttributes:{estimatedResultCount:"cursor.estimatedResultCount"},label:"titleNoFormatting",_type:"web",urlPreventCache:!0,_queryAttrs:{text:"q"},_assertIsItem:function(a){if(!this.isItem(a))throw Error("dojox.data.GoogleSearchStore: a function was passed an item argument that was not an item");
},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error("dojox.data.GoogleSearchStore: a function was passed an attribute argument that was not an attribute name string");},getFeatures:function(){return{"dojo.data.api.Read":!0}},getValue:function(a,b,e){return(a=this.getValues(a,b))&&0<a.length?a[0]:e},getAttributes:function(){return this._attributes},hasAttribute:function(a,b){return this.getValue(a,b)?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(){},getLabel:function(a){return this.getValue(a,
this.label)},getLabelAttributes:function(){return[this.label]},containsValue:function(a,b,e){a=this.getValues(a,b);for(b=0;b<a.length;b++)if(a[b]===e)return!0;return!1},getValues:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);var e=a[b];return m.isArray(e)?e:void 0!==e?[e]:[]},isItem:function(a){return a&&a[this._storeRef]===this?!0:!1},close:function(){},_format:function(a){return a},fetch:function(a){function b(b){t++;p.content.context=p.content.start=b.start;b=x.get(p);q.push(b.ioArgs.id);
b.addErrback(function(b){a.onError&&a.onError.call(e,b,a)})}var a=a||{},e=a.scope||l.global;if(!a.query&&a.onError)a.onError.call(e,Error(this.declaredClass+": A query must be specified."));else{var d={},c;for(c in this._queryAttrs)d[c]=a.query[c];var a={query:d,onComplete:a.onComplete,onError:a.onError,onItem:a.onItem,onBegin:a.onBegin,start:a.start,count:a.count},o="GoogleSearchStoreCallback_"+this._id+"_"+ ++this._requestCount,d=this._createContent(d,o,a);if("undefined"===typeof a.start||null===
a.start)a.start=0;if(!a.count)a.count=8;c={start:a.start-a.start%8};var r=this,p={url:this._googleUrl+this._type,preventCache:this.urlPreventCache,content:d},j=[],s=0,m=!1,n=a.start-1,t=0,q=[],u=function(d,c){var E;0<q.length&&v("#"+q.splice(0,1)).forEach(w.destroy);if(!m){var h=r._getItems(c),f=c?c.cursor:null;if(h){for(var g=0;g<h.length&&g+d<a.count+a.start;g++)r._processItem(h[g],c),j[g+d]=h[g];s++;if(1==s){var i=(g=f?f.pages:null)?Number(g[g.length-1].start):0;a.onBegin&&(E=(f=f?f.estimatedResultCount:
h.length)?Math.min(f,i+h.length):i+h.length,h=E,a.onBegin.call(e,h,a));h=a.start-a.start%8+8;for(f=1;g&&g[f]&&!(Number(g[f].start)>=a.start+a.count);){Number(g[f].start)>=h&&b({start:g[f].start});f++}}if(a.onItem&&j[n+1]){do n++,a.onItem.call(e,j[n],a);while(j[n+1]&&n<a.start+a.count)}s==t&&(m=!0,l.global[o]=null,a.onItem?a.onComplete.call(e,null,a):(j=j.slice(a.start,a.start+a.count),a.onComplete.call(e,j,a)))}}},i=[],k=c.start-1;l.global[o]=function(b,c,d){try{if(200!=d)a.onError&&a.onError.call(e,
Error("Response from Google was: "+d),a),l.global[o]=function(){};else if(b==k+1){if(u(Number(b),c),k+=8,0<i.length)for(i.sort(r._getSort());0<i.length&&i[0].start==k+1;)u(Number(i[0].start),i[0].data),i.splice(0,1),k+=8}else i.push({start:b,data:c})}catch(f){a.onError.call(e,f,a)}};b(c)}},_getSort:function(){return function(a,b){return a.start<b.start?-1:b.start<a.start?1:0}},_processItem:function(a,b){a[this._storeRef]=this;for(var c in this._aggregatedAttributes)a[c]=m.getObject(this._aggregatedAttributes[c],
!1,b)},_getItems:function(a){return a.results||a},_createContent:function(a,b){var c={v:"1.0",rsz:"large",callback:b,key:this._key,hl:this._lang},d;for(d in this._queryAttrs)c[this._queryAttrs[d]]=a[d];return c}}),y=d("dojox.data.GoogleWebSearchStore",c,{}),z=d("dojox.data.GoogleBlogSearchStore",c,{_type:"blogs",_attributes:"blogUrl,postUrl,title,titleNoFormatting,content,author,publishedDate".split(","),_aggregatedAttributes:{}}),A=d("dojox.data.GoogleLocalSearchStore",c,{_type:"local",_attributes:"title,titleNoFormatting,url,lat,lng,streetAddress,city,region,country,phoneNumbers,ddUrl,ddUrlToHere,ddUrlFromHere,staticMapUrl,viewport".split(","),
_aggregatedAttributes:{viewport:"viewport"},_queryAttrs:{text:"q",centerLatLong:"sll",searchSpan:"sspn"}}),B=d("dojox.data.GoogleVideoSearchStore",c,{_type:"video",_attributes:"title,titleNoFormatting,content,url,published,publisher,duration,tbWidth,tbHeight,tbUrl,playUrl".split(","),_aggregatedAttributes:{}}),C=d("dojox.data.GoogleNewsSearchStore",c,{_type:"news",_attributes:"title,titleNoFormatting,content,url,unescapedUrl,publisher,clusterUrl,location,publishedDate,relatedStories".split(","),_aggregatedAttributes:{}}),
D=d("dojox.data.GoogleBookSearchStore",c,{_type:"books",_attributes:"title,titleNoFormatting,authors,url,unescapedUrl,bookId,pageCount,publishedYear".split(","),_aggregatedAttributes:{}}),d=d("dojox.data.GoogleImageSearchStore",c,{_type:"images",_attributes:"title,titleNoFormatting,visibleUrl,url,unescapedUrl,originalContextUrl,width,height,tbWidth,tbHeight,tbUrl,content,contentNoFormatting".split(","),_aggregatedAttributes:{}});return{Search:c,ImageSearch:d,BookSearch:D,NewsSearch:C,VideoSearch:B,
LocalSearch:A,BlogSearch:z,WebSearch:y}});