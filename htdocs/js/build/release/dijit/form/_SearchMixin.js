//>>built
define("dijit/form/_SearchMixin","dojo/data/util/filter,dojo/_base/declare,dojo/_base/event,dojo/keys,dojo/_base/lang,dojo/query,dojo/sniff,dojo/string,dojo/when,../registry".split(","),function(k,l,o,d,h,p,q,m,i,n){return l("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_abortQuery:function(){if(this.searchTimer)this.searchTimer=this.searchTimer.remove();if(this._queryDeferHandle)this._queryDeferHandle=
this._queryDeferHandle.remove();if(this._fetchHandle){if(this._fetchHandle.abort)this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1;if(this._fetchHandle.cancel)this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1;this._fetchHandle=null}},_processInput:function(a){if(!this.disabled&&!this.readOnly){var b=a.charOrCode;if(!a.altKey&&!((a.ctrlKey||a.metaKey)&&"x"!=b&&"v"!=b||b==d.SHIFT)){this._prev_key_backspace=a=!1;switch(b){case d.DELETE:case d.BACKSPACE:a=
this._maskValidSubsetError=this._prev_key_backspace=!0;break;default:a="string"==typeof b||229==b}if(a)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"))},_startSearch:function(a){this._abortQuery();var b=this,g=h.clone(this.query),c={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},d=m.substitute(this.queryExpr,
[a]),f,j=function(){var a=b._fetchHandle=b.store.query(g,c);!b.disabled&&!(b.readOnly||f!==b._lastQuery)&&i(a,function(e){b._fetchHandle=null;!b.disabled&&!b.readOnly&&f===b._lastQuery&&i(a.total,function(a){e.total=a;var d=b.pageSize;if(isNaN(d)||d>e.total)d=e.total;e.nextPage=function(a){c.direction=a=!1!==a;c.count=d;if(a){if(c.start+=e.length,c.start>=e.total)c.count=0}else if(c.start-=d,0>c.start)c.count=Math.max(d+c.start,0),c.start=0;0>=c.count?(e.length=0,b.onSearch(e,g,c)):j()};b.onSearch(e,
g,c)})},function(a){b._fetchHandle=null;b._cancelingQuery||console.error(b.declaredClass+" "+a.toString())})};h.mixin(c,this.fetchProperties);this.store._oldAPI?f=d:(f=k.patternToRegExp(d,this.ignoreCase),f.toString=function(){return d});this._lastQuery=g[this.searchAttr]=f;this._queryDeferHandle=this.defer(j,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var a=this.list;if(a)this.store=n.byId(a)}this.inherited(arguments)}})});